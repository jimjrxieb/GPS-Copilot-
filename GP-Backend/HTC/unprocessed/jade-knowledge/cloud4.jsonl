{"doc_id":"ciam-000","chunk_id":"ciam-000:0","title":"CIAM Sr. Consultant—Role Scope","text":"Lead CIAM programs end-to-end: assess business/tech risks and internal controls; design secure architectures; deliver implementations across Transmit Security, PingFederate, Okta, ForgeRock; drive vuln mgmt, compliance, training, metrics, and client success.","metadata":{"domain":["ciam","governance"],"project":"GP-Copilot","lang":"en"}}
{"doc_id":"ciam-010","chunk_id":"ciam-010:0","title":"CIAM Reference Architecture","text":"Channels: web, mobile, ATM/branch kiosks. Core: IdP, risk engine, device fingerprint, MFA, directory, consent/PI, token service, API gateway. Flows: OIDC/OAuth2 for web+mobile, SAML for legacy, FIDO2/WebAuthn for phishing-resistant MFA. Data plane: PII vault + event/audit bus.","metadata":{"domain":["architecture"],"topic":["oidc","saml","fido2"],"project":"GP-Copilot","lang":"en"}}
{"doc_id":"ciam-020","chunk_id":"ciam-020:0","title":"Protocols & Flows Cheat Sheet","text":"OIDC auth code + PKCE for public clients; confidential clients with client_secret or mTLS. SAML SP-initiated for legacy. OAuth2 device code for TVs/kiosks. Token exchange for BFF/API tier. Always restrict scopes; model RBAC/ABAC at API gateway or PDP (OPA).","metadata":{"domain":["protocols"],"topic":["oidc","oauth2","saml","pkce"],"project":"GP-Copilot","lang":"en"}}
{"doc_id":"ciam-030","chunk_id":"ciam-030:0","title":"MFA Strategy & WebAuthn","text":"Prefer passkeys/WebAuthn as primary for high-risk flows; step-up MFA based on risk score (device reputation, geo-velocity, anomalies). Deprioritize SMS; use TOTP/app push as fallback of last resort. Enforce per-transaction challenges for sensitive ops.","metadata":{"domain":["authn"],"topic":["mfa","webauthn","risk"],"project":"GP-Copilot","lang":"en"}}
{"doc_id":"ciam-040","chunk_id":"ciam-040:0","title":"Risk-Based Authentication Signals","text":"Signals: device fingerprint, IP reputation, ASN, impossible travel, new device, failed attempts, behavioral biometrics, known mule patterns. Actions: allow, step-up WebAuthn, deny, or require out-of-band verification. Log decisions with evidence for audit.","metadata":{"domain":["fraud","risk"],"project":"GP-Copilot","lang":"en"}}
{"doc_id":"ciam-050","chunk_id":"ciam-050:0","title":"Identity Proofing & Onboarding","text":"Progressive KYC: low-friction email/phone verification → doc + liveness when risk or thresholds require. Bind device at onboarding; store proofing assertions with TTL; separate PII storage and audit trails for privacy laws.","metadata":{"domain":["onboarding","kyc","privacy"],"project":"GP-Copilot","lang":"en"}}
{"doc_id":"ciam-060","chunk_id":"ciam-060:0","title":"Consent & Privacy Management","text":"Record purpose-based consent with versions; enforce data-minimization in tokens/claims; regional data residency by tenant/realm; enable user data export/delete workflows. Map to GDPR/CCPA and internal retention schedules.","metadata":{"domain":["privacy","consent"],"project":"GP-Copilot","lang":"en"}}
{"doc_id":"ciam-070","chunk_id":"ciam-070:0","title":"Authorization Patterns","text":"Scopes for coarse access; claims (roles, entitlements) for medium; policy-based (OPA/Rego) for fine-grained ABAC (subject, resource, action, context). Externalize authZ; avoid logic in apps. Include decision explanations for customer support.","metadata":{"domain":["authz"],"topic":["rbac","abac","opa"],"project":"GP-Copilot","lang":"en"}}
{"doc_id":"ciam-080","chunk_id":"ciam-080:0","title":"Tokens, Sessions, and PKCE","text":"Set short access token TTL (5–15m), rotate refresh tokens (reuse detection), bind tokens to client (DPoP or mTLS where feasible). Enforce PKCE for public clients; restrict redirect URIs (no wildcards). Prefer asymmetric signing (RS256/ES256).","metadata":{"domain":["tokens"],"topic":["pkce","rotation","dpop"],"project":"GP-Copilot","lang":"en"}}
{"doc_id":"ciam-090","chunk_id":"ciam-090:0","title":"Vendor Pattern—Okta (OIDC App)","text":"Create OIDC app (auth code + PKCE), set allowed redirect URIs, enable Refresh Token Rotation, assign WebAuthn + app-authenticator policy, map custom claims for roles/entitlements, limit scopes to minimum required.","metadata":{"domain":["vendor","okta"],"project":"GP-Copilot","lang":"en"}}
{"doc_id":"ciam-091","chunk_id":"ciam-091:0","title":"Vendor Pattern—PingFederate (IdP Connection)","text":"Configure SP connection for OIDC or SAML; map attributes/claims; enable token exchange to downstream API gateway; enforce adapter instance with risk policy plug-in; sign + encrypt assertions for high-risk lines (e.g., ATM, branch).","metadata":{"domain":["vendor","pingfederate"],"project":"GP-Copilot","lang":"en"}}
{"doc_id":"ciam-092","chunk_id":"ciam-092:0","title":"Vendor Pattern—ForgeRock Journey Sketch","text":"Tree: UsernameCollector → DeviceProfile → RiskDecision → WebAuthnAuthenticator → (Step-up if risk > threshold) → OIDCClaims → Success. Store risk outcome in session; attach transaction-level ACR.","metadata":{"domain":["vendor","forgerock"],"project":"GP-Copilot","lang":"en"}}
{"doc_id":"ciam-093","chunk_id":"ciam-093:0","title":"Vendor Pattern—Transmit Security Risk Rule","text":"Rule: IF new_device AND high_amount AND geo_velocity THEN challenge=webauthn; ELSE IF medium_risk THEN challenge=otp_app; ELSE allow. Log rule id, features, and outcome; feed to model retraining monthly.","metadata":{"domain":["vendor","transmit"],"project":"GP-Copilot","lang":"en"}}
{"doc_id":"ciam-100","chunk_id":"ciam-100:0","title":"CI/CD & Config-as-Code for CIAM","text":"Manage IdP config via Terraform/SDKs; lint configs with Conftest (e.g., no wildcard redirects, PKCE required). Store client metadata separately from secrets; rotate creds via Secrets Manager. Gate merges on policy checks and smoke tests.","metadata":{"domain":["devsecops"],"topic":["conftest","terraform"],"project":"GP-Copilot","lang":"en"}}
{"doc_id":"ciam-110","chunk_id":"ciam-110:0","title":"Compliance & Auditing","text":"Map CIAM controls to PCI DSS, SOX, and internal policies. Evidence: authenticator policy exports, token settings, consent logs, fraud decisions, and SSO audit trails. Quarterly config snapshots; segregation of duties on CIAM admins.","metadata":{"domain":["compliance"],"topic":["pci","sox"],"project":"GP-Copilot","lang":"en"}}
{"doc_id":"ciam-120","chunk_id":"ciam-120:0","title":"Training & Awareness (CIAM)","text":"Deliver secure customer UX training: anti-phishing, recovery flows, social engineering risk. Run chaos drills for account takeover and recovery. Track completion and simulated ATO response time.","metadata":{"domain":["training"],"project":"GP-Copilot","lang":"en"}}
{"doc_id":"ciam-130","chunk_id":"ciam-130:0","title":"Metrics & Reporting (Exec)","text":"KPIs: auth success %, step-up rate by segment, MFA adoption, ATO rate per 10k logins, false-positive challenge %, mean enroll time, consent coverage, token error rate, SLO breaches. Slice by channel, region, device class.","metadata":{"domain":["metrics"],"project":"GP-Copilot","lang":"en"}}
{"doc_id":"ciam-140","chunk_id":"ciam-140:0","title":"Policy Lint—Conftest for OIDC Clients","text":"package ciam.clients\n\ndeny[msg] { input.redirect_uris[_] == \"*\"; msg := \"Wildcard redirect not allowed\" }\ndeny[msg] { input.app_type == \"public\"; not input.pkce; msg := \"PKCE required for public clients\" }\ndeny[msg] { input.refresh_rotation != true; msg := \"Refresh Token Rotation must be enabled\" }\ndeny[msg] { input.id_token_ttl > 3600; msg := \"ID token TTL too long\" }","metadata":{"domain":["policy","opa"],"topic":["conftest","oidc"],"project":"GP-Copilot","lang":"en"}}
{"entity_id":"ent:OIDC","type":"Protocol","label":"OpenID Connect","aliases":["OIDC"],"source_doc_id":"ciam-020"}
{"entity_id":"ent:OAuth2","type":"Protocol","label":"OAuth 2.0","aliases":["OAuth2"],"source_doc_id":"ciam-020"}
{"entity_id":"ent:SAML","type":"Protocol","label":"SAML 2.0","aliases":["SAML"],"source_doc_id":"ciam-020"}
{"entity_id":"ent:WebAuthn","type":"Authenticator","label":"WebAuthn/Passkeys","aliases":["FIDO2"],"source_doc_id":"ciam-030"}
{"entity_id":"ent:PKCE","type":"Control","label":"PKCE","aliases":[],"source_doc_id":"ciam-080"}
{"entity_id":"ent:RiskEngine","type":"Component","label":"Risk Engine","aliases":["Fraud Engine"],"source_doc_id":"ciam-040"}
{"entity_id":"ent:Okta","type":"Vendor","label":"Okta CIAM","aliases":[],"source_doc_id":"ciam-090"}
{"entity_id":"ent:PingFederate","type":"Vendor","label":"PingFederate","aliases":["Ping"],"source_doc_id":"ciam-091"}
{"entity_id":"ent:ForgeRock","type":"Vendor","label":"ForgeRock AM","aliases":[],"source_doc_id":"ciam-092"}
{"entity_id":"ent:Transmit","type":"Vendor","label":"Transmit Security","aliases":[],"source_doc_id":"ciam-093"}
{"entity_id":"ent:Consent","type":"Process","label":"Consent Management","aliases":[],"source_doc_id":"ciam-060"}
{"entity_id":"ent:KYC","type":"Process","label":"Identity Proofing/KYC","aliases":["Proofing"],"source_doc_id":"ciam-050"}
{"head":"ent:OIDC","relation":"requires","tail":"ent:PKCE","evidence":{"doc_id":"ciam-080","chunk_id":"ciam-080:0"},"confidence":0.96}
{"head":"ent:WebAuthn","relation":"reduces","tail":"ent:RiskEngine","evidence":{"doc_id":"ciam-030","chunk_id":"ciam-030:0"},"confidence":0.9}
{"head":"ent:RiskEngine","relation":"evaluates","tail":"ent:KYC","evidence":{"doc_id":"ciam-050","chunk_id":"ciam-050:0"},"confidence":0.86}
{"head":"ent:Consent","relation":"governs","tail":"ent:OIDC","evidence":{"doc_id":"ciam-060","chunk_id":"ciam-060:0"},"confidence":0.88}
{"head":"ent:Okta","relation":"implements","tail":"ent:OIDC","evidence":{"doc_id":"ciam-090","chunk_id":"ciam-090:0"},"confidence":0.95}
{"head":"ent:PingFederate","relation":"implements","tail":"ent:SAML","evidence":{"doc_id":"ciam-091","chunk_id":"ciam-091:0"},"confidence":0.94}
{"head":"ent:ForgeRock","relation":"implements","tail":"ent:WebAuthn","evidence":{"doc_id":"ciam-092","chunk_id":"ciam-092:0"},"confidence":0.9}
{"head":"ent:Transmit","relation":"provides","tail":"ent:RiskEngine","evidence":{"doc_id":"ciam-093","chunk_id":"ciam-093:0"},"confidence":0.92}
{"head":"ent:OAuth2","relation":"issues","tail":"ent:OIDC","evidence":{"doc_id":"ciam-020","chunk_id":"ciam-020:0"},"confidence":0.86}
{"head":"ent:OIDC","relation":"fronts","tail":"ent:SAML","evidence":{"doc_id":"ciam-020","chunk_id":"ciam-020:0"},"confidence":0.82}
{"qid":"ciam-q1","question":"When should you enforce PKCE and why?","expected_keywords":["public clients","code interception","required"],"reference_doc_ids":["ciam-080","ciam-020"],"difficulty":"easy","eval_type":"keywords_all"}
{"qid":"ciam-q2","question":"Design a step-up MFA policy using WebAuthn for high-risk transactions.","expected_keywords":["risk score","step-up","WebAuthn","transaction"],"reference_doc_ids":["ciam-030","ciam-040"],"difficulty":"medium","eval_type":"keywords_all"}
{"qid":"ciam-q3","question":"How do you prevent wildcard redirect URIs and require refresh token rotation in CI/CD?","expected_keywords":["Conftest","no wildcard","rotation"],"reference_doc_ids":["ciam-100","ciam-140"],"difficulty":"medium","eval_type":"keywords_all"}
{"qid":"ciam-q4","question":"What are recommended token lifetimes and binding strategies?","expected_keywords":["short access tokens","rotate refresh","mTLS or DPoP"],"reference_doc_ids":["ciam-080"],"difficulty":"medium","eval_type":"keywords_all"}
{"qid":"ciam-q5","question":"Map CIAM evidence to PCI/SOX for audit.","expected_keywords":["authenticator policies","token settings","consent logs","audit trails"],"reference_doc_ids":["ciam-110"],"difficulty":"medium","eval_type":"keywords_any_all"}
{"qid":"ciam-q6","question":"Outline an onboarding flow with progressive KYC and device binding.","expected_keywords":["progressive","KYC","device binding","TTL"],"reference_doc_ids":["ciam-050"],"difficulty":"easy","eval_type":"keywords_all"}
