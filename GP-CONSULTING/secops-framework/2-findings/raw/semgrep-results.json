{"errors": [], "interfile_languages_used": [], "paths": {"scanned": ["../../backend/.env.example", "../../backend/Dockerfile", "../../backend/PRD.md", "../../backend/README.md", "../../backend/config/database.js", "../../backend/config/secrets.js", "../../backend/controllers/auth.controller.js", "../../backend/controllers/merchant.controller.js", "../../backend/controllers/payment.controller.js", "../../backend/middleware/opa.middleware.js", "../../backend/models/Merchant.js", "../../backend/models/Payment.js", "../../backend/package.json", "../../backend/routes/auth.routes.js", "../../backend/routes/merchant.routes.js", "../../backend/routes/payment.routes.js", "../../backend/server.js", "../../backend/services/aws.service.js", "../../frontend/src/App.css", "../../frontend/src/App.test.tsx", "../../frontend/src/App.tsx", "../../frontend/src/components/TransactionCard.tsx", "../../frontend/src/index.css", "../../frontend/src/index.tsx", "../../frontend/src/logo.svg", "../../frontend/src/pages/DashboardPage.tsx", "../../frontend/src/pages/LoginPage.tsx", "../../frontend/src/react-app-env.d.ts", "../../frontend/src/reportWebVitals.ts", "../../frontend/src/services/api.ts", "../../frontend/src/setupTests.ts", "../../frontend/src/types/index.ts"]}, "results": [{"check_id": "javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage", "end": {"col": 22, "line": 13, "offset": 528}, "extra": {"engine_kind": "OSS", "fingerprint": "ff8de59573c51a4af9ff27491c2f11bc61dfaafb6d169c4e0ed0a2914342c77dc7989fd9ff6890d5beecc62995603546081268ec7935401838d1c748d30a18a7_0", "is_ignored": false, "lines": "const app = express();", "message": "A CSRF middleware was not detected in your express application. Ensure you are either using one such as `csurf` or `csrf` (see rule references) and/or you are properly doing CSRF validation in your routes with a token or cookies.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-352: Cross-Site Request Forgery (CSRF)"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "LOW", "owasp": ["A01:2021 - Broken Access Control"], "references": ["https://www.npmjs.com/package/csurf", "https://www.npmjs.com/package/csrf", "https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 22551, "rule_id": "wdUKEq", "rv_id": 945789, "url": "https://semgrep.dev/playground/r/NdTqkvB/javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage", "version_id": "NdTqkvB"}}, "shortlink": "https://sg.run/BxzR", "source": "https://semgrep.dev/r/javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage", "subcategory": ["audit"], "technology": ["javascript", "typescript", "express"], "vulnerability_class": ["Cross-Site Request Forgery (CSRF)"]}, "metavars": {"$APP": {"abstract_content": "app", "end": {"col": 10, "line": 13, "offset": 516}, "start": {"col": 7, "line": 13, "offset": 513}}, "$EXPRESS": {"abstract_content": "express", "end": {"col": 20, "line": 13, "offset": 526}, "start": {"col": 13, "line": 13, "offset": 519}}}, "severity": "INFO", "validation_state": "NO_VALIDATOR"}, "path": "../../backend/server.js", "start": {"col": 7, "line": 13, "offset": 513}}, {"check_id": "typescript.react.security.audit.react-dangerouslysetinnerhtml.react-dangerouslysetinnerhtml", "end": {"col": 75, "line": 77, "offset": 2945}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "payment", "location": {"end": {"col": 67, "line": 26, "offset": 813}, "path": "../../frontend/src/components/TransactionCard.tsx", "start": {"col": 60, "line": 26, "offset": 806}}}], "taint_sink": ["CliLoc", [{"end": {"col": 75, "line": 77, "offset": 2945}, "path": "../../frontend/src/components/TransactionCard.tsx", "start": {"col": 52, "line": 77, "offset": 2922}}, "payment.cardholder_name"]], "taint_source": ["CliLoc", [{"end": {"col": 69, "line": 26, "offset": 815}, "path": "../../frontend/src/components/TransactionCard.tsx", "start": {"col": 58, "line": 26, "offset": 804}}, "{ payment }"]]}, "engine_kind": "OSS", "fingerprint": "32365922e12790d54e4e0c363368d2a3520dc7b7a2d53fcda7c33917f63f0ab52dde057a4f902b335d1026182fa283722802519d653a2203f4b426b05422f9b7_0", "is_ignored": false, "lines": "                dangerouslySetInnerHTML={{ __html: payment.cardholder_name }}", "message": "Detection of dangerouslySetInnerHTML from non-constant definition. This can inadvertently expose users to cross-site scripting (XSS) attacks if this comes from user-provided input. If you have to use dangerouslySetInnerHTML, consider using a sanitization library such as DOMPurify to sanitize your HTML.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "MEDIUM", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://react.dev/reference/react-dom/components/common#dangerously-setting-the-inner-html"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9769, "rule_id": "x8UWvK", "rv_id": 947023, "url": "https://semgrep.dev/playground/r/RGTAP3A/typescript.react.security.audit.react-dangerouslysetinnerhtml.react-dangerouslysetinnerhtml", "version_id": "RGTAP3A"}}, "shortlink": "https://sg.run/rAx6", "source": "https://semgrep.dev/r/typescript.react.security.audit.react-dangerouslysetinnerhtml.react-dangerouslysetinnerhtml", "subcategory": ["vuln"], "technology": ["react"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$X": {"abstract_content": "{payment payment}", "end": {"col": 69, "line": 26, "offset": 815}, "start": {"col": 58, "line": 26, "offset": 804}}, "$Y": {"abstract_content": "span", "end": {"col": 20, "line": 76, "offset": 2870}, "start": {"col": 16, "line": 76, "offset": 2866}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "../../frontend/src/components/TransactionCard.tsx", "start": {"col": 52, "line": 77, "offset": 2922}}], "skipped_rules": [], "version": "1.52.0"}