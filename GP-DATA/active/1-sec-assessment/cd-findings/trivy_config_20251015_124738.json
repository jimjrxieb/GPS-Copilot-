{
  "findings": [
    {
      "id": "trivy_misconfig_1",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "DS002",
      "check_type": "Dockerfile Security Check",
      "title": "Image user should not be 'root'",
      "severity": "HIGH",
      "file": "backend/Dockerfile",
      "line": 0,
      "end_line": 0,
      "message": "Specify at least 1 USER command in Dockerfile with non-root user as argument",
      "description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
      "remediation": "Add 'USER <non root user name>' line to the Dockerfile",
      "provider": "Dockerfile",
      "service": "general",
      "references": [
        "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
        "https://avd.aquasec.com/misconfig/ds002"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Dockerfile Security Check",
        "ID": "DS002",
        "AVDID": "AVD-DS-0002",
        "Title": "Image user should not be 'root'",
        "Description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
        "Message": "Specify at least 1 USER command in Dockerfile with non-root user as argument",
        "Namespace": "builtin.dockerfile.DS002",
        "Query": "data.builtin.dockerfile.DS002.deny",
        "Resolution": "Add 'USER <non root user name>' line to the Dockerfile",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ds002",
        "References": [
          "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
          "https://avd.aquasec.com/misconfig/ds002"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Dockerfile",
          "Service": "general",
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_2",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "DS001",
      "check_type": "Dockerfile Security Check",
      "title": "':latest' tag used",
      "severity": "MEDIUM",
      "file": "backend/node_modules/winston-cloudwatch/Dockerfile",
      "line": 1,
      "end_line": 1,
      "message": "Specify a tag in the 'FROM' statement for image 'node'",
      "description": "When using a 'FROM' statement you should use a specific tag to avoid uncontrolled behavior when the image is updated.",
      "remediation": "Add a tag to the image in the 'FROM' statement",
      "provider": "Dockerfile",
      "service": "general",
      "references": [
        "https://avd.aquasec.com/misconfig/ds001"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Dockerfile Security Check",
        "ID": "DS001",
        "AVDID": "AVD-DS-0001",
        "Title": "':latest' tag used",
        "Description": "When using a 'FROM' statement you should use a specific tag to avoid uncontrolled behavior when the image is updated.",
        "Message": "Specify a tag in the 'FROM' statement for image 'node'",
        "Namespace": "builtin.dockerfile.DS001",
        "Query": "data.builtin.dockerfile.DS001.deny",
        "Resolution": "Add a tag to the image in the 'FROM' statement",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ds001",
        "References": [
          "https://avd.aquasec.com/misconfig/ds001"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Dockerfile",
          "Service": "general",
          "StartLine": 1,
          "EndLine": 1,
          "Code": {
            "Lines": [
              {
                "Number": 1,
                "Content": "FROM node",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;64mFROM\u001b[0m\u001b[38;5;37m node",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_3",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "DS002",
      "check_type": "Dockerfile Security Check",
      "title": "Image user should not be 'root'",
      "severity": "HIGH",
      "file": "backend/node_modules/winston-cloudwatch/Dockerfile",
      "line": 0,
      "end_line": 0,
      "message": "Specify at least 1 USER command in Dockerfile with non-root user as argument",
      "description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
      "remediation": "Add 'USER <non root user name>' line to the Dockerfile",
      "provider": "Dockerfile",
      "service": "general",
      "references": [
        "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
        "https://avd.aquasec.com/misconfig/ds002"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Dockerfile Security Check",
        "ID": "DS002",
        "AVDID": "AVD-DS-0002",
        "Title": "Image user should not be 'root'",
        "Description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
        "Message": "Specify at least 1 USER command in Dockerfile with non-root user as argument",
        "Namespace": "builtin.dockerfile.DS002",
        "Query": "data.builtin.dockerfile.DS002.deny",
        "Resolution": "Add 'USER <non root user name>' line to the Dockerfile",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ds002",
        "References": [
          "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
          "https://avd.aquasec.com/misconfig/ds002"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Dockerfile",
          "Service": "general",
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_4",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "DS017",
      "check_type": "Dockerfile Security Check",
      "title": "'RUN <package-manager> update' instruction alone",
      "severity": "HIGH",
      "file": "backend/node_modules/winston-cloudwatch/Dockerfile",
      "line": 5,
      "end_line": 5,
      "message": "The instruction 'RUN <package-manager> update' should always be followed by '<package-manager> install' in the same RUN statement.",
      "description": "The instruction 'RUN <package-manager> update' should always be followed by '<package-manager> install' in the same RUN statement.",
      "remediation": "Combine '<package-manager> update' and '<package-manager> install' instructions to single one",
      "provider": "Dockerfile",
      "service": "general",
      "references": [
        "https://docs.docker.com/develop/develop-images/instructions/#run",
        "https://avd.aquasec.com/misconfig/ds017"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Dockerfile Security Check",
        "ID": "DS017",
        "AVDID": "AVD-DS-0017",
        "Title": "'RUN <package-manager> update' instruction alone",
        "Description": "The instruction 'RUN <package-manager> update' should always be followed by '<package-manager> install' in the same RUN statement.",
        "Message": "The instruction 'RUN <package-manager> update' should always be followed by '<package-manager> install' in the same RUN statement.",
        "Namespace": "builtin.dockerfile.DS017",
        "Query": "data.builtin.dockerfile.DS017.deny",
        "Resolution": "Combine '<package-manager> update' and '<package-manager> install' instructions to single one",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ds017",
        "References": [
          "https://docs.docker.com/develop/develop-images/instructions/#run",
          "https://avd.aquasec.com/misconfig/ds017"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Dockerfile",
          "Service": "general",
          "StartLine": 5,
          "EndLine": 5,
          "Code": {
            "Lines": [
              {
                "Number": 5,
                "Content": "RUN apt-get update",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;64mRUN\u001b[0m apt-get update",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_5",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "DS026",
      "check_type": "Dockerfile Security Check",
      "title": "No HEALTHCHECK defined",
      "severity": "LOW",
      "file": "backend/node_modules/winston-cloudwatch/Dockerfile",
      "line": 0,
      "end_line": 0,
      "message": "Add HEALTHCHECK instruction in your Dockerfile",
      "description": "You should add HEALTHCHECK instruction in your docker container images to perform the health check on running containers.",
      "remediation": "Add HEALTHCHECK instruction in Dockerfile",
      "provider": "Dockerfile",
      "service": "general",
      "references": [
        "https://blog.aquasec.com/docker-security-best-practices",
        "https://avd.aquasec.com/misconfig/ds026"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Dockerfile Security Check",
        "ID": "DS026",
        "AVDID": "AVD-DS-0026",
        "Title": "No HEALTHCHECK defined",
        "Description": "You should add HEALTHCHECK instruction in your docker container images to perform the health check on running containers.",
        "Message": "Add HEALTHCHECK instruction in your Dockerfile",
        "Namespace": "builtin.dockerfile.DS026",
        "Query": "data.builtin.dockerfile.DS026.deny",
        "Resolution": "Add HEALTHCHECK instruction in Dockerfile",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ds026",
        "References": [
          "https://blog.aquasec.com/docker-security-best-practices",
          "https://avd.aquasec.com/misconfig/ds026"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Dockerfile",
          "Service": "general",
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_6",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "DS029",
      "check_type": "Dockerfile Security Check",
      "title": "'apt-get' missing '--no-install-recommends'",
      "severity": "HIGH",
      "file": "backend/node_modules/winston-cloudwatch/Dockerfile",
      "line": 6,
      "end_line": 6,
      "message": "'--no-install-recommends' flag is missed: 'apt-get install -y vim'",
      "description": "'apt-get' install should use '--no-install-recommends' to minimize image size.",
      "remediation": "Add '--no-install-recommends' flag to 'apt-get'",
      "provider": "Dockerfile",
      "service": "general",
      "references": [
        "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
        "https://avd.aquasec.com/misconfig/ds029"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Dockerfile Security Check",
        "ID": "DS029",
        "AVDID": "AVD-DS-0029",
        "Title": "'apt-get' missing '--no-install-recommends'",
        "Description": "'apt-get' install should use '--no-install-recommends' to minimize image size.",
        "Message": "'--no-install-recommends' flag is missed: 'apt-get install -y vim'",
        "Namespace": "builtin.dockerfile.DS029",
        "Query": "data.builtin.dockerfile.DS029.deny",
        "Resolution": "Add '--no-install-recommends' flag to 'apt-get'",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ds029",
        "References": [
          "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
          "https://avd.aquasec.com/misconfig/ds029"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Dockerfile",
          "Service": "general",
          "StartLine": 6,
          "EndLine": 6,
          "Code": {
            "Lines": [
              {
                "Number": 6,
                "Content": "RUN apt-get install -y vim",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;64mRUN\u001b[0m apt-get install -y vim",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_7",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "DS002",
      "check_type": "Dockerfile Security Check",
      "title": "Image user should not be 'root'",
      "severity": "HIGH",
      "file": "frontend/Dockerfile",
      "line": 0,
      "end_line": 0,
      "message": "Specify at least 1 USER command in Dockerfile with non-root user as argument",
      "description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
      "remediation": "Add 'USER <non root user name>' line to the Dockerfile",
      "provider": "Dockerfile",
      "service": "general",
      "references": [
        "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
        "https://avd.aquasec.com/misconfig/ds002"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Dockerfile Security Check",
        "ID": "DS002",
        "AVDID": "AVD-DS-0002",
        "Title": "Image user should not be 'root'",
        "Description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
        "Message": "Specify at least 1 USER command in Dockerfile with non-root user as argument",
        "Namespace": "builtin.dockerfile.DS002",
        "Query": "data.builtin.dockerfile.DS002.deny",
        "Resolution": "Add 'USER <non root user name>' line to the Dockerfile",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ds002",
        "References": [
          "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
          "https://avd.aquasec.com/misconfig/ds002"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Dockerfile",
          "Service": "general",
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_8",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV020",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with UID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-local.yaml",
      "line": 22,
      "end_line": 75,
      "message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.runAsUser' > 10000",
      "description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv020"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV020",
        "AVDID": "AVD-KSV-0020",
        "Title": "Runs with UID <= 10000",
        "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.runAsUser' > 10000",
        "Namespace": "builtin.kubernetes.KSV020",
        "Query": "data.builtin.kubernetes.KSV020.deny",
        "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv020"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 22,
          "EndLine": 75,
          "Code": {
            "Lines": [
              {
                "Number": 22,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "        image: node:18-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: node:18-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "        - name: http",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: http",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "          containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "          protocol: TCP",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mprotocol\u001b[0m: TCP",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "        command:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "        - node",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - node",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 31,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_9",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV020",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with UID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-local.yaml",
      "line": 95,
      "end_line": 131,
      "message": "Container 'postgres' of Deployment 'postgres' should set 'securityContext.runAsUser' > 10000",
      "description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv020"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV020",
        "AVDID": "AVD-KSV-0020",
        "Title": "Runs with UID <= 10000",
        "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'postgres' of Deployment 'postgres' should set 'securityContext.runAsUser' > 10000",
        "Namespace": "builtin.kubernetes.KSV020",
        "Query": "data.builtin.kubernetes.KSV020.deny",
        "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv020"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 95,
          "EndLine": 131,
          "Code": {
            "Lines": [
              {
                "Number": 95,
                "Content": "      - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 96,
                "Content": "        image: postgres:14-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: postgres:14-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 97,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 98,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 99,
                "Content": "        - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 100,
                "Content": "          containerPort: 5432",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 101,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 102,
                "Content": "        - name: POSTGRES_USER",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POSTGRES_USER",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 103,
                "Content": "          value: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: postgres",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 104,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_10",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV020",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with UID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-local.yaml",
      "line": 158,
      "end_line": 187,
      "message": "Container 'redis' of Deployment 'redis' should set 'securityContext.runAsUser' > 10000",
      "description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv020"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV020",
        "AVDID": "AVD-KSV-0020",
        "Title": "Runs with UID <= 10000",
        "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'redis' of Deployment 'redis' should set 'securityContext.runAsUser' > 10000",
        "Namespace": "builtin.kubernetes.KSV020",
        "Query": "data.builtin.kubernetes.KSV020.deny",
        "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv020"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 158,
          "EndLine": 187,
          "Code": {
            "Lines": [
              {
                "Number": 158,
                "Content": "      - name: redis",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 159,
                "Content": "        image: redis:7-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:7-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 160,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 161,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 162,
                "Content": "        - name: redis",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: redis",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 163,
                "Content": "          containerPort: 6379",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 164,
                "Content": "        command:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 165,
                "Content": "        - redis-server",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis-server",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 166,
                "Content": "        - --dir",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --dir",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 167,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_11",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV021",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with GID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-local.yaml",
      "line": 22,
      "end_line": 75,
      "message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.runAsGroup' > 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 22,
          "EndLine": 75,
          "Code": {
            "Lines": [
              {
                "Number": 22,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "        image: node:18-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: node:18-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "        - name: http",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: http",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "          containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "          protocol: TCP",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mprotocol\u001b[0m: TCP",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "        command:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "        - node",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - node",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 31,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_12",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV021",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with GID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-local.yaml",
      "line": 95,
      "end_line": 131,
      "message": "Container 'postgres' of Deployment 'postgres' should set 'securityContext.runAsGroup' > 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'postgres' of Deployment 'postgres' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 95,
          "EndLine": 131,
          "Code": {
            "Lines": [
              {
                "Number": 95,
                "Content": "      - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 96,
                "Content": "        image: postgres:14-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: postgres:14-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 97,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 98,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 99,
                "Content": "        - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 100,
                "Content": "          containerPort: 5432",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 101,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 102,
                "Content": "        - name: POSTGRES_USER",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POSTGRES_USER",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 103,
                "Content": "          value: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: postgres",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 104,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_13",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV021",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with GID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-local.yaml",
      "line": 158,
      "end_line": 187,
      "message": "Container 'redis' of Deployment 'redis' should set 'securityContext.runAsGroup' > 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'redis' of Deployment 'redis' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 158,
          "EndLine": 187,
          "Code": {
            "Lines": [
              {
                "Number": 158,
                "Content": "      - name: redis",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 159,
                "Content": "        image: redis:7-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:7-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 160,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 161,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 162,
                "Content": "        - name: redis",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: redis",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 163,
                "Content": "          containerPort: 6379",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 164,
                "Content": "        command:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 165,
                "Content": "        - redis-server",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis-server",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 166,
                "Content": "        - --dir",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --dir",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 167,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_14",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV030",
      "check_type": "Kubernetes Security Check",
      "title": "Runtime/Default Seccomp profile not set",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-local.yaml",
      "line": 22,
      "end_line": 75,
      "message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
      "description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
      "remediation": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv030"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV030",
        "AVDID": "AVD-KSV-0030",
        "Title": "Runtime/Default Seccomp profile not set",
        "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
        "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
        "Namespace": "builtin.kubernetes.KSV030",
        "Query": "data.builtin.kubernetes.KSV030.deny",
        "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv030"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 22,
          "EndLine": 75,
          "Code": {
            "Lines": [
              {
                "Number": 22,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "        image: node:18-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: node:18-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "        - name: http",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: http",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "          containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "          protocol: TCP",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mprotocol\u001b[0m: TCP",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "        command:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "        - node",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - node",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 31,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_15",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV030",
      "check_type": "Kubernetes Security Check",
      "title": "Runtime/Default Seccomp profile not set",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-local.yaml",
      "line": 95,
      "end_line": 131,
      "message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
      "description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
      "remediation": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv030"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV030",
        "AVDID": "AVD-KSV-0030",
        "Title": "Runtime/Default Seccomp profile not set",
        "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
        "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
        "Namespace": "builtin.kubernetes.KSV030",
        "Query": "data.builtin.kubernetes.KSV030.deny",
        "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv030"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 95,
          "EndLine": 131,
          "Code": {
            "Lines": [
              {
                "Number": 95,
                "Content": "      - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 96,
                "Content": "        image: postgres:14-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: postgres:14-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 97,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 98,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 99,
                "Content": "        - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 100,
                "Content": "          containerPort: 5432",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 101,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 102,
                "Content": "        - name: POSTGRES_USER",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POSTGRES_USER",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 103,
                "Content": "          value: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: postgres",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 104,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_16",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV030",
      "check_type": "Kubernetes Security Check",
      "title": "Runtime/Default Seccomp profile not set",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-local.yaml",
      "line": 158,
      "end_line": 187,
      "message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
      "description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
      "remediation": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv030"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV030",
        "AVDID": "AVD-KSV-0030",
        "Title": "Runtime/Default Seccomp profile not set",
        "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
        "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
        "Namespace": "builtin.kubernetes.KSV030",
        "Query": "data.builtin.kubernetes.KSV030.deny",
        "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv030"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 158,
          "EndLine": 187,
          "Code": {
            "Lines": [
              {
                "Number": 158,
                "Content": "      - name: redis",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 159,
                "Content": "        image: redis:7-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:7-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 160,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 161,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 162,
                "Content": "        - name: redis",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: redis",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 163,
                "Content": "          containerPort: 6379",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 164,
                "Content": "        command:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 165,
                "Content": "        - redis-server",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis-server",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 166,
                "Content": "        - --dir",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --dir",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 167,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_17",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV104",
      "check_type": "Kubernetes Security Check",
      "title": "Seccomp policies disabled",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-local.yaml",
      "line": 0,
      "end_line": 0,
      "message": "container \"backend\" of deployment \"securebank-backend\" in \"securebank\" namespace should specify a seccomp profile",
      "description": "A program inside the container can bypass Seccomp protection policies.",
      "remediation": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv104"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV104",
        "AVDID": "AVD-KSV-0104",
        "Title": "Seccomp policies disabled",
        "Description": "A program inside the container can bypass Seccomp protection policies.",
        "Message": "container \"backend\" of deployment \"securebank-backend\" in \"securebank\" namespace should specify a seccomp profile",
        "Namespace": "builtin.kubernetes.KSV104",
        "Query": "data.builtin.kubernetes.KSV104.deny",
        "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_18",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV104",
      "check_type": "Kubernetes Security Check",
      "title": "Seccomp policies disabled",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-local.yaml",
      "line": 76,
      "end_line": 76,
      "message": "container \"postgres\" of deployment \"postgres\" in \"securebank\" namespace should specify a seccomp profile",
      "description": "A program inside the container can bypass Seccomp protection policies.",
      "remediation": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv104"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV104",
        "AVDID": "AVD-KSV-0104",
        "Title": "Seccomp policies disabled",
        "Description": "A program inside the container can bypass Seccomp protection policies.",
        "Message": "container \"postgres\" of deployment \"postgres\" in \"securebank\" namespace should specify a seccomp profile",
        "Namespace": "builtin.kubernetes.KSV104",
        "Query": "data.builtin.kubernetes.KSV104.deny",
        "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 76,
          "EndLine": 76,
          "Code": {
            "Lines": [
              {
                "Number": 76,
                "Content": "---",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "---",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_19",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV104",
      "check_type": "Kubernetes Security Check",
      "title": "Seccomp policies disabled",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-local.yaml",
      "line": 139,
      "end_line": 139,
      "message": "container \"redis\" of deployment \"redis\" in \"securebank\" namespace should specify a seccomp profile",
      "description": "A program inside the container can bypass Seccomp protection policies.",
      "remediation": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv104"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV104",
        "AVDID": "AVD-KSV-0104",
        "Title": "Seccomp policies disabled",
        "Description": "A program inside the container can bypass Seccomp protection policies.",
        "Message": "container \"redis\" of deployment \"redis\" in \"securebank\" namespace should specify a seccomp profile",
        "Namespace": "builtin.kubernetes.KSV104",
        "Query": "data.builtin.kubernetes.KSV104.deny",
        "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 139,
          "EndLine": 139,
          "Code": {
            "Lines": [
              {
                "Number": 139,
                "Content": "---",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "---",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_20",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV013",
      "check_type": "Kubernetes Security Check",
      "title": "Image tag \":latest\" used",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-production.yaml",
      "line": 67,
      "end_line": 190,
      "message": "Container 'backend' of Deployment 'securebank-backend' should specify an image tag",
      "description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
      "remediation": "Use a specific container image tag that is not 'latest'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
        "https://avd.aquasec.com/misconfig/ksv013"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV013",
        "AVDID": "AVD-KSV-0013",
        "Title": "Image tag \":latest\" used",
        "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
        "Message": "Container 'backend' of Deployment 'securebank-backend' should specify an image tag",
        "Namespace": "builtin.kubernetes.KSV013",
        "Query": "data.builtin.kubernetes.KSV013.deny",
        "Resolution": "Use a specific container image tag that is not 'latest'.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
        "References": [
          "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
          "https://avd.aquasec.com/misconfig/ksv013"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 67,
          "EndLine": 190,
          "Code": {
            "Lines": [
              {
                "Number": 67,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 68,
                "Content": "        image: securebank-backend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-backend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 69,
                "Content": "        imagePullPolicy: Never  # Use locally loaded image",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: Never  \u001b[38;5;239m# Use locally loaded image",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 70,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 71,
                "Content": "        - name: http",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: http",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 72,
                "Content": "          containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 73,
                "Content": "          protocol: TCP",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mprotocol\u001b[0m: TCP",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 74,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 75,
                "Content": "        # Load configuration from ConfigMap",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;239m# Load configuration from ConfigMap",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 76,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_21",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV013",
      "check_type": "Kubernetes Security Check",
      "title": "Image tag \":latest\" used",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-production.yaml",
      "line": 243,
      "end_line": 290,
      "message": "Container 'frontend' of Deployment 'securebank-frontend' should specify an image tag",
      "description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
      "remediation": "Use a specific container image tag that is not 'latest'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
        "https://avd.aquasec.com/misconfig/ksv013"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV013",
        "AVDID": "AVD-KSV-0013",
        "Title": "Image tag \":latest\" used",
        "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
        "Message": "Container 'frontend' of Deployment 'securebank-frontend' should specify an image tag",
        "Namespace": "builtin.kubernetes.KSV013",
        "Query": "data.builtin.kubernetes.KSV013.deny",
        "Resolution": "Use a specific container image tag that is not 'latest'.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
        "References": [
          "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
          "https://avd.aquasec.com/misconfig/ksv013"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 243,
          "EndLine": 290,
          "Code": {
            "Lines": [
              {
                "Number": 243,
                "Content": "      - name: frontend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 244,
                "Content": "        image: securebank-frontend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-frontend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 245,
                "Content": "        imagePullPolicy: Never  # Use locally loaded image",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: Never  \u001b[38;5;239m# Use locally loaded image",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 246,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 247,
                "Content": "        - name: http",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: http",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 248,
                "Content": "          containerPort: 3001",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3001",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 249,
                "Content": "          protocol: TCP",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mprotocol\u001b[0m: TCP",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 250,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 251,
                "Content": "        - name: REACT_APP_API_URL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REACT_APP_API_URL",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 252,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_22",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV020",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with UID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-production.yaml",
      "line": 67,
      "end_line": 190,
      "message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.runAsUser' > 10000",
      "description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv020"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV020",
        "AVDID": "AVD-KSV-0020",
        "Title": "Runs with UID <= 10000",
        "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.runAsUser' > 10000",
        "Namespace": "builtin.kubernetes.KSV020",
        "Query": "data.builtin.kubernetes.KSV020.deny",
        "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv020"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 67,
          "EndLine": 190,
          "Code": {
            "Lines": [
              {
                "Number": 67,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 68,
                "Content": "        image: securebank-backend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-backend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 69,
                "Content": "        imagePullPolicy: Never  # Use locally loaded image",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: Never  \u001b[38;5;239m# Use locally loaded image",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 70,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 71,
                "Content": "        - name: http",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: http",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 72,
                "Content": "          containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 73,
                "Content": "          protocol: TCP",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mprotocol\u001b[0m: TCP",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 74,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 75,
                "Content": "        # Load configuration from ConfigMap",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;239m# Load configuration from ConfigMap",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 76,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_23",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV020",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with UID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-production.yaml",
      "line": 243,
      "end_line": 290,
      "message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'securityContext.runAsUser' > 10000",
      "description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv020"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV020",
        "AVDID": "AVD-KSV-0020",
        "Title": "Runs with UID <= 10000",
        "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'securityContext.runAsUser' > 10000",
        "Namespace": "builtin.kubernetes.KSV020",
        "Query": "data.builtin.kubernetes.KSV020.deny",
        "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv020"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 243,
          "EndLine": 290,
          "Code": {
            "Lines": [
              {
                "Number": 243,
                "Content": "      - name: frontend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 244,
                "Content": "        image: securebank-frontend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-frontend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 245,
                "Content": "        imagePullPolicy: Never  # Use locally loaded image",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: Never  \u001b[38;5;239m# Use locally loaded image",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 246,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 247,
                "Content": "        - name: http",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: http",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 248,
                "Content": "          containerPort: 3001",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3001",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 249,
                "Content": "          protocol: TCP",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mprotocol\u001b[0m: TCP",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 250,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 251,
                "Content": "        - name: REACT_APP_API_URL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REACT_APP_API_URL",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 252,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_24",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV020",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with UID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-production.yaml",
      "line": 340,
      "end_line": 399,
      "message": "Container 'postgres' of Deployment 'postgres' should set 'securityContext.runAsUser' > 10000",
      "description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv020"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV020",
        "AVDID": "AVD-KSV-0020",
        "Title": "Runs with UID <= 10000",
        "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'postgres' of Deployment 'postgres' should set 'securityContext.runAsUser' > 10000",
        "Namespace": "builtin.kubernetes.KSV020",
        "Query": "data.builtin.kubernetes.KSV020.deny",
        "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv020"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 340,
          "EndLine": 399,
          "Code": {
            "Lines": [
              {
                "Number": 340,
                "Content": "      - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 341,
                "Content": "        image: postgres:14-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: postgres:14-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 342,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 343,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 344,
                "Content": "        - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 345,
                "Content": "          containerPort: 5432",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 346,
                "Content": "          protocol: TCP",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mprotocol\u001b[0m: TCP",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 347,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 348,
                "Content": "        - name: POSTGRES_DB",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POSTGRES_DB",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 349,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_25",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV020",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with UID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-production.yaml",
      "line": 449,
      "end_line": 502,
      "message": "Container 'redis' of Deployment 'redis' should set 'securityContext.runAsUser' > 10000",
      "description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv020"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV020",
        "AVDID": "AVD-KSV-0020",
        "Title": "Runs with UID <= 10000",
        "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'redis' of Deployment 'redis' should set 'securityContext.runAsUser' > 10000",
        "Namespace": "builtin.kubernetes.KSV020",
        "Query": "data.builtin.kubernetes.KSV020.deny",
        "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv020"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 449,
          "EndLine": 502,
          "Code": {
            "Lines": [
              {
                "Number": 449,
                "Content": "      - name: redis",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 450,
                "Content": "        image: redis:7-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:7-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 451,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 452,
                "Content": "        command:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 453,
                "Content": "        - redis-server",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis-server",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 454,
                "Content": "        - --dir",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --dir",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 455,
                "Content": "        - /data",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - /data",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 456,
                "Content": "        - --save",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --save",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 457,
                "Content": "        - \"60\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;37m\"60\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 458,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_26",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV021",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with GID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-production.yaml",
      "line": 67,
      "end_line": 190,
      "message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.runAsGroup' > 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 67,
          "EndLine": 190,
          "Code": {
            "Lines": [
              {
                "Number": 67,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 68,
                "Content": "        image: securebank-backend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-backend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 69,
                "Content": "        imagePullPolicy: Never  # Use locally loaded image",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: Never  \u001b[38;5;239m# Use locally loaded image",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 70,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 71,
                "Content": "        - name: http",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: http",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 72,
                "Content": "          containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 73,
                "Content": "          protocol: TCP",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mprotocol\u001b[0m: TCP",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 74,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 75,
                "Content": "        # Load configuration from ConfigMap",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;239m# Load configuration from ConfigMap",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 76,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_27",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV021",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with GID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-production.yaml",
      "line": 243,
      "end_line": 290,
      "message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'securityContext.runAsGroup' > 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 243,
          "EndLine": 290,
          "Code": {
            "Lines": [
              {
                "Number": 243,
                "Content": "      - name: frontend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 244,
                "Content": "        image: securebank-frontend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-frontend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 245,
                "Content": "        imagePullPolicy: Never  # Use locally loaded image",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: Never  \u001b[38;5;239m# Use locally loaded image",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 246,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 247,
                "Content": "        - name: http",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: http",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 248,
                "Content": "          containerPort: 3001",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3001",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 249,
                "Content": "          protocol: TCP",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mprotocol\u001b[0m: TCP",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 250,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 251,
                "Content": "        - name: REACT_APP_API_URL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REACT_APP_API_URL",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 252,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_28",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV021",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with GID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-production.yaml",
      "line": 340,
      "end_line": 399,
      "message": "Container 'postgres' of Deployment 'postgres' should set 'securityContext.runAsGroup' > 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'postgres' of Deployment 'postgres' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 340,
          "EndLine": 399,
          "Code": {
            "Lines": [
              {
                "Number": 340,
                "Content": "      - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 341,
                "Content": "        image: postgres:14-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: postgres:14-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 342,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 343,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 344,
                "Content": "        - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 345,
                "Content": "          containerPort: 5432",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 346,
                "Content": "          protocol: TCP",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mprotocol\u001b[0m: TCP",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 347,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 348,
                "Content": "        - name: POSTGRES_DB",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POSTGRES_DB",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 349,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_29",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV021",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with GID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-production.yaml",
      "line": 449,
      "end_line": 502,
      "message": "Container 'redis' of Deployment 'redis' should set 'securityContext.runAsGroup' > 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'redis' of Deployment 'redis' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 449,
          "EndLine": 502,
          "Code": {
            "Lines": [
              {
                "Number": 449,
                "Content": "      - name: redis",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 450,
                "Content": "        image: redis:7-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:7-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 451,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 452,
                "Content": "        command:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 453,
                "Content": "        - redis-server",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis-server",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 454,
                "Content": "        - --dir",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --dir",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 455,
                "Content": "        - /data",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - /data",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 456,
                "Content": "        - --save",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --save",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 457,
                "Content": "        - \"60\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;37m\"60\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 458,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_30",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV030",
      "check_type": "Kubernetes Security Check",
      "title": "Runtime/Default Seccomp profile not set",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-production.yaml",
      "line": 67,
      "end_line": 190,
      "message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
      "description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
      "remediation": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv030"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV030",
        "AVDID": "AVD-KSV-0030",
        "Title": "Runtime/Default Seccomp profile not set",
        "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
        "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
        "Namespace": "builtin.kubernetes.KSV030",
        "Query": "data.builtin.kubernetes.KSV030.deny",
        "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv030"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 67,
          "EndLine": 190,
          "Code": {
            "Lines": [
              {
                "Number": 67,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 68,
                "Content": "        image: securebank-backend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-backend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 69,
                "Content": "        imagePullPolicy: Never  # Use locally loaded image",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: Never  \u001b[38;5;239m# Use locally loaded image",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 70,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 71,
                "Content": "        - name: http",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: http",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 72,
                "Content": "          containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 73,
                "Content": "          protocol: TCP",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mprotocol\u001b[0m: TCP",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 74,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 75,
                "Content": "        # Load configuration from ConfigMap",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;239m# Load configuration from ConfigMap",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 76,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_31",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV030",
      "check_type": "Kubernetes Security Check",
      "title": "Runtime/Default Seccomp profile not set",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-production.yaml",
      "line": 243,
      "end_line": 290,
      "message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
      "description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
      "remediation": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv030"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV030",
        "AVDID": "AVD-KSV-0030",
        "Title": "Runtime/Default Seccomp profile not set",
        "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
        "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
        "Namespace": "builtin.kubernetes.KSV030",
        "Query": "data.builtin.kubernetes.KSV030.deny",
        "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv030"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 243,
          "EndLine": 290,
          "Code": {
            "Lines": [
              {
                "Number": 243,
                "Content": "      - name: frontend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 244,
                "Content": "        image: securebank-frontend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-frontend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 245,
                "Content": "        imagePullPolicy: Never  # Use locally loaded image",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: Never  \u001b[38;5;239m# Use locally loaded image",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 246,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 247,
                "Content": "        - name: http",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: http",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 248,
                "Content": "          containerPort: 3001",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3001",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 249,
                "Content": "          protocol: TCP",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mprotocol\u001b[0m: TCP",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 250,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 251,
                "Content": "        - name: REACT_APP_API_URL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REACT_APP_API_URL",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 252,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_32",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV030",
      "check_type": "Kubernetes Security Check",
      "title": "Runtime/Default Seccomp profile not set",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-production.yaml",
      "line": 340,
      "end_line": 399,
      "message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
      "description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
      "remediation": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv030"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV030",
        "AVDID": "AVD-KSV-0030",
        "Title": "Runtime/Default Seccomp profile not set",
        "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
        "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
        "Namespace": "builtin.kubernetes.KSV030",
        "Query": "data.builtin.kubernetes.KSV030.deny",
        "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv030"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 340,
          "EndLine": 399,
          "Code": {
            "Lines": [
              {
                "Number": 340,
                "Content": "      - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 341,
                "Content": "        image: postgres:14-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: postgres:14-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 342,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 343,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 344,
                "Content": "        - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 345,
                "Content": "          containerPort: 5432",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 346,
                "Content": "          protocol: TCP",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mprotocol\u001b[0m: TCP",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 347,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 348,
                "Content": "        - name: POSTGRES_DB",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POSTGRES_DB",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 349,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_33",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV030",
      "check_type": "Kubernetes Security Check",
      "title": "Runtime/Default Seccomp profile not set",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-production.yaml",
      "line": 449,
      "end_line": 502,
      "message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
      "description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
      "remediation": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv030"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV030",
        "AVDID": "AVD-KSV-0030",
        "Title": "Runtime/Default Seccomp profile not set",
        "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
        "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
        "Namespace": "builtin.kubernetes.KSV030",
        "Query": "data.builtin.kubernetes.KSV030.deny",
        "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv030"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 449,
          "EndLine": 502,
          "Code": {
            "Lines": [
              {
                "Number": 449,
                "Content": "      - name: redis",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 450,
                "Content": "        image: redis:7-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:7-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 451,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 452,
                "Content": "        command:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 453,
                "Content": "        - redis-server",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis-server",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 454,
                "Content": "        - --dir",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --dir",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 455,
                "Content": "        - /data",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - /data",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 456,
                "Content": "        - --save",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --save",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 457,
                "Content": "        - \"60\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;37m\"60\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 458,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_34",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-KSV-01010",
      "check_type": "Kubernetes Security Check",
      "title": "ConfigMap with sensitive content",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-production.yaml",
      "line": 8,
      "end_line": 8,
      "message": "ConfigMap 'backend-config' in 'securebank' namespace stores sensitive contents in key(s) or value(s) '{\"DATABASE_PORT\", \"PORT\", \"REDIS_PORT\"}'",
      "description": "Storing sensitive content such as usernames and email addresses in configMaps is unsafe",
      "remediation": "Remove sensitive content from configMap data value",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://avd.aquasec.com/misconfig/avd-ksv-01010"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "AVD-KSV-01010",
        "AVDID": "AVD-KSV-01010",
        "Title": "ConfigMap with sensitive content",
        "Description": "Storing sensitive content such as usernames and email addresses in configMaps is unsafe",
        "Message": "ConfigMap 'backend-config' in 'securebank' namespace stores sensitive contents in key(s) or value(s) '{\"DATABASE_PORT\", \"PORT\", \"REDIS_PORT\"}'",
        "Namespace": "builtin.kubernetes.KSV01010",
        "Query": "data.builtin.kubernetes.KSV01010.deny",
        "Resolution": "Remove sensitive content from configMap data value",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-ksv-01010",
        "References": [
          "https://avd.aquasec.com/misconfig/avd-ksv-01010"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 8,
          "EndLine": 8,
          "Code": {
            "Lines": [
              {
                "Number": 8,
                "Content": "---",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "---",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_35",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV104",
      "check_type": "Kubernetes Security Check",
      "title": "Seccomp policies disabled",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-production.yaml",
      "line": 42,
      "end_line": 42,
      "message": "container \"backend\" of deployment \"securebank-backend\" in \"securebank\" namespace should specify a seccomp profile",
      "description": "A program inside the container can bypass Seccomp protection policies.",
      "remediation": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv104"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV104",
        "AVDID": "AVD-KSV-0104",
        "Title": "Seccomp policies disabled",
        "Description": "A program inside the container can bypass Seccomp protection policies.",
        "Message": "container \"backend\" of deployment \"securebank-backend\" in \"securebank\" namespace should specify a seccomp profile",
        "Namespace": "builtin.kubernetes.KSV104",
        "Query": "data.builtin.kubernetes.KSV104.deny",
        "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 42,
          "EndLine": 42,
          "Code": {
            "Lines": [
              {
                "Number": 42,
                "Content": "---",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "---",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_36",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV104",
      "check_type": "Kubernetes Security Check",
      "title": "Seccomp policies disabled",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-production.yaml",
      "line": 218,
      "end_line": 218,
      "message": "container \"frontend\" of deployment \"securebank-frontend\" in \"securebank\" namespace should specify a seccomp profile",
      "description": "A program inside the container can bypass Seccomp protection policies.",
      "remediation": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv104"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV104",
        "AVDID": "AVD-KSV-0104",
        "Title": "Seccomp policies disabled",
        "Description": "A program inside the container can bypass Seccomp protection policies.",
        "Message": "container \"frontend\" of deployment \"securebank-frontend\" in \"securebank\" namespace should specify a seccomp profile",
        "Namespace": "builtin.kubernetes.KSV104",
        "Query": "data.builtin.kubernetes.KSV104.deny",
        "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 218,
          "EndLine": 218,
          "Code": {
            "Lines": [
              {
                "Number": 218,
                "Content": "---",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "---",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_37",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV104",
      "check_type": "Kubernetes Security Check",
      "title": "Seccomp policies disabled",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-production.yaml",
      "line": 318,
      "end_line": 318,
      "message": "container \"postgres\" of deployment \"postgres\" in \"securebank\" namespace should specify a seccomp profile",
      "description": "A program inside the container can bypass Seccomp protection policies.",
      "remediation": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv104"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV104",
        "AVDID": "AVD-KSV-0104",
        "Title": "Seccomp policies disabled",
        "Description": "A program inside the container can bypass Seccomp protection policies.",
        "Message": "container \"postgres\" of deployment \"postgres\" in \"securebank\" namespace should specify a seccomp profile",
        "Namespace": "builtin.kubernetes.KSV104",
        "Query": "data.builtin.kubernetes.KSV104.deny",
        "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 318,
          "EndLine": 318,
          "Code": {
            "Lines": [
              {
                "Number": 318,
                "Content": "---",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "---",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_38",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV104",
      "check_type": "Kubernetes Security Check",
      "title": "Seccomp policies disabled",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-production.yaml",
      "line": 427,
      "end_line": 427,
      "message": "container \"redis\" of deployment \"redis\" in \"securebank\" namespace should specify a seccomp profile",
      "description": "A program inside the container can bypass Seccomp protection policies.",
      "remediation": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv104"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV104",
        "AVDID": "AVD-KSV-0104",
        "Title": "Seccomp policies disabled",
        "Description": "A program inside the container can bypass Seccomp protection policies.",
        "Message": "container \"redis\" of deployment \"redis\" in \"securebank\" namespace should specify a seccomp profile",
        "Namespace": "builtin.kubernetes.KSV104",
        "Query": "data.builtin.kubernetes.KSV104.deny",
        "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 427,
          "EndLine": 427,
          "Code": {
            "Lines": [
              {
                "Number": 427,
                "Content": "---",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "---",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_39",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV001",
      "check_type": "Kubernetes Security Check",
      "title": "Can elevate its own privileges",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 241,
      "end_line": 316,
      "message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.allowPrivilegeEscalation' to false",
      "description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
      "remediation": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv001"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV001",
        "AVDID": "AVD-KSV-0001",
        "Title": "Can elevate its own privileges",
        "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
        "Message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.allowPrivilegeEscalation' to false",
        "Namespace": "builtin.kubernetes.KSV001",
        "Query": "data.builtin.kubernetes.KSV001.deny",
        "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv001"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 241,
          "EndLine": 316,
          "Code": {
            "Lines": [
              {
                "Number": 241,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 242,
                "Content": "        image: securebank-backend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-backend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 243,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 244,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 245,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 246,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 247,
                "Content": "        - name: DATABASE_HOST",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATABASE_HOST",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 248,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 249,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 250,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_40",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV001",
      "check_type": "Kubernetes Security Check",
      "title": "Can elevate its own privileges",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 366,
      "end_line": 376,
      "message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'securityContext.allowPrivilegeEscalation' to false",
      "description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
      "remediation": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv001"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV001",
        "AVDID": "AVD-KSV-0001",
        "Title": "Can elevate its own privileges",
        "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
        "Message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'securityContext.allowPrivilegeEscalation' to false",
        "Namespace": "builtin.kubernetes.KSV001",
        "Query": "data.builtin.kubernetes.KSV001.deny",
        "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv001"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 366,
          "EndLine": 376,
          "Code": {
            "Lines": [
              {
                "Number": 366,
                "Content": "      - name: frontend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 367,
                "Content": "        image: securebank-frontend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-frontend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 368,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 369,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 370,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 371,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 372,
                "Content": "        - name: REACT_APP_API_URL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REACT_APP_API_URL",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 373,
                "Content": "          value: \"http://securebank-backend-service\"  # \u274c HTTP not HTTPS",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://securebank-backend-service\"\u001b[0m  \u001b[38;5;239m# \u274c HTTP not HTTPS",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 374,
                "Content": "        # \u274c No resource limits",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;239m# \u274c No resource limits",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 375,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_41",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV001",
      "check_type": "Kubernetes Security Check",
      "title": "Can elevate its own privileges",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 96,
      "end_line": 120,
      "message": "Container 'postgres' of Deployment 'postgres' should set 'securityContext.allowPrivilegeEscalation' to false",
      "description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
      "remediation": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv001"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV001",
        "AVDID": "AVD-KSV-0001",
        "Title": "Can elevate its own privileges",
        "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
        "Message": "Container 'postgres' of Deployment 'postgres' should set 'securityContext.allowPrivilegeEscalation' to false",
        "Namespace": "builtin.kubernetes.KSV001",
        "Query": "data.builtin.kubernetes.KSV001.deny",
        "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv001"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 96,
          "EndLine": 120,
          "Code": {
            "Lines": [
              {
                "Number": 96,
                "Content": "      - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 97,
                "Content": "        image: postgres:14",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: postgres:14",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 98,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 99,
                "Content": "        - containerPort: 5432",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 100,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 101,
                "Content": "        - name: POSTGRES_DB",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POSTGRES_DB",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 102,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 103,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 104,
                "Content": "              name: database-secrets",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33mname\u001b[0m: database-secrets",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 105,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_42",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV001",
      "check_type": "Kubernetes Security Check",
      "title": "Can elevate its own privileges",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 188,
      "end_line": 195,
      "message": "Container 'redis' of Deployment 'redis' should set 'securityContext.allowPrivilegeEscalation' to false",
      "description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
      "remediation": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv001"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV001",
        "AVDID": "AVD-KSV-0001",
        "Title": "Can elevate its own privileges",
        "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
        "Message": "Container 'redis' of Deployment 'redis' should set 'securityContext.allowPrivilegeEscalation' to false",
        "Namespace": "builtin.kubernetes.KSV001",
        "Query": "data.builtin.kubernetes.KSV001.deny",
        "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv001"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 188,
          "EndLine": 195,
          "Code": {
            "Lines": [
              {
                "Number": 188,
                "Content": "      - name: redis",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 189,
                "Content": "        image: redis:7-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:7-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 190,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 191,
                "Content": "        - containerPort: 6379",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 192,
                "Content": "        command:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 193,
                "Content": "        - redis-server",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis-server",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 194,
                "Content": "        - --requirepass",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --requirepass",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 195,
                "Content": "        - redis_insecure_pwd  # \u274c Hardcoded password",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis_insecure_pwd  \u001b[38;5;239m# \u274c Hardcoded password",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_43",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV003",
      "check_type": "Kubernetes Security Check",
      "title": "Default capabilities: some containers do not drop all",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 241,
      "end_line": 316,
      "message": "Container 'backend' of Deployment 'securebank-backend' should add 'ALL' to 'securityContext.capabilities.drop'",
      "description": "The container should drop all default capabilities and add only those that are needed for its execution.",
      "remediation": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
        "https://avd.aquasec.com/misconfig/ksv003"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV003",
        "AVDID": "AVD-KSV-0003",
        "Title": "Default capabilities: some containers do not drop all",
        "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
        "Message": "Container 'backend' of Deployment 'securebank-backend' should add 'ALL' to 'securityContext.capabilities.drop'",
        "Namespace": "builtin.kubernetes.KSV003",
        "Query": "data.builtin.kubernetes.KSV003.deny",
        "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
          "https://avd.aquasec.com/misconfig/ksv003"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 241,
          "EndLine": 316,
          "Code": {
            "Lines": [
              {
                "Number": 241,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 242,
                "Content": "        image: securebank-backend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-backend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 243,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 244,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 245,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 246,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 247,
                "Content": "        - name: DATABASE_HOST",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATABASE_HOST",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 248,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 249,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 250,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_44",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV003",
      "check_type": "Kubernetes Security Check",
      "title": "Default capabilities: some containers do not drop all",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 366,
      "end_line": 376,
      "message": "Container 'frontend' of Deployment 'securebank-frontend' should add 'ALL' to 'securityContext.capabilities.drop'",
      "description": "The container should drop all default capabilities and add only those that are needed for its execution.",
      "remediation": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
        "https://avd.aquasec.com/misconfig/ksv003"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV003",
        "AVDID": "AVD-KSV-0003",
        "Title": "Default capabilities: some containers do not drop all",
        "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
        "Message": "Container 'frontend' of Deployment 'securebank-frontend' should add 'ALL' to 'securityContext.capabilities.drop'",
        "Namespace": "builtin.kubernetes.KSV003",
        "Query": "data.builtin.kubernetes.KSV003.deny",
        "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
          "https://avd.aquasec.com/misconfig/ksv003"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 366,
          "EndLine": 376,
          "Code": {
            "Lines": [
              {
                "Number": 366,
                "Content": "      - name: frontend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 367,
                "Content": "        image: securebank-frontend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-frontend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 368,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 369,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 370,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 371,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 372,
                "Content": "        - name: REACT_APP_API_URL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REACT_APP_API_URL",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 373,
                "Content": "          value: \"http://securebank-backend-service\"  # \u274c HTTP not HTTPS",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://securebank-backend-service\"\u001b[0m  \u001b[38;5;239m# \u274c HTTP not HTTPS",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 374,
                "Content": "        # \u274c No resource limits",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;239m# \u274c No resource limits",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 375,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_45",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV003",
      "check_type": "Kubernetes Security Check",
      "title": "Default capabilities: some containers do not drop all",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 96,
      "end_line": 120,
      "message": "Container 'postgres' of Deployment 'postgres' should add 'ALL' to 'securityContext.capabilities.drop'",
      "description": "The container should drop all default capabilities and add only those that are needed for its execution.",
      "remediation": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
        "https://avd.aquasec.com/misconfig/ksv003"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV003",
        "AVDID": "AVD-KSV-0003",
        "Title": "Default capabilities: some containers do not drop all",
        "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
        "Message": "Container 'postgres' of Deployment 'postgres' should add 'ALL' to 'securityContext.capabilities.drop'",
        "Namespace": "builtin.kubernetes.KSV003",
        "Query": "data.builtin.kubernetes.KSV003.deny",
        "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
          "https://avd.aquasec.com/misconfig/ksv003"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 96,
          "EndLine": 120,
          "Code": {
            "Lines": [
              {
                "Number": 96,
                "Content": "      - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 97,
                "Content": "        image: postgres:14",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: postgres:14",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 98,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 99,
                "Content": "        - containerPort: 5432",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 100,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 101,
                "Content": "        - name: POSTGRES_DB",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POSTGRES_DB",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 102,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 103,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 104,
                "Content": "              name: database-secrets",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33mname\u001b[0m: database-secrets",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 105,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_46",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV003",
      "check_type": "Kubernetes Security Check",
      "title": "Default capabilities: some containers do not drop all",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 188,
      "end_line": 195,
      "message": "Container 'redis' of Deployment 'redis' should add 'ALL' to 'securityContext.capabilities.drop'",
      "description": "The container should drop all default capabilities and add only those that are needed for its execution.",
      "remediation": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
        "https://avd.aquasec.com/misconfig/ksv003"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV003",
        "AVDID": "AVD-KSV-0003",
        "Title": "Default capabilities: some containers do not drop all",
        "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
        "Message": "Container 'redis' of Deployment 'redis' should add 'ALL' to 'securityContext.capabilities.drop'",
        "Namespace": "builtin.kubernetes.KSV003",
        "Query": "data.builtin.kubernetes.KSV003.deny",
        "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
          "https://avd.aquasec.com/misconfig/ksv003"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 188,
          "EndLine": 195,
          "Code": {
            "Lines": [
              {
                "Number": 188,
                "Content": "      - name: redis",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 189,
                "Content": "        image: redis:7-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:7-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 190,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 191,
                "Content": "        - containerPort: 6379",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 192,
                "Content": "        command:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 193,
                "Content": "        - redis-server",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis-server",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 194,
                "Content": "        - --requirepass",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --requirepass",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 195,
                "Content": "        - redis_insecure_pwd  # \u274c Hardcoded password",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis_insecure_pwd  \u001b[38;5;239m# \u274c Hardcoded password",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_47",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV005",
      "check_type": "Kubernetes Security Check",
      "title": "SYS_ADMIN capability added",
      "severity": "HIGH",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 241,
      "end_line": 316,
      "message": "Container 'backend' of Deployment 'securebank-backend' should not include 'SYS_ADMIN' in 'securityContext.capabilities.add'",
      "description": "SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.",
      "remediation": "Remove the SYS_ADMIN capability from 'containers[].securityContext.capabilities.add'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-capabilities-add-index-sys-admin/",
        "https://avd.aquasec.com/misconfig/ksv005"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV005",
        "AVDID": "AVD-KSV-0005",
        "Title": "SYS_ADMIN capability added",
        "Description": "SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.",
        "Message": "Container 'backend' of Deployment 'securebank-backend' should not include 'SYS_ADMIN' in 'securityContext.capabilities.add'",
        "Namespace": "builtin.kubernetes.KSV005",
        "Query": "data.builtin.kubernetes.KSV005.deny",
        "Resolution": "Remove the SYS_ADMIN capability from 'containers[].securityContext.capabilities.add'.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv005",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-capabilities-add-index-sys-admin/",
          "https://avd.aquasec.com/misconfig/ksv005"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 241,
          "EndLine": 316,
          "Code": {
            "Lines": [
              {
                "Number": 241,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 242,
                "Content": "        image: securebank-backend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-backend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 243,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 244,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 245,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 246,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 247,
                "Content": "        - name: DATABASE_HOST",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATABASE_HOST",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 248,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 249,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 250,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_48",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV011",
      "check_type": "Kubernetes Security Check",
      "title": "CPU not limited",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 241,
      "end_line": 316,
      "message": "Container 'backend' of Deployment 'securebank-backend' should set 'resources.limits.cpu'",
      "description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
      "remediation": "Set a limit value under 'containers[].resources.limits.cpu'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
        "https://avd.aquasec.com/misconfig/ksv011"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV011",
        "AVDID": "AVD-KSV-0011",
        "Title": "CPU not limited",
        "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
        "Message": "Container 'backend' of Deployment 'securebank-backend' should set 'resources.limits.cpu'",
        "Namespace": "builtin.kubernetes.KSV011",
        "Query": "data.builtin.kubernetes.KSV011.deny",
        "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
        "References": [
          "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
          "https://avd.aquasec.com/misconfig/ksv011"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 241,
          "EndLine": 316,
          "Code": {
            "Lines": [
              {
                "Number": 241,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 242,
                "Content": "        image: securebank-backend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-backend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 243,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 244,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 245,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 246,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 247,
                "Content": "        - name: DATABASE_HOST",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATABASE_HOST",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 248,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 249,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 250,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_49",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV011",
      "check_type": "Kubernetes Security Check",
      "title": "CPU not limited",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 366,
      "end_line": 376,
      "message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'resources.limits.cpu'",
      "description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
      "remediation": "Set a limit value under 'containers[].resources.limits.cpu'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
        "https://avd.aquasec.com/misconfig/ksv011"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV011",
        "AVDID": "AVD-KSV-0011",
        "Title": "CPU not limited",
        "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
        "Message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'resources.limits.cpu'",
        "Namespace": "builtin.kubernetes.KSV011",
        "Query": "data.builtin.kubernetes.KSV011.deny",
        "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
        "References": [
          "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
          "https://avd.aquasec.com/misconfig/ksv011"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 366,
          "EndLine": 376,
          "Code": {
            "Lines": [
              {
                "Number": 366,
                "Content": "      - name: frontend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 367,
                "Content": "        image: securebank-frontend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-frontend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 368,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 369,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 370,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 371,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 372,
                "Content": "        - name: REACT_APP_API_URL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REACT_APP_API_URL",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 373,
                "Content": "          value: \"http://securebank-backend-service\"  # \u274c HTTP not HTTPS",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://securebank-backend-service\"\u001b[0m  \u001b[38;5;239m# \u274c HTTP not HTTPS",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 374,
                "Content": "        # \u274c No resource limits",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;239m# \u274c No resource limits",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 375,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_50",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV011",
      "check_type": "Kubernetes Security Check",
      "title": "CPU not limited",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 96,
      "end_line": 120,
      "message": "Container 'postgres' of Deployment 'postgres' should set 'resources.limits.cpu'",
      "description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
      "remediation": "Set a limit value under 'containers[].resources.limits.cpu'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
        "https://avd.aquasec.com/misconfig/ksv011"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV011",
        "AVDID": "AVD-KSV-0011",
        "Title": "CPU not limited",
        "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
        "Message": "Container 'postgres' of Deployment 'postgres' should set 'resources.limits.cpu'",
        "Namespace": "builtin.kubernetes.KSV011",
        "Query": "data.builtin.kubernetes.KSV011.deny",
        "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
        "References": [
          "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
          "https://avd.aquasec.com/misconfig/ksv011"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 96,
          "EndLine": 120,
          "Code": {
            "Lines": [
              {
                "Number": 96,
                "Content": "      - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 97,
                "Content": "        image: postgres:14",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: postgres:14",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 98,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 99,
                "Content": "        - containerPort: 5432",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 100,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 101,
                "Content": "        - name: POSTGRES_DB",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POSTGRES_DB",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 102,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 103,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 104,
                "Content": "              name: database-secrets",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33mname\u001b[0m: database-secrets",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 105,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_51",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV011",
      "check_type": "Kubernetes Security Check",
      "title": "CPU not limited",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 188,
      "end_line": 195,
      "message": "Container 'redis' of Deployment 'redis' should set 'resources.limits.cpu'",
      "description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
      "remediation": "Set a limit value under 'containers[].resources.limits.cpu'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
        "https://avd.aquasec.com/misconfig/ksv011"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV011",
        "AVDID": "AVD-KSV-0011",
        "Title": "CPU not limited",
        "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
        "Message": "Container 'redis' of Deployment 'redis' should set 'resources.limits.cpu'",
        "Namespace": "builtin.kubernetes.KSV011",
        "Query": "data.builtin.kubernetes.KSV011.deny",
        "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
        "References": [
          "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
          "https://avd.aquasec.com/misconfig/ksv011"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 188,
          "EndLine": 195,
          "Code": {
            "Lines": [
              {
                "Number": 188,
                "Content": "      - name: redis",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 189,
                "Content": "        image: redis:7-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:7-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 190,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 191,
                "Content": "        - containerPort: 6379",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 192,
                "Content": "        command:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 193,
                "Content": "        - redis-server",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis-server",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 194,
                "Content": "        - --requirepass",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --requirepass",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 195,
                "Content": "        - redis_insecure_pwd  # \u274c Hardcoded password",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis_insecure_pwd  \u001b[38;5;239m# \u274c Hardcoded password",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_52",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV012",
      "check_type": "Kubernetes Security Check",
      "title": "Runs as root user",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 241,
      "end_line": 316,
      "message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.runAsNonRoot' to true",
      "description": "Force the running image to run as a non-root user to ensure least privileges.",
      "remediation": "Set 'containers[].securityContext.runAsNonRoot' to true.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv012"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV012",
        "AVDID": "AVD-KSV-0012",
        "Title": "Runs as root user",
        "Description": "Force the running image to run as a non-root user to ensure least privileges.",
        "Message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.runAsNonRoot' to true",
        "Namespace": "builtin.kubernetes.KSV012",
        "Query": "data.builtin.kubernetes.KSV012.deny",
        "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv012"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 241,
          "EndLine": 316,
          "Code": {
            "Lines": [
              {
                "Number": 241,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 242,
                "Content": "        image: securebank-backend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-backend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 243,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 244,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 245,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 246,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 247,
                "Content": "        - name: DATABASE_HOST",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATABASE_HOST",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 248,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 249,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 250,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_53",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV012",
      "check_type": "Kubernetes Security Check",
      "title": "Runs as root user",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 366,
      "end_line": 376,
      "message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'securityContext.runAsNonRoot' to true",
      "description": "Force the running image to run as a non-root user to ensure least privileges.",
      "remediation": "Set 'containers[].securityContext.runAsNonRoot' to true.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv012"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV012",
        "AVDID": "AVD-KSV-0012",
        "Title": "Runs as root user",
        "Description": "Force the running image to run as a non-root user to ensure least privileges.",
        "Message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'securityContext.runAsNonRoot' to true",
        "Namespace": "builtin.kubernetes.KSV012",
        "Query": "data.builtin.kubernetes.KSV012.deny",
        "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv012"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 366,
          "EndLine": 376,
          "Code": {
            "Lines": [
              {
                "Number": 366,
                "Content": "      - name: frontend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 367,
                "Content": "        image: securebank-frontend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-frontend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 368,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 369,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 370,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 371,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 372,
                "Content": "        - name: REACT_APP_API_URL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REACT_APP_API_URL",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 373,
                "Content": "          value: \"http://securebank-backend-service\"  # \u274c HTTP not HTTPS",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://securebank-backend-service\"\u001b[0m  \u001b[38;5;239m# \u274c HTTP not HTTPS",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 374,
                "Content": "        # \u274c No resource limits",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;239m# \u274c No resource limits",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 375,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_54",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV012",
      "check_type": "Kubernetes Security Check",
      "title": "Runs as root user",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 96,
      "end_line": 120,
      "message": "Container 'postgres' of Deployment 'postgres' should set 'securityContext.runAsNonRoot' to true",
      "description": "Force the running image to run as a non-root user to ensure least privileges.",
      "remediation": "Set 'containers[].securityContext.runAsNonRoot' to true.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv012"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV012",
        "AVDID": "AVD-KSV-0012",
        "Title": "Runs as root user",
        "Description": "Force the running image to run as a non-root user to ensure least privileges.",
        "Message": "Container 'postgres' of Deployment 'postgres' should set 'securityContext.runAsNonRoot' to true",
        "Namespace": "builtin.kubernetes.KSV012",
        "Query": "data.builtin.kubernetes.KSV012.deny",
        "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv012"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 96,
          "EndLine": 120,
          "Code": {
            "Lines": [
              {
                "Number": 96,
                "Content": "      - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 97,
                "Content": "        image: postgres:14",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: postgres:14",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 98,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 99,
                "Content": "        - containerPort: 5432",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 100,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 101,
                "Content": "        - name: POSTGRES_DB",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POSTGRES_DB",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 102,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 103,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 104,
                "Content": "              name: database-secrets",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33mname\u001b[0m: database-secrets",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 105,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_55",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV012",
      "check_type": "Kubernetes Security Check",
      "title": "Runs as root user",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 188,
      "end_line": 195,
      "message": "Container 'redis' of Deployment 'redis' should set 'securityContext.runAsNonRoot' to true",
      "description": "Force the running image to run as a non-root user to ensure least privileges.",
      "remediation": "Set 'containers[].securityContext.runAsNonRoot' to true.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv012"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV012",
        "AVDID": "AVD-KSV-0012",
        "Title": "Runs as root user",
        "Description": "Force the running image to run as a non-root user to ensure least privileges.",
        "Message": "Container 'redis' of Deployment 'redis' should set 'securityContext.runAsNonRoot' to true",
        "Namespace": "builtin.kubernetes.KSV012",
        "Query": "data.builtin.kubernetes.KSV012.deny",
        "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv012"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 188,
          "EndLine": 195,
          "Code": {
            "Lines": [
              {
                "Number": 188,
                "Content": "      - name: redis",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 189,
                "Content": "        image: redis:7-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:7-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 190,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 191,
                "Content": "        - containerPort: 6379",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 192,
                "Content": "        command:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 193,
                "Content": "        - redis-server",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis-server",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 194,
                "Content": "        - --requirepass",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --requirepass",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 195,
                "Content": "        - redis_insecure_pwd  # \u274c Hardcoded password",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis_insecure_pwd  \u001b[38;5;239m# \u274c Hardcoded password",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_56",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV013",
      "check_type": "Kubernetes Security Check",
      "title": "Image tag \":latest\" used",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 241,
      "end_line": 316,
      "message": "Container 'backend' of Deployment 'securebank-backend' should specify an image tag",
      "description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
      "remediation": "Use a specific container image tag that is not 'latest'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
        "https://avd.aquasec.com/misconfig/ksv013"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV013",
        "AVDID": "AVD-KSV-0013",
        "Title": "Image tag \":latest\" used",
        "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
        "Message": "Container 'backend' of Deployment 'securebank-backend' should specify an image tag",
        "Namespace": "builtin.kubernetes.KSV013",
        "Query": "data.builtin.kubernetes.KSV013.deny",
        "Resolution": "Use a specific container image tag that is not 'latest'.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
        "References": [
          "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
          "https://avd.aquasec.com/misconfig/ksv013"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 241,
          "EndLine": 316,
          "Code": {
            "Lines": [
              {
                "Number": 241,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 242,
                "Content": "        image: securebank-backend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-backend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 243,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 244,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 245,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 246,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 247,
                "Content": "        - name: DATABASE_HOST",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATABASE_HOST",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 248,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 249,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 250,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_57",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV013",
      "check_type": "Kubernetes Security Check",
      "title": "Image tag \":latest\" used",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 366,
      "end_line": 376,
      "message": "Container 'frontend' of Deployment 'securebank-frontend' should specify an image tag",
      "description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
      "remediation": "Use a specific container image tag that is not 'latest'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
        "https://avd.aquasec.com/misconfig/ksv013"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV013",
        "AVDID": "AVD-KSV-0013",
        "Title": "Image tag \":latest\" used",
        "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
        "Message": "Container 'frontend' of Deployment 'securebank-frontend' should specify an image tag",
        "Namespace": "builtin.kubernetes.KSV013",
        "Query": "data.builtin.kubernetes.KSV013.deny",
        "Resolution": "Use a specific container image tag that is not 'latest'.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
        "References": [
          "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
          "https://avd.aquasec.com/misconfig/ksv013"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 366,
          "EndLine": 376,
          "Code": {
            "Lines": [
              {
                "Number": 366,
                "Content": "      - name: frontend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 367,
                "Content": "        image: securebank-frontend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-frontend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 368,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 369,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 370,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 371,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 372,
                "Content": "        - name: REACT_APP_API_URL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REACT_APP_API_URL",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 373,
                "Content": "          value: \"http://securebank-backend-service\"  # \u274c HTTP not HTTPS",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://securebank-backend-service\"\u001b[0m  \u001b[38;5;239m# \u274c HTTP not HTTPS",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 374,
                "Content": "        # \u274c No resource limits",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;239m# \u274c No resource limits",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 375,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_58",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV014",
      "check_type": "Kubernetes Security Check",
      "title": "Root file system is not read-only",
      "severity": "HIGH",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 241,
      "end_line": 316,
      "message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.readOnlyRootFilesystem' to true",
      "description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
      "remediation": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
        "https://avd.aquasec.com/misconfig/ksv014"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV014",
        "AVDID": "AVD-KSV-0014",
        "Title": "Root file system is not read-only",
        "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
        "Message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.readOnlyRootFilesystem' to true",
        "Namespace": "builtin.kubernetes.KSV014",
        "Query": "data.builtin.kubernetes.KSV014.deny",
        "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
          "https://avd.aquasec.com/misconfig/ksv014"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 241,
          "EndLine": 316,
          "Code": {
            "Lines": [
              {
                "Number": 241,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 242,
                "Content": "        image: securebank-backend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-backend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 243,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 244,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 245,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 246,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 247,
                "Content": "        - name: DATABASE_HOST",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATABASE_HOST",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 248,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 249,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 250,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_59",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV014",
      "check_type": "Kubernetes Security Check",
      "title": "Root file system is not read-only",
      "severity": "HIGH",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 366,
      "end_line": 376,
      "message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'securityContext.readOnlyRootFilesystem' to true",
      "description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
      "remediation": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
        "https://avd.aquasec.com/misconfig/ksv014"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV014",
        "AVDID": "AVD-KSV-0014",
        "Title": "Root file system is not read-only",
        "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
        "Message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'securityContext.readOnlyRootFilesystem' to true",
        "Namespace": "builtin.kubernetes.KSV014",
        "Query": "data.builtin.kubernetes.KSV014.deny",
        "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
          "https://avd.aquasec.com/misconfig/ksv014"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 366,
          "EndLine": 376,
          "Code": {
            "Lines": [
              {
                "Number": 366,
                "Content": "      - name: frontend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 367,
                "Content": "        image: securebank-frontend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-frontend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 368,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 369,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 370,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 371,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 372,
                "Content": "        - name: REACT_APP_API_URL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REACT_APP_API_URL",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 373,
                "Content": "          value: \"http://securebank-backend-service\"  # \u274c HTTP not HTTPS",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://securebank-backend-service\"\u001b[0m  \u001b[38;5;239m# \u274c HTTP not HTTPS",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 374,
                "Content": "        # \u274c No resource limits",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;239m# \u274c No resource limits",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 375,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_60",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV014",
      "check_type": "Kubernetes Security Check",
      "title": "Root file system is not read-only",
      "severity": "HIGH",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 96,
      "end_line": 120,
      "message": "Container 'postgres' of Deployment 'postgres' should set 'securityContext.readOnlyRootFilesystem' to true",
      "description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
      "remediation": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
        "https://avd.aquasec.com/misconfig/ksv014"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV014",
        "AVDID": "AVD-KSV-0014",
        "Title": "Root file system is not read-only",
        "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
        "Message": "Container 'postgres' of Deployment 'postgres' should set 'securityContext.readOnlyRootFilesystem' to true",
        "Namespace": "builtin.kubernetes.KSV014",
        "Query": "data.builtin.kubernetes.KSV014.deny",
        "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
          "https://avd.aquasec.com/misconfig/ksv014"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 96,
          "EndLine": 120,
          "Code": {
            "Lines": [
              {
                "Number": 96,
                "Content": "      - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 97,
                "Content": "        image: postgres:14",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: postgres:14",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 98,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 99,
                "Content": "        - containerPort: 5432",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 100,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 101,
                "Content": "        - name: POSTGRES_DB",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POSTGRES_DB",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 102,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 103,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 104,
                "Content": "              name: database-secrets",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33mname\u001b[0m: database-secrets",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 105,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_61",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV014",
      "check_type": "Kubernetes Security Check",
      "title": "Root file system is not read-only",
      "severity": "HIGH",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 188,
      "end_line": 195,
      "message": "Container 'redis' of Deployment 'redis' should set 'securityContext.readOnlyRootFilesystem' to true",
      "description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
      "remediation": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
        "https://avd.aquasec.com/misconfig/ksv014"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV014",
        "AVDID": "AVD-KSV-0014",
        "Title": "Root file system is not read-only",
        "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
        "Message": "Container 'redis' of Deployment 'redis' should set 'securityContext.readOnlyRootFilesystem' to true",
        "Namespace": "builtin.kubernetes.KSV014",
        "Query": "data.builtin.kubernetes.KSV014.deny",
        "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
          "https://avd.aquasec.com/misconfig/ksv014"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 188,
          "EndLine": 195,
          "Code": {
            "Lines": [
              {
                "Number": 188,
                "Content": "      - name: redis",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 189,
                "Content": "        image: redis:7-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:7-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 190,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 191,
                "Content": "        - containerPort: 6379",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 192,
                "Content": "        command:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 193,
                "Content": "        - redis-server",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis-server",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 194,
                "Content": "        - --requirepass",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --requirepass",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 195,
                "Content": "        - redis_insecure_pwd  # \u274c Hardcoded password",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis_insecure_pwd  \u001b[38;5;239m# \u274c Hardcoded password",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_62",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV015",
      "check_type": "Kubernetes Security Check",
      "title": "CPU requests not specified",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 241,
      "end_line": 316,
      "message": "Container 'backend' of Deployment 'securebank-backend' should set 'resources.requests.cpu'",
      "description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
      "remediation": "Set 'containers[].resources.requests.cpu'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
        "https://avd.aquasec.com/misconfig/ksv015"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV015",
        "AVDID": "AVD-KSV-0015",
        "Title": "CPU requests not specified",
        "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
        "Message": "Container 'backend' of Deployment 'securebank-backend' should set 'resources.requests.cpu'",
        "Namespace": "builtin.kubernetes.KSV015",
        "Query": "data.builtin.kubernetes.KSV015.deny",
        "Resolution": "Set 'containers[].resources.requests.cpu'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
        "References": [
          "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
          "https://avd.aquasec.com/misconfig/ksv015"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 241,
          "EndLine": 316,
          "Code": {
            "Lines": [
              {
                "Number": 241,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 242,
                "Content": "        image: securebank-backend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-backend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 243,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 244,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 245,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 246,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 247,
                "Content": "        - name: DATABASE_HOST",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATABASE_HOST",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 248,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 249,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 250,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_63",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV015",
      "check_type": "Kubernetes Security Check",
      "title": "CPU requests not specified",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 366,
      "end_line": 376,
      "message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'resources.requests.cpu'",
      "description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
      "remediation": "Set 'containers[].resources.requests.cpu'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
        "https://avd.aquasec.com/misconfig/ksv015"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV015",
        "AVDID": "AVD-KSV-0015",
        "Title": "CPU requests not specified",
        "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
        "Message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'resources.requests.cpu'",
        "Namespace": "builtin.kubernetes.KSV015",
        "Query": "data.builtin.kubernetes.KSV015.deny",
        "Resolution": "Set 'containers[].resources.requests.cpu'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
        "References": [
          "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
          "https://avd.aquasec.com/misconfig/ksv015"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 366,
          "EndLine": 376,
          "Code": {
            "Lines": [
              {
                "Number": 366,
                "Content": "      - name: frontend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 367,
                "Content": "        image: securebank-frontend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-frontend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 368,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 369,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 370,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 371,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 372,
                "Content": "        - name: REACT_APP_API_URL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REACT_APP_API_URL",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 373,
                "Content": "          value: \"http://securebank-backend-service\"  # \u274c HTTP not HTTPS",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://securebank-backend-service\"\u001b[0m  \u001b[38;5;239m# \u274c HTTP not HTTPS",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 374,
                "Content": "        # \u274c No resource limits",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;239m# \u274c No resource limits",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 375,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_64",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV015",
      "check_type": "Kubernetes Security Check",
      "title": "CPU requests not specified",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 96,
      "end_line": 120,
      "message": "Container 'postgres' of Deployment 'postgres' should set 'resources.requests.cpu'",
      "description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
      "remediation": "Set 'containers[].resources.requests.cpu'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
        "https://avd.aquasec.com/misconfig/ksv015"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV015",
        "AVDID": "AVD-KSV-0015",
        "Title": "CPU requests not specified",
        "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
        "Message": "Container 'postgres' of Deployment 'postgres' should set 'resources.requests.cpu'",
        "Namespace": "builtin.kubernetes.KSV015",
        "Query": "data.builtin.kubernetes.KSV015.deny",
        "Resolution": "Set 'containers[].resources.requests.cpu'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
        "References": [
          "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
          "https://avd.aquasec.com/misconfig/ksv015"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 96,
          "EndLine": 120,
          "Code": {
            "Lines": [
              {
                "Number": 96,
                "Content": "      - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 97,
                "Content": "        image: postgres:14",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: postgres:14",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 98,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 99,
                "Content": "        - containerPort: 5432",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 100,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 101,
                "Content": "        - name: POSTGRES_DB",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POSTGRES_DB",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 102,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 103,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 104,
                "Content": "              name: database-secrets",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33mname\u001b[0m: database-secrets",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 105,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_65",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV015",
      "check_type": "Kubernetes Security Check",
      "title": "CPU requests not specified",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 188,
      "end_line": 195,
      "message": "Container 'redis' of Deployment 'redis' should set 'resources.requests.cpu'",
      "description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
      "remediation": "Set 'containers[].resources.requests.cpu'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
        "https://avd.aquasec.com/misconfig/ksv015"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV015",
        "AVDID": "AVD-KSV-0015",
        "Title": "CPU requests not specified",
        "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
        "Message": "Container 'redis' of Deployment 'redis' should set 'resources.requests.cpu'",
        "Namespace": "builtin.kubernetes.KSV015",
        "Query": "data.builtin.kubernetes.KSV015.deny",
        "Resolution": "Set 'containers[].resources.requests.cpu'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
        "References": [
          "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
          "https://avd.aquasec.com/misconfig/ksv015"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 188,
          "EndLine": 195,
          "Code": {
            "Lines": [
              {
                "Number": 188,
                "Content": "      - name: redis",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 189,
                "Content": "        image: redis:7-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:7-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 190,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 191,
                "Content": "        - containerPort: 6379",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 192,
                "Content": "        command:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 193,
                "Content": "        - redis-server",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis-server",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 194,
                "Content": "        - --requirepass",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --requirepass",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 195,
                "Content": "        - redis_insecure_pwd  # \u274c Hardcoded password",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis_insecure_pwd  \u001b[38;5;239m# \u274c Hardcoded password",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_66",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV016",
      "check_type": "Kubernetes Security Check",
      "title": "Memory requests not specified",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 241,
      "end_line": 316,
      "message": "Container 'backend' of Deployment 'securebank-backend' should set 'resources.requests.memory'",
      "description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
      "remediation": "Set 'containers[].resources.requests.memory'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-resources-limits-memory/",
        "https://avd.aquasec.com/misconfig/ksv016"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV016",
        "AVDID": "AVD-KSV-0016",
        "Title": "Memory requests not specified",
        "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
        "Message": "Container 'backend' of Deployment 'securebank-backend' should set 'resources.requests.memory'",
        "Namespace": "builtin.kubernetes.KSV016",
        "Query": "data.builtin.kubernetes.KSV016.deny",
        "Resolution": "Set 'containers[].resources.requests.memory'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
        "References": [
          "https://kubesec.io/basics/containers-resources-limits-memory/",
          "https://avd.aquasec.com/misconfig/ksv016"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 241,
          "EndLine": 316,
          "Code": {
            "Lines": [
              {
                "Number": 241,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 242,
                "Content": "        image: securebank-backend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-backend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 243,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 244,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 245,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 246,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 247,
                "Content": "        - name: DATABASE_HOST",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATABASE_HOST",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 248,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 249,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 250,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_67",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV016",
      "check_type": "Kubernetes Security Check",
      "title": "Memory requests not specified",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 366,
      "end_line": 376,
      "message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'resources.requests.memory'",
      "description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
      "remediation": "Set 'containers[].resources.requests.memory'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-resources-limits-memory/",
        "https://avd.aquasec.com/misconfig/ksv016"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV016",
        "AVDID": "AVD-KSV-0016",
        "Title": "Memory requests not specified",
        "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
        "Message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'resources.requests.memory'",
        "Namespace": "builtin.kubernetes.KSV016",
        "Query": "data.builtin.kubernetes.KSV016.deny",
        "Resolution": "Set 'containers[].resources.requests.memory'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
        "References": [
          "https://kubesec.io/basics/containers-resources-limits-memory/",
          "https://avd.aquasec.com/misconfig/ksv016"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 366,
          "EndLine": 376,
          "Code": {
            "Lines": [
              {
                "Number": 366,
                "Content": "      - name: frontend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 367,
                "Content": "        image: securebank-frontend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-frontend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 368,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 369,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 370,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 371,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 372,
                "Content": "        - name: REACT_APP_API_URL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REACT_APP_API_URL",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 373,
                "Content": "          value: \"http://securebank-backend-service\"  # \u274c HTTP not HTTPS",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://securebank-backend-service\"\u001b[0m  \u001b[38;5;239m# \u274c HTTP not HTTPS",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 374,
                "Content": "        # \u274c No resource limits",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;239m# \u274c No resource limits",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 375,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_68",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV016",
      "check_type": "Kubernetes Security Check",
      "title": "Memory requests not specified",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 96,
      "end_line": 120,
      "message": "Container 'postgres' of Deployment 'postgres' should set 'resources.requests.memory'",
      "description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
      "remediation": "Set 'containers[].resources.requests.memory'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-resources-limits-memory/",
        "https://avd.aquasec.com/misconfig/ksv016"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV016",
        "AVDID": "AVD-KSV-0016",
        "Title": "Memory requests not specified",
        "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
        "Message": "Container 'postgres' of Deployment 'postgres' should set 'resources.requests.memory'",
        "Namespace": "builtin.kubernetes.KSV016",
        "Query": "data.builtin.kubernetes.KSV016.deny",
        "Resolution": "Set 'containers[].resources.requests.memory'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
        "References": [
          "https://kubesec.io/basics/containers-resources-limits-memory/",
          "https://avd.aquasec.com/misconfig/ksv016"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 96,
          "EndLine": 120,
          "Code": {
            "Lines": [
              {
                "Number": 96,
                "Content": "      - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 97,
                "Content": "        image: postgres:14",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: postgres:14",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 98,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 99,
                "Content": "        - containerPort: 5432",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 100,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 101,
                "Content": "        - name: POSTGRES_DB",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POSTGRES_DB",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 102,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 103,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 104,
                "Content": "              name: database-secrets",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33mname\u001b[0m: database-secrets",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 105,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_69",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV016",
      "check_type": "Kubernetes Security Check",
      "title": "Memory requests not specified",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 188,
      "end_line": 195,
      "message": "Container 'redis' of Deployment 'redis' should set 'resources.requests.memory'",
      "description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
      "remediation": "Set 'containers[].resources.requests.memory'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-resources-limits-memory/",
        "https://avd.aquasec.com/misconfig/ksv016"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV016",
        "AVDID": "AVD-KSV-0016",
        "Title": "Memory requests not specified",
        "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
        "Message": "Container 'redis' of Deployment 'redis' should set 'resources.requests.memory'",
        "Namespace": "builtin.kubernetes.KSV016",
        "Query": "data.builtin.kubernetes.KSV016.deny",
        "Resolution": "Set 'containers[].resources.requests.memory'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
        "References": [
          "https://kubesec.io/basics/containers-resources-limits-memory/",
          "https://avd.aquasec.com/misconfig/ksv016"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 188,
          "EndLine": 195,
          "Code": {
            "Lines": [
              {
                "Number": 188,
                "Content": "      - name: redis",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 189,
                "Content": "        image: redis:7-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:7-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 190,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 191,
                "Content": "        - containerPort: 6379",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 192,
                "Content": "        command:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 193,
                "Content": "        - redis-server",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis-server",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 194,
                "Content": "        - --requirepass",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --requirepass",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 195,
                "Content": "        - redis_insecure_pwd  # \u274c Hardcoded password",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis_insecure_pwd  \u001b[38;5;239m# \u274c Hardcoded password",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_70",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV017",
      "check_type": "Kubernetes Security Check",
      "title": "Privileged",
      "severity": "HIGH",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 241,
      "end_line": 316,
      "message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.privileged' to false",
      "description": "Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.",
      "remediation": "Change 'containers[].securityContext.privileged' to 'false'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv017"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV017",
        "AVDID": "AVD-KSV-0017",
        "Title": "Privileged",
        "Description": "Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.",
        "Message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.privileged' to false",
        "Namespace": "builtin.kubernetes.KSV017",
        "Query": "data.builtin.kubernetes.KSV017.deny",
        "Resolution": "Change 'containers[].securityContext.privileged' to 'false'.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv017",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv017"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 241,
          "EndLine": 316,
          "Code": {
            "Lines": [
              {
                "Number": 241,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 242,
                "Content": "        image: securebank-backend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-backend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 243,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 244,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 245,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 246,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 247,
                "Content": "        - name: DATABASE_HOST",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATABASE_HOST",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 248,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 249,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 250,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_71",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV018",
      "check_type": "Kubernetes Security Check",
      "title": "Memory not limited",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 241,
      "end_line": 316,
      "message": "Container 'backend' of Deployment 'securebank-backend' should set 'resources.limits.memory'",
      "description": "Enforcing memory limits prevents DoS via resource exhaustion.",
      "remediation": "Set a limit value under 'containers[].resources.limits.memory'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-resources-limits-memory/",
        "https://avd.aquasec.com/misconfig/ksv018"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV018",
        "AVDID": "AVD-KSV-0018",
        "Title": "Memory not limited",
        "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
        "Message": "Container 'backend' of Deployment 'securebank-backend' should set 'resources.limits.memory'",
        "Namespace": "builtin.kubernetes.KSV018",
        "Query": "data.builtin.kubernetes.KSV018.deny",
        "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
        "References": [
          "https://kubesec.io/basics/containers-resources-limits-memory/",
          "https://avd.aquasec.com/misconfig/ksv018"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 241,
          "EndLine": 316,
          "Code": {
            "Lines": [
              {
                "Number": 241,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 242,
                "Content": "        image: securebank-backend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-backend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 243,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 244,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 245,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 246,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 247,
                "Content": "        - name: DATABASE_HOST",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATABASE_HOST",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 248,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 249,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 250,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_72",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV018",
      "check_type": "Kubernetes Security Check",
      "title": "Memory not limited",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 366,
      "end_line": 376,
      "message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'resources.limits.memory'",
      "description": "Enforcing memory limits prevents DoS via resource exhaustion.",
      "remediation": "Set a limit value under 'containers[].resources.limits.memory'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-resources-limits-memory/",
        "https://avd.aquasec.com/misconfig/ksv018"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV018",
        "AVDID": "AVD-KSV-0018",
        "Title": "Memory not limited",
        "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
        "Message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'resources.limits.memory'",
        "Namespace": "builtin.kubernetes.KSV018",
        "Query": "data.builtin.kubernetes.KSV018.deny",
        "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
        "References": [
          "https://kubesec.io/basics/containers-resources-limits-memory/",
          "https://avd.aquasec.com/misconfig/ksv018"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 366,
          "EndLine": 376,
          "Code": {
            "Lines": [
              {
                "Number": 366,
                "Content": "      - name: frontend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 367,
                "Content": "        image: securebank-frontend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-frontend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 368,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 369,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 370,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 371,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 372,
                "Content": "        - name: REACT_APP_API_URL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REACT_APP_API_URL",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 373,
                "Content": "          value: \"http://securebank-backend-service\"  # \u274c HTTP not HTTPS",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://securebank-backend-service\"\u001b[0m  \u001b[38;5;239m# \u274c HTTP not HTTPS",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 374,
                "Content": "        # \u274c No resource limits",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;239m# \u274c No resource limits",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 375,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_73",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV018",
      "check_type": "Kubernetes Security Check",
      "title": "Memory not limited",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 96,
      "end_line": 120,
      "message": "Container 'postgres' of Deployment 'postgres' should set 'resources.limits.memory'",
      "description": "Enforcing memory limits prevents DoS via resource exhaustion.",
      "remediation": "Set a limit value under 'containers[].resources.limits.memory'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-resources-limits-memory/",
        "https://avd.aquasec.com/misconfig/ksv018"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV018",
        "AVDID": "AVD-KSV-0018",
        "Title": "Memory not limited",
        "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
        "Message": "Container 'postgres' of Deployment 'postgres' should set 'resources.limits.memory'",
        "Namespace": "builtin.kubernetes.KSV018",
        "Query": "data.builtin.kubernetes.KSV018.deny",
        "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
        "References": [
          "https://kubesec.io/basics/containers-resources-limits-memory/",
          "https://avd.aquasec.com/misconfig/ksv018"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 96,
          "EndLine": 120,
          "Code": {
            "Lines": [
              {
                "Number": 96,
                "Content": "      - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 97,
                "Content": "        image: postgres:14",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: postgres:14",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 98,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 99,
                "Content": "        - containerPort: 5432",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 100,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 101,
                "Content": "        - name: POSTGRES_DB",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POSTGRES_DB",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 102,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 103,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 104,
                "Content": "              name: database-secrets",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33mname\u001b[0m: database-secrets",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 105,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_74",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV018",
      "check_type": "Kubernetes Security Check",
      "title": "Memory not limited",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 188,
      "end_line": 195,
      "message": "Container 'redis' of Deployment 'redis' should set 'resources.limits.memory'",
      "description": "Enforcing memory limits prevents DoS via resource exhaustion.",
      "remediation": "Set a limit value under 'containers[].resources.limits.memory'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-resources-limits-memory/",
        "https://avd.aquasec.com/misconfig/ksv018"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV018",
        "AVDID": "AVD-KSV-0018",
        "Title": "Memory not limited",
        "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
        "Message": "Container 'redis' of Deployment 'redis' should set 'resources.limits.memory'",
        "Namespace": "builtin.kubernetes.KSV018",
        "Query": "data.builtin.kubernetes.KSV018.deny",
        "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
        "References": [
          "https://kubesec.io/basics/containers-resources-limits-memory/",
          "https://avd.aquasec.com/misconfig/ksv018"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 188,
          "EndLine": 195,
          "Code": {
            "Lines": [
              {
                "Number": 188,
                "Content": "      - name: redis",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 189,
                "Content": "        image: redis:7-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:7-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 190,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 191,
                "Content": "        - containerPort: 6379",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 192,
                "Content": "        command:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 193,
                "Content": "        - redis-server",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis-server",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 194,
                "Content": "        - --requirepass",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --requirepass",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 195,
                "Content": "        - redis_insecure_pwd  # \u274c Hardcoded password",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis_insecure_pwd  \u001b[38;5;239m# \u274c Hardcoded password",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_75",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV020",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with UID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 241,
      "end_line": 316,
      "message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.runAsUser' > 10000",
      "description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv020"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV020",
        "AVDID": "AVD-KSV-0020",
        "Title": "Runs with UID <= 10000",
        "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.runAsUser' > 10000",
        "Namespace": "builtin.kubernetes.KSV020",
        "Query": "data.builtin.kubernetes.KSV020.deny",
        "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv020"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 241,
          "EndLine": 316,
          "Code": {
            "Lines": [
              {
                "Number": 241,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 242,
                "Content": "        image: securebank-backend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-backend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 243,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 244,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 245,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 246,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 247,
                "Content": "        - name: DATABASE_HOST",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATABASE_HOST",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 248,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 249,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 250,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_76",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV020",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with UID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 366,
      "end_line": 376,
      "message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'securityContext.runAsUser' > 10000",
      "description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv020"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV020",
        "AVDID": "AVD-KSV-0020",
        "Title": "Runs with UID <= 10000",
        "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'securityContext.runAsUser' > 10000",
        "Namespace": "builtin.kubernetes.KSV020",
        "Query": "data.builtin.kubernetes.KSV020.deny",
        "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv020"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 366,
          "EndLine": 376,
          "Code": {
            "Lines": [
              {
                "Number": 366,
                "Content": "      - name: frontend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 367,
                "Content": "        image: securebank-frontend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-frontend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 368,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 369,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 370,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 371,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 372,
                "Content": "        - name: REACT_APP_API_URL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REACT_APP_API_URL",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 373,
                "Content": "          value: \"http://securebank-backend-service\"  # \u274c HTTP not HTTPS",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://securebank-backend-service\"\u001b[0m  \u001b[38;5;239m# \u274c HTTP not HTTPS",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 374,
                "Content": "        # \u274c No resource limits",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;239m# \u274c No resource limits",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 375,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_77",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV020",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with UID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 96,
      "end_line": 120,
      "message": "Container 'postgres' of Deployment 'postgres' should set 'securityContext.runAsUser' > 10000",
      "description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv020"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV020",
        "AVDID": "AVD-KSV-0020",
        "Title": "Runs with UID <= 10000",
        "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'postgres' of Deployment 'postgres' should set 'securityContext.runAsUser' > 10000",
        "Namespace": "builtin.kubernetes.KSV020",
        "Query": "data.builtin.kubernetes.KSV020.deny",
        "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv020"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 96,
          "EndLine": 120,
          "Code": {
            "Lines": [
              {
                "Number": 96,
                "Content": "      - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 97,
                "Content": "        image: postgres:14",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: postgres:14",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 98,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 99,
                "Content": "        - containerPort: 5432",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 100,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 101,
                "Content": "        - name: POSTGRES_DB",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POSTGRES_DB",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 102,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 103,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 104,
                "Content": "              name: database-secrets",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33mname\u001b[0m: database-secrets",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 105,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_78",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV020",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with UID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 188,
      "end_line": 195,
      "message": "Container 'redis' of Deployment 'redis' should set 'securityContext.runAsUser' > 10000",
      "description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv020"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV020",
        "AVDID": "AVD-KSV-0020",
        "Title": "Runs with UID <= 10000",
        "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'redis' of Deployment 'redis' should set 'securityContext.runAsUser' > 10000",
        "Namespace": "builtin.kubernetes.KSV020",
        "Query": "data.builtin.kubernetes.KSV020.deny",
        "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv020"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 188,
          "EndLine": 195,
          "Code": {
            "Lines": [
              {
                "Number": 188,
                "Content": "      - name: redis",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 189,
                "Content": "        image: redis:7-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:7-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 190,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 191,
                "Content": "        - containerPort: 6379",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 192,
                "Content": "        command:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 193,
                "Content": "        - redis-server",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis-server",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 194,
                "Content": "        - --requirepass",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --requirepass",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 195,
                "Content": "        - redis_insecure_pwd  # \u274c Hardcoded password",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis_insecure_pwd  \u001b[38;5;239m# \u274c Hardcoded password",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_79",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV021",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with GID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 241,
      "end_line": 316,
      "message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.runAsGroup' > 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 241,
          "EndLine": 316,
          "Code": {
            "Lines": [
              {
                "Number": 241,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 242,
                "Content": "        image: securebank-backend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-backend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 243,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 244,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 245,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 246,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 247,
                "Content": "        - name: DATABASE_HOST",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATABASE_HOST",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 248,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 249,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 250,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_80",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV021",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with GID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 366,
      "end_line": 376,
      "message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'securityContext.runAsGroup' > 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 366,
          "EndLine": 376,
          "Code": {
            "Lines": [
              {
                "Number": 366,
                "Content": "      - name: frontend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 367,
                "Content": "        image: securebank-frontend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-frontend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 368,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 369,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 370,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 371,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 372,
                "Content": "        - name: REACT_APP_API_URL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REACT_APP_API_URL",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 373,
                "Content": "          value: \"http://securebank-backend-service\"  # \u274c HTTP not HTTPS",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://securebank-backend-service\"\u001b[0m  \u001b[38;5;239m# \u274c HTTP not HTTPS",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 374,
                "Content": "        # \u274c No resource limits",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;239m# \u274c No resource limits",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 375,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_81",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV021",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with GID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 96,
      "end_line": 120,
      "message": "Container 'postgres' of Deployment 'postgres' should set 'securityContext.runAsGroup' > 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'postgres' of Deployment 'postgres' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 96,
          "EndLine": 120,
          "Code": {
            "Lines": [
              {
                "Number": 96,
                "Content": "      - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 97,
                "Content": "        image: postgres:14",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: postgres:14",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 98,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 99,
                "Content": "        - containerPort: 5432",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 100,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 101,
                "Content": "        - name: POSTGRES_DB",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POSTGRES_DB",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 102,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 103,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 104,
                "Content": "              name: database-secrets",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33mname\u001b[0m: database-secrets",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 105,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_82",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV021",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with GID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 188,
      "end_line": 195,
      "message": "Container 'redis' of Deployment 'redis' should set 'securityContext.runAsGroup' > 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'redis' of Deployment 'redis' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 188,
          "EndLine": 195,
          "Code": {
            "Lines": [
              {
                "Number": 188,
                "Content": "      - name: redis",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 189,
                "Content": "        image: redis:7-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:7-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 190,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 191,
                "Content": "        - containerPort: 6379",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 192,
                "Content": "        command:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 193,
                "Content": "        - redis-server",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis-server",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 194,
                "Content": "        - --requirepass",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --requirepass",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 195,
                "Content": "        - redis_insecure_pwd  # \u274c Hardcoded password",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis_insecure_pwd  \u001b[38;5;239m# \u274c Hardcoded password",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_83",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV022",
      "check_type": "Kubernetes Security Check",
      "title": "Specific capabilities added",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 241,
      "end_line": 316,
      "message": "Container 'backend' of Deployment 'securebank-backend' should not set 'securityContext.capabilities.add'",
      "description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.",
      "remediation": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv022"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV022",
        "AVDID": "AVD-KSV-0022",
        "Title": "Specific capabilities added",
        "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.",
        "Message": "Container 'backend' of Deployment 'securebank-backend' should not set 'securityContext.capabilities.add'",
        "Namespace": "builtin.kubernetes.KSV022",
        "Query": "data.builtin.kubernetes.KSV022.deny",
        "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv022"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 241,
          "EndLine": 316,
          "Code": {
            "Lines": [
              {
                "Number": 241,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 242,
                "Content": "        image: securebank-backend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-backend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 243,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 244,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 245,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 246,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 247,
                "Content": "        - name: DATABASE_HOST",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATABASE_HOST",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 248,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 249,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 250,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_84",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV023",
      "check_type": "Kubernetes Security Check",
      "title": "hostPath volumes mounted",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 83,
      "end_line": 131,
      "message": "Deployment 'postgres' should not set 'spec.template.volumes.hostPath'",
      "description": "According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.",
      "remediation": "Do not set 'spec.volumes[*].hostPath'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv023"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV023",
        "AVDID": "AVD-KSV-0023",
        "Title": "hostPath volumes mounted",
        "Description": "According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.",
        "Message": "Deployment 'postgres' should not set 'spec.template.volumes.hostPath'",
        "Namespace": "builtin.kubernetes.KSV023",
        "Query": "data.builtin.kubernetes.KSV023.deny",
        "Resolution": "Do not set 'spec.volumes[*].hostPath'.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv023",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv023"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 83,
          "EndLine": 131,
          "Code": {
            "Lines": [
              {
                "Number": 83,
                "Content": "  replicas: 1",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;33mreplicas\u001b[0m: \u001b[38;5;37m1",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 84,
                "Content": "  selector:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;33mselector\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 85,
                "Content": "    matchLabels:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;33mmatchLabels\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 86,
                "Content": "      app: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      \u001b[38;5;33mapp\u001b[0m: postgres",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 87,
                "Content": "  template:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;33mtemplate\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 88,
                "Content": "    metadata:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;33mmetadata\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 89,
                "Content": "      labels:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      \u001b[38;5;33mlabels\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 90,
                "Content": "        app: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mapp\u001b[0m: postgres",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 91,
                "Content": "        component: database",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mcomponent\u001b[0m: database",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 92,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_85",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV023",
      "check_type": "Kubernetes Security Check",
      "title": "hostPath volumes mounted",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 228,
      "end_line": 321,
      "message": "Deployment 'securebank-backend' should not set 'spec.template.volumes.hostPath'",
      "description": "According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.",
      "remediation": "Do not set 'spec.volumes[*].hostPath'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv023"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV023",
        "AVDID": "AVD-KSV-0023",
        "Title": "hostPath volumes mounted",
        "Description": "According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.",
        "Message": "Deployment 'securebank-backend' should not set 'spec.template.volumes.hostPath'",
        "Namespace": "builtin.kubernetes.KSV023",
        "Query": "data.builtin.kubernetes.KSV023.deny",
        "Resolution": "Do not set 'spec.volumes[*].hostPath'.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv023",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv023"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 228,
          "EndLine": 321,
          "Code": {
            "Lines": [
              {
                "Number": 228,
                "Content": "  replicas: 2",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;33mreplicas\u001b[0m: \u001b[38;5;37m2",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 229,
                "Content": "  selector:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;33mselector\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 230,
                "Content": "    matchLabels:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;33mmatchLabels\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 231,
                "Content": "      app: securebank-backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      \u001b[38;5;33mapp\u001b[0m: securebank-backend",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 232,
                "Content": "  template:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;33mtemplate\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 233,
                "Content": "    metadata:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;33mmetadata\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 234,
                "Content": "      labels:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      \u001b[38;5;33mlabels\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 235,
                "Content": "        app: securebank-backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mapp\u001b[0m: securebank-backend",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 236,
                "Content": "        component: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mcomponent\u001b[0m: backend",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 237,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_86",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV030",
      "check_type": "Kubernetes Security Check",
      "title": "Runtime/Default Seccomp profile not set",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 241,
      "end_line": 316,
      "message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
      "description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
      "remediation": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv030"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV030",
        "AVDID": "AVD-KSV-0030",
        "Title": "Runtime/Default Seccomp profile not set",
        "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
        "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
        "Namespace": "builtin.kubernetes.KSV030",
        "Query": "data.builtin.kubernetes.KSV030.deny",
        "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv030"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 241,
          "EndLine": 316,
          "Code": {
            "Lines": [
              {
                "Number": 241,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 242,
                "Content": "        image: securebank-backend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-backend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 243,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 244,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 245,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 246,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 247,
                "Content": "        - name: DATABASE_HOST",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATABASE_HOST",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 248,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 249,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 250,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_87",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV030",
      "check_type": "Kubernetes Security Check",
      "title": "Runtime/Default Seccomp profile not set",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 188,
      "end_line": 195,
      "message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
      "description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
      "remediation": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv030"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV030",
        "AVDID": "AVD-KSV-0030",
        "Title": "Runtime/Default Seccomp profile not set",
        "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
        "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
        "Namespace": "builtin.kubernetes.KSV030",
        "Query": "data.builtin.kubernetes.KSV030.deny",
        "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv030"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 188,
          "EndLine": 195,
          "Code": {
            "Lines": [
              {
                "Number": 188,
                "Content": "      - name: redis",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 189,
                "Content": "        image: redis:7-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:7-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 190,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 191,
                "Content": "        - containerPort: 6379",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 192,
                "Content": "        command:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 193,
                "Content": "        - redis-server",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis-server",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 194,
                "Content": "        - --requirepass",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --requirepass",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 195,
                "Content": "        - redis_insecure_pwd  # \u274c Hardcoded password",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis_insecure_pwd  \u001b[38;5;239m# \u274c Hardcoded password",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_88",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV030",
      "check_type": "Kubernetes Security Check",
      "title": "Runtime/Default Seccomp profile not set",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 96,
      "end_line": 120,
      "message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
      "description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
      "remediation": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv030"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV030",
        "AVDID": "AVD-KSV-0030",
        "Title": "Runtime/Default Seccomp profile not set",
        "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
        "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
        "Namespace": "builtin.kubernetes.KSV030",
        "Query": "data.builtin.kubernetes.KSV030.deny",
        "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv030"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 96,
          "EndLine": 120,
          "Code": {
            "Lines": [
              {
                "Number": 96,
                "Content": "      - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 97,
                "Content": "        image: postgres:14",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: postgres:14",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 98,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 99,
                "Content": "        - containerPort: 5432",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 100,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 101,
                "Content": "        - name: POSTGRES_DB",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POSTGRES_DB",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 102,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 103,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 104,
                "Content": "              name: database-secrets",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33mname\u001b[0m: database-secrets",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 105,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_89",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV030",
      "check_type": "Kubernetes Security Check",
      "title": "Runtime/Default Seccomp profile not set",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 366,
      "end_line": 376,
      "message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
      "description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
      "remediation": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv030"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV030",
        "AVDID": "AVD-KSV-0030",
        "Title": "Runtime/Default Seccomp profile not set",
        "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
        "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
        "Namespace": "builtin.kubernetes.KSV030",
        "Query": "data.builtin.kubernetes.KSV030.deny",
        "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv030"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 366,
          "EndLine": 376,
          "Code": {
            "Lines": [
              {
                "Number": 366,
                "Content": "      - name: frontend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 367,
                "Content": "        image: securebank-frontend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-frontend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 368,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 369,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 370,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 371,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 372,
                "Content": "        - name: REACT_APP_API_URL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REACT_APP_API_URL",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 373,
                "Content": "          value: \"http://securebank-backend-service\"  # \u274c HTTP not HTTPS",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://securebank-backend-service\"\u001b[0m  \u001b[38;5;239m# \u274c HTTP not HTTPS",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 374,
                "Content": "        # \u274c No resource limits",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;239m# \u274c No resource limits",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 375,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_90",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-KSV-01010",
      "check_type": "Kubernetes Security Check",
      "title": "ConfigMap with sensitive content",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 51,
      "end_line": 51,
      "message": "ConfigMap 'app-config' in 'securebank' namespace stores sensitive contents in key(s) or value(s) '{\"API_KEY\", \"AWS_ACCESS_KEY_ID\", \"AWS_SECRET_ACCESS_KEY\", \"PORT\"}'",
      "description": "Storing sensitive content such as usernames and email addresses in configMaps is unsafe",
      "remediation": "Remove sensitive content from configMap data value",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://avd.aquasec.com/misconfig/avd-ksv-01010"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "AVD-KSV-01010",
        "AVDID": "AVD-KSV-01010",
        "Title": "ConfigMap with sensitive content",
        "Description": "Storing sensitive content such as usernames and email addresses in configMaps is unsafe",
        "Message": "ConfigMap 'app-config' in 'securebank' namespace stores sensitive contents in key(s) or value(s) '{\"API_KEY\", \"AWS_ACCESS_KEY_ID\", \"AWS_SECRET_ACCESS_KEY\", \"PORT\"}'",
        "Namespace": "builtin.kubernetes.KSV01010",
        "Query": "data.builtin.kubernetes.KSV01010.deny",
        "Resolution": "Remove sensitive content from configMap data value",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-ksv-01010",
        "References": [
          "https://avd.aquasec.com/misconfig/avd-ksv-01010"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 51,
          "EndLine": 51,
          "Code": {
            "Lines": [
              {
                "Number": 51,
                "Content": "---",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "---",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_91",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-KSV-01010",
      "check_type": "Kubernetes Security Check",
      "title": "ConfigMap with sensitive content",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 31,
      "end_line": 31,
      "message": "ConfigMap 'database-secrets' in 'securebank' namespace stores sensitive contents in key(s) or value(s) '{\"DB_PORT\", \"REDIS_PORT\"}'",
      "description": "Storing sensitive content such as usernames and email addresses in configMaps is unsafe",
      "remediation": "Remove sensitive content from configMap data value",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://avd.aquasec.com/misconfig/avd-ksv-01010"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "AVD-KSV-01010",
        "AVDID": "AVD-KSV-01010",
        "Title": "ConfigMap with sensitive content",
        "Description": "Storing sensitive content such as usernames and email addresses in configMaps is unsafe",
        "Message": "ConfigMap 'database-secrets' in 'securebank' namespace stores sensitive contents in key(s) or value(s) '{\"DB_PORT\", \"REDIS_PORT\"}'",
        "Namespace": "builtin.kubernetes.KSV01010",
        "Query": "data.builtin.kubernetes.KSV01010.deny",
        "Resolution": "Remove sensitive content from configMap data value",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-ksv-01010",
        "References": [
          "https://avd.aquasec.com/misconfig/avd-ksv-01010"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 31,
          "EndLine": 31,
          "Code": {
            "Lines": [
              {
                "Number": 31,
                "Content": "---",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "---",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_92",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV104",
      "check_type": "Kubernetes Security Check",
      "title": "Seccomp policies disabled",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 215,
      "end_line": 215,
      "message": "container \"backend\" of deployment \"securebank-backend\" in \"securebank\" namespace should specify a seccomp profile",
      "description": "A program inside the container can bypass Seccomp protection policies.",
      "remediation": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv104"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV104",
        "AVDID": "AVD-KSV-0104",
        "Title": "Seccomp policies disabled",
        "Description": "A program inside the container can bypass Seccomp protection policies.",
        "Message": "container \"backend\" of deployment \"securebank-backend\" in \"securebank\" namespace should specify a seccomp profile",
        "Namespace": "builtin.kubernetes.KSV104",
        "Query": "data.builtin.kubernetes.KSV104.deny",
        "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 215,
          "EndLine": 215,
          "Code": {
            "Lines": [
              {
                "Number": 215,
                "Content": "---",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "---",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_93",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV104",
      "check_type": "Kubernetes Security Check",
      "title": "Seccomp policies disabled",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 341,
      "end_line": 341,
      "message": "container \"frontend\" of deployment \"securebank-frontend\" in \"securebank\" namespace should specify a seccomp profile",
      "description": "A program inside the container can bypass Seccomp protection policies.",
      "remediation": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv104"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV104",
        "AVDID": "AVD-KSV-0104",
        "Title": "Seccomp policies disabled",
        "Description": "A program inside the container can bypass Seccomp protection policies.",
        "Message": "container \"frontend\" of deployment \"securebank-frontend\" in \"securebank\" namespace should specify a seccomp profile",
        "Namespace": "builtin.kubernetes.KSV104",
        "Query": "data.builtin.kubernetes.KSV104.deny",
        "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 341,
          "EndLine": 341,
          "Code": {
            "Lines": [
              {
                "Number": 341,
                "Content": "---",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "---",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_94",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV104",
      "check_type": "Kubernetes Security Check",
      "title": "Seccomp policies disabled",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 70,
      "end_line": 70,
      "message": "container \"postgres\" of deployment \"postgres\" in \"securebank\" namespace should specify a seccomp profile",
      "description": "A program inside the container can bypass Seccomp protection policies.",
      "remediation": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv104"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV104",
        "AVDID": "AVD-KSV-0104",
        "Title": "Seccomp policies disabled",
        "Description": "A program inside the container can bypass Seccomp protection policies.",
        "Message": "container \"postgres\" of deployment \"postgres\" in \"securebank\" namespace should specify a seccomp profile",
        "Namespace": "builtin.kubernetes.KSV104",
        "Query": "data.builtin.kubernetes.KSV104.deny",
        "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 70,
          "EndLine": 70,
          "Code": {
            "Lines": [
              {
                "Number": 70,
                "Content": "---",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "---",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_95",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV104",
      "check_type": "Kubernetes Security Check",
      "title": "Seccomp policies disabled",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 163,
      "end_line": 163,
      "message": "container \"redis\" of deployment \"redis\" in \"securebank\" namespace should specify a seccomp profile",
      "description": "A program inside the container can bypass Seccomp protection policies.",
      "remediation": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv104"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV104",
        "AVDID": "AVD-KSV-0104",
        "Title": "Seccomp policies disabled",
        "Description": "A program inside the container can bypass Seccomp protection policies.",
        "Message": "container \"redis\" of deployment \"redis\" in \"securebank\" namespace should specify a seccomp profile",
        "Namespace": "builtin.kubernetes.KSV104",
        "Query": "data.builtin.kubernetes.KSV104.deny",
        "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 163,
          "EndLine": 163,
          "Code": {
            "Lines": [
              {
                "Number": 163,
                "Content": "---",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "---",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_96",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV105",
      "check_type": "Kubernetes Security Check",
      "title": "Containers must not set runAsUser to 0",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 376,
      "end_line": 376,
      "message": "securityContext.runAsUser should be set to a value greater than 0",
      "description": "Containers should be forbidden from running with a root UID.",
      "remediation": "Set 'securityContext.runAsUser' to a non-zero integer or leave undefined.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv105"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV105",
        "AVDID": "AVD-KSV-0105",
        "Title": "Containers must not set runAsUser to 0",
        "Description": "Containers should be forbidden from running with a root UID.",
        "Message": "securityContext.runAsUser should be set to a value greater than 0",
        "Namespace": "builtin.kubernetes.KSV105",
        "Query": "data.builtin.kubernetes.KSV105.deny",
        "Resolution": "Set 'securityContext.runAsUser' to a non-zero integer or leave undefined.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv105",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv105"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 376,
          "EndLine": 376,
          "Code": {
            "Lines": [
              {
                "Number": 376,
                "Content": "          runAsUser: 0  # \u274c Running as root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# \u274c Running as root",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_97",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV105",
      "check_type": "Kubernetes Security Check",
      "title": "Containers must not set runAsUser to 0",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 304,
      "end_line": 311,
      "message": "securityContext.runAsUser should be set to a value greater than 0",
      "description": "Containers should be forbidden from running with a root UID.",
      "remediation": "Set 'securityContext.runAsUser' to a non-zero integer or leave undefined.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv105"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV105",
        "AVDID": "AVD-KSV-0105",
        "Title": "Containers must not set runAsUser to 0",
        "Description": "Containers should be forbidden from running with a root UID.",
        "Message": "securityContext.runAsUser should be set to a value greater than 0",
        "Namespace": "builtin.kubernetes.KSV105",
        "Query": "data.builtin.kubernetes.KSV105.deny",
        "Resolution": "Set 'securityContext.runAsUser' to a non-zero integer or leave undefined.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv105",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv105"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 304,
          "EndLine": 311,
          "Code": {
            "Lines": [
              {
                "Number": 304,
                "Content": "          privileged: true  # \u274c Privileged container",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# \u274c Privileged container",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 305,
                "Content": "          runAsUser: 0      # \u274c Running as root",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m      \u001b[38;5;239m# \u274c Running as root",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 306,
                "Content": "          allowPrivilegeEscalation: true  # \u274c Allows privilege escalation",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# \u274c Allows privilege escalation",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 307,
                "Content": "          capabilities:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mcapabilities\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 308,
                "Content": "            add:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33madd\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 309,
                "Content": "            - NET_ADMIN      # \u274c Excessive capabilities",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            - NET_ADMIN      \u001b[38;5;239m# \u274c Excessive capabilities",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 310,
                "Content": "            - SYS_ADMIN      # \u274c Full system admin",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            - SYS_ADMIN      \u001b[38;5;239m# \u274c Full system admin",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 311,
                "Content": "            - SYS_PTRACE     # \u274c Can trace processes",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m            - SYS_PTRACE     \u001b[38;5;239m# \u274c Can trace processes",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_98",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV106",
      "check_type": "Kubernetes Security Check",
      "title": "Container capabilities must only include NET_BIND_SERVICE",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 366,
      "end_line": 376,
      "message": "container should drop all",
      "description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
      "remediation": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv106"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV106",
        "AVDID": "AVD-KSV-0106",
        "Title": "Container capabilities must only include NET_BIND_SERVICE",
        "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
        "Message": "container should drop all",
        "Namespace": "builtin.kubernetes.KSV106",
        "Query": "data.builtin.kubernetes.KSV106.deny",
        "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv106"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 366,
          "EndLine": 376,
          "Code": {
            "Lines": [
              {
                "Number": 366,
                "Content": "      - name: frontend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 367,
                "Content": "        image: securebank-frontend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-frontend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 368,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 369,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 370,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 371,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 372,
                "Content": "        - name: REACT_APP_API_URL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REACT_APP_API_URL",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 373,
                "Content": "          value: \"http://securebank-backend-service\"  # \u274c HTTP not HTTPS",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"http://securebank-backend-service\"\u001b[0m  \u001b[38;5;239m# \u274c HTTP not HTTPS",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 374,
                "Content": "        # \u274c No resource limits",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;239m# \u274c No resource limits",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 375,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_99",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV106",
      "check_type": "Kubernetes Security Check",
      "title": "Container capabilities must only include NET_BIND_SERVICE",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 241,
      "end_line": 316,
      "message": "container should drop all",
      "description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
      "remediation": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv106"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV106",
        "AVDID": "AVD-KSV-0106",
        "Title": "Container capabilities must only include NET_BIND_SERVICE",
        "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
        "Message": "container should drop all",
        "Namespace": "builtin.kubernetes.KSV106",
        "Query": "data.builtin.kubernetes.KSV106.deny",
        "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv106"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 241,
          "EndLine": 316,
          "Code": {
            "Lines": [
              {
                "Number": 241,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 242,
                "Content": "        image: securebank-backend:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank-backend:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 243,
                "Content": "        imagePullPolicy: IfNotPresent",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimagePullPolicy\u001b[0m: IfNotPresent",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 244,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 245,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 246,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 247,
                "Content": "        - name: DATABASE_HOST",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: DATABASE_HOST",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 248,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 249,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 250,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_100",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV106",
      "check_type": "Kubernetes Security Check",
      "title": "Container capabilities must only include NET_BIND_SERVICE",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 188,
      "end_line": 195,
      "message": "container should drop all",
      "description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
      "remediation": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv106"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV106",
        "AVDID": "AVD-KSV-0106",
        "Title": "Container capabilities must only include NET_BIND_SERVICE",
        "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
        "Message": "container should drop all",
        "Namespace": "builtin.kubernetes.KSV106",
        "Query": "data.builtin.kubernetes.KSV106.deny",
        "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv106"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 188,
          "EndLine": 195,
          "Code": {
            "Lines": [
              {
                "Number": 188,
                "Content": "      - name: redis",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: redis",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 189,
                "Content": "        image: redis:7-alpine",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: redis:7-alpine",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 190,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 191,
                "Content": "        - containerPort: 6379",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m6379",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 192,
                "Content": "        command:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 193,
                "Content": "        - redis-server",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis-server",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 194,
                "Content": "        - --requirepass",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --requirepass",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 195,
                "Content": "        - redis_insecure_pwd  # \u274c Hardcoded password",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - redis_insecure_pwd  \u001b[38;5;239m# \u274c Hardcoded password",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_101",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV106",
      "check_type": "Kubernetes Security Check",
      "title": "Container capabilities must only include NET_BIND_SERVICE",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 96,
      "end_line": 120,
      "message": "container should drop all",
      "description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
      "remediation": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv106"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV106",
        "AVDID": "AVD-KSV-0106",
        "Title": "Container capabilities must only include NET_BIND_SERVICE",
        "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
        "Message": "container should drop all",
        "Namespace": "builtin.kubernetes.KSV106",
        "Query": "data.builtin.kubernetes.KSV106.deny",
        "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv106"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 96,
          "EndLine": 120,
          "Code": {
            "Lines": [
              {
                "Number": 96,
                "Content": "      - name: postgres",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: postgres",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 97,
                "Content": "        image: postgres:14",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: postgres:14",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 98,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 99,
                "Content": "        - containerPort: 5432",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m5432",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 100,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 101,
                "Content": "        - name: POSTGRES_DB",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: POSTGRES_DB",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 102,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 103,
                "Content": "            configMapKeyRef:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "            \u001b[38;5;33mconfigMapKeyRef\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 104,
                "Content": "              name: database-secrets",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "              \u001b[38;5;33mname\u001b[0m: database-secrets",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 105,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_102",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-KSV-0109",
      "check_type": "Kubernetes Security Check",
      "title": "ConfigMap with secrets",
      "severity": "HIGH",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 51,
      "end_line": 51,
      "message": "ConfigMap 'app-config' in 'securebank' namespace stores secrets in key(s) or value(s) '{\"AWS_ACCESS_KEY_ID\", \"AWS_SECRET_ACCESS_KEY\", \"JWT_SECRET\"}'",
      "description": "Storing secrets in configMaps is unsafe",
      "remediation": "Remove password/secret from configMap data value",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://avd.aquasec.com/misconfig/avd-ksv-0109"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "AVD-KSV-0109",
        "AVDID": "AVD-KSV-0109",
        "Title": "ConfigMap with secrets",
        "Description": "Storing secrets in configMaps is unsafe",
        "Message": "ConfigMap 'app-config' in 'securebank' namespace stores secrets in key(s) or value(s) '{\"AWS_ACCESS_KEY_ID\", \"AWS_SECRET_ACCESS_KEY\", \"JWT_SECRET\"}'",
        "Namespace": "builtin.kubernetes.KSV0109",
        "Query": "data.builtin.kubernetes.KSV0109.deny",
        "Resolution": "Remove password/secret from configMap data value",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-ksv-0109",
        "References": [
          "https://avd.aquasec.com/misconfig/avd-ksv-0109"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 51,
          "EndLine": 51,
          "Code": {
            "Lines": [
              {
                "Number": 51,
                "Content": "---",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "---",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_103",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-KSV-0109",
      "check_type": "Kubernetes Security Check",
      "title": "ConfigMap with secrets",
      "severity": "HIGH",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 31,
      "end_line": 31,
      "message": "ConfigMap 'database-secrets' in 'securebank' namespace stores secrets in key(s) or value(s) '{\"DB_PASSWORD\", \"REDIS_PASSWORD\"}'",
      "description": "Storing secrets in configMaps is unsafe",
      "remediation": "Remove password/secret from configMap data value",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://avd.aquasec.com/misconfig/avd-ksv-0109"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "AVD-KSV-0109",
        "AVDID": "AVD-KSV-0109",
        "Title": "ConfigMap with secrets",
        "Description": "Storing secrets in configMaps is unsafe",
        "Message": "ConfigMap 'database-secrets' in 'securebank' namespace stores secrets in key(s) or value(s) '{\"DB_PASSWORD\", \"REDIS_PASSWORD\"}'",
        "Namespace": "builtin.kubernetes.KSV0109",
        "Query": "data.builtin.kubernetes.KSV0109.deny",
        "Resolution": "Remove password/secret from configMap data value",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-ksv-0109",
        "References": [
          "https://avd.aquasec.com/misconfig/avd-ksv-0109"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 31,
          "EndLine": 31,
          "Code": {
            "Lines": [
              {
                "Number": 31,
                "Content": "---",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "---",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_104",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV121",
      "check_type": "Kubernetes Security Check",
      "title": "Kubernetes resource with disallowed volumes mounted",
      "severity": "HIGH",
      "file": "infrastructure/k8s/deployment-vulnerable.yaml",
      "line": 228,
      "end_line": 321,
      "message": "deployment securebank-backend in securebank namespace shouldn't have volumes set to {\"/\"}",
      "description": "HostPath present many security risks and as a security practice it is better to avoid critical host paths mounts.",
      "remediation": "Do not Set 'spec.volumes[*].hostPath.path' to any of the disallowed volumes.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv121"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV121",
        "AVDID": "AVD-KSV-0121",
        "Title": "Kubernetes resource with disallowed volumes mounted",
        "Description": "HostPath present many security risks and as a security practice it is better to avoid critical host paths mounts.",
        "Message": "deployment securebank-backend in securebank namespace shouldn't have volumes set to {\"/\"}",
        "Namespace": "builtin.kubernetes.KSV121",
        "Query": "data.builtin.kubernetes.KSV121.deny",
        "Resolution": "Do not Set 'spec.volumes[*].hostPath.path' to any of the disallowed volumes.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv121",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv121"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 228,
          "EndLine": 321,
          "Code": {
            "Lines": [
              {
                "Number": 228,
                "Content": "  replicas: 2",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;33mreplicas\u001b[0m: \u001b[38;5;37m2",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 229,
                "Content": "  selector:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;33mselector\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 230,
                "Content": "    matchLabels:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;33mmatchLabels\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 231,
                "Content": "      app: securebank-backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      \u001b[38;5;33mapp\u001b[0m: securebank-backend",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 232,
                "Content": "  template:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;33mtemplate\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 233,
                "Content": "    metadata:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;33mmetadata\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 234,
                "Content": "      labels:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      \u001b[38;5;33mlabels\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 235,
                "Content": "        app: securebank-backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mapp\u001b[0m: securebank-backend",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 236,
                "Content": "        component: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mcomponent\u001b[0m: backend",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 237,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_105",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV020",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with UID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment.yaml",
      "line": 43,
      "end_line": 124,
      "message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.runAsUser' > 10000",
      "description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv020"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV020",
        "AVDID": "AVD-KSV-0020",
        "Title": "Runs with UID <= 10000",
        "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.runAsUser' > 10000",
        "Namespace": "builtin.kubernetes.KSV020",
        "Query": "data.builtin.kubernetes.KSV020.deny",
        "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv020"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 43,
          "EndLine": 124,
          "Code": {
            "Lines": [
              {
                "Number": 43,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 44,
                "Content": "        image: securebank/backend:v1.0.0",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank/backend:v1.0.0",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 45,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 46,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 47,
                "Content": "          protocol: TCP",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mprotocol\u001b[0m: TCP",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 48,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 49,
                "Content": "        # \u2705 FIXED: Using Kubernetes Secrets instead of hardcoded values",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;239m# \u2705 FIXED: Using Kubernetes Secrets instead of hardcoded values",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 50,
                "Content": "        - name: DB_USERNAME",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: DB_USERNAME",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 51,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 52,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_106",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV020",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with UID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment.yaml",
      "line": 159,
      "end_line": 196,
      "message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'securityContext.runAsUser' > 10000",
      "description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv020"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV020",
        "AVDID": "AVD-KSV-0020",
        "Title": "Runs with UID <= 10000",
        "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'securityContext.runAsUser' > 10000",
        "Namespace": "builtin.kubernetes.KSV020",
        "Query": "data.builtin.kubernetes.KSV020.deny",
        "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv020"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 159,
          "EndLine": 196,
          "Code": {
            "Lines": [
              {
                "Number": 159,
                "Content": "      - name: frontend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 160,
                "Content": "        image: securebank/frontend:v1.0.0",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank/frontend:v1.0.0",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 161,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 162,
                "Content": "        - containerPort: 80",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 163,
                "Content": "          protocol: TCP",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mprotocol\u001b[0m: TCP",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 164,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 165,
                "Content": "        - name: REACT_APP_API_URL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REACT_APP_API_URL",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 166,
                "Content": "          value: http://securebank-backend-service:3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: http://securebank-backend-service:3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 167,
                "Content": "        # \u2705 FIXED: Stripe key moved to Secret",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;239m# \u2705 FIXED: Stripe key moved to Secret",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 168,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_107",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV021",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with GID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment.yaml",
      "line": 43,
      "end_line": 124,
      "message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.runAsGroup' > 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'backend' of Deployment 'securebank-backend' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 43,
          "EndLine": 124,
          "Code": {
            "Lines": [
              {
                "Number": 43,
                "Content": "      - name: backend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: backend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 44,
                "Content": "        image: securebank/backend:v1.0.0",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank/backend:v1.0.0",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 45,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 46,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 47,
                "Content": "          protocol: TCP",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mprotocol\u001b[0m: TCP",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 48,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 49,
                "Content": "        # \u2705 FIXED: Using Kubernetes Secrets instead of hardcoded values",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;239m# \u2705 FIXED: Using Kubernetes Secrets instead of hardcoded values",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 50,
                "Content": "        - name: DB_USERNAME",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;33mname\u001b[0m: DB_USERNAME",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 51,
                "Content": "          valueFrom:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalueFrom\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 52,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_108",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV021",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with GID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/deployment.yaml",
      "line": 159,
      "end_line": 196,
      "message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'securityContext.runAsGroup' > 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'frontend' of Deployment 'securebank-frontend' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 159,
          "EndLine": 196,
          "Code": {
            "Lines": [
              {
                "Number": 159,
                "Content": "      - name: frontend",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: frontend",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 160,
                "Content": "        image: securebank/frontend:v1.0.0",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: securebank/frontend:v1.0.0",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 161,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 162,
                "Content": "        - containerPort: 80",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 163,
                "Content": "          protocol: TCP",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m          \u001b[38;5;33mprotocol\u001b[0m: TCP",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 164,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 165,
                "Content": "        - name: REACT_APP_API_URL",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: REACT_APP_API_URL",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 166,
                "Content": "          value: http://securebank-backend-service:3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: http://securebank-backend-service:3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 167,
                "Content": "        # \u2705 FIXED: Stripe key moved to Secret",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;239m# \u2705 FIXED: Stripe key moved to Secret",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 168,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_109",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV117",
      "check_type": "Kubernetes Security Check",
      "title": "Prevent binding to privileged ports",
      "severity": "HIGH",
      "file": "infrastructure/k8s/deployment.yaml",
      "line": 131,
      "end_line": 131,
      "message": "deployment securebank-frontend in securebank namespace should not set spec.template.spec.containers.ports.containerPort to less than 1024",
      "description": "The ports which are lower than 1024 receive and transmit various sensitive and privileged data. Allowing containers to use them can bring serious implications.",
      "remediation": "Do not map the container ports to privileged host ports when starting a container.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/",
        "https://avd.aquasec.com/misconfig/ksv117"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV117",
        "AVDID": "AVD-KSV-0117",
        "Title": "Prevent binding to privileged ports",
        "Description": "The ports which are lower than 1024 receive and transmit various sensitive and privileged data. Allowing containers to use them can bring serious implications.",
        "Message": "deployment securebank-frontend in securebank namespace should not set spec.template.spec.containers.ports.containerPort to less than 1024",
        "Namespace": "builtin.kubernetes.KSV117",
        "Query": "data.builtin.kubernetes.KSV117.deny",
        "Resolution": "Do not map the container ports to privileged host ports when starting a container.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv117",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/",
          "https://avd.aquasec.com/misconfig/ksv117"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 131,
          "EndLine": 131,
          "Code": {
            "Lines": [
              {
                "Number": 131,
                "Content": "---",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "---",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_110",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV013",
      "check_type": "Kubernetes Security Check",
      "title": "Image tag \":latest\" used",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/monitoring.yaml",
      "line": 104,
      "end_line": 138,
      "message": "Container 'grafana' of Deployment 'grafana' should specify an image tag",
      "description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
      "remediation": "Use a specific container image tag that is not 'latest'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
        "https://avd.aquasec.com/misconfig/ksv013"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV013",
        "AVDID": "AVD-KSV-0013",
        "Title": "Image tag \":latest\" used",
        "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
        "Message": "Container 'grafana' of Deployment 'grafana' should specify an image tag",
        "Namespace": "builtin.kubernetes.KSV013",
        "Query": "data.builtin.kubernetes.KSV013.deny",
        "Resolution": "Use a specific container image tag that is not 'latest'.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
        "References": [
          "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
          "https://avd.aquasec.com/misconfig/ksv013"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 104,
          "EndLine": 138,
          "Code": {
            "Lines": [
              {
                "Number": 104,
                "Content": "      - name: grafana",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: grafana",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 105,
                "Content": "        image: grafana/grafana:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: grafana/grafana:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 106,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 107,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 108,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 109,
                "Content": "        - name: GF_SECURITY_ADMIN_USER",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: GF_SECURITY_ADMIN_USER",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 110,
                "Content": "          value: admin",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: admin",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 111,
                "Content": "        - name: GF_SECURITY_ADMIN_PASSWORD",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: GF_SECURITY_ADMIN_PASSWORD",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 112,
                "Content": "          value: admin",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: admin",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 113,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_111",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV013",
      "check_type": "Kubernetes Security Check",
      "title": "Image tag \":latest\" used",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/monitoring.yaml",
      "line": 19,
      "end_line": 46,
      "message": "Container 'prometheus' of Deployment 'prometheus' should specify an image tag",
      "description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
      "remediation": "Use a specific container image tag that is not 'latest'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
        "https://avd.aquasec.com/misconfig/ksv013"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV013",
        "AVDID": "AVD-KSV-0013",
        "Title": "Image tag \":latest\" used",
        "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
        "Message": "Container 'prometheus' of Deployment 'prometheus' should specify an image tag",
        "Namespace": "builtin.kubernetes.KSV013",
        "Query": "data.builtin.kubernetes.KSV013.deny",
        "Resolution": "Use a specific container image tag that is not 'latest'.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
        "References": [
          "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
          "https://avd.aquasec.com/misconfig/ksv013"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 19,
          "EndLine": 46,
          "Code": {
            "Lines": [
              {
                "Number": 19,
                "Content": "      - name: prometheus",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: prometheus",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "        image: prom/prometheus:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: prom/prometheus:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "        - containerPort: 9090",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9090",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "        args:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33margs\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "        - --config.file=/etc/prometheus/prometheus.yml",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --config.file=/etc/prometheus/prometheus.yml",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "        - --storage.tsdb.path=/prometheus",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --storage.tsdb.path=/prometheus",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "        - --web.enable-admin-api",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --web.enable-admin-api",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "        volumeMounts:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 28,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_112",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV020",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with UID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/monitoring.yaml",
      "line": 104,
      "end_line": 138,
      "message": "Container 'grafana' of Deployment 'grafana' should set 'securityContext.runAsUser' > 10000",
      "description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv020"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV020",
        "AVDID": "AVD-KSV-0020",
        "Title": "Runs with UID <= 10000",
        "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'grafana' of Deployment 'grafana' should set 'securityContext.runAsUser' > 10000",
        "Namespace": "builtin.kubernetes.KSV020",
        "Query": "data.builtin.kubernetes.KSV020.deny",
        "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv020"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 104,
          "EndLine": 138,
          "Code": {
            "Lines": [
              {
                "Number": 104,
                "Content": "      - name: grafana",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: grafana",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 105,
                "Content": "        image: grafana/grafana:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: grafana/grafana:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 106,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 107,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 108,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 109,
                "Content": "        - name: GF_SECURITY_ADMIN_USER",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: GF_SECURITY_ADMIN_USER",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 110,
                "Content": "          value: admin",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: admin",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 111,
                "Content": "        - name: GF_SECURITY_ADMIN_PASSWORD",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: GF_SECURITY_ADMIN_PASSWORD",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 112,
                "Content": "          value: admin",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: admin",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 113,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_113",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV020",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with UID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/monitoring.yaml",
      "line": 19,
      "end_line": 46,
      "message": "Container 'prometheus' of Deployment 'prometheus' should set 'securityContext.runAsUser' > 10000",
      "description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv020"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV020",
        "AVDID": "AVD-KSV-0020",
        "Title": "Runs with UID <= 10000",
        "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'prometheus' of Deployment 'prometheus' should set 'securityContext.runAsUser' > 10000",
        "Namespace": "builtin.kubernetes.KSV020",
        "Query": "data.builtin.kubernetes.KSV020.deny",
        "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv020"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 19,
          "EndLine": 46,
          "Code": {
            "Lines": [
              {
                "Number": 19,
                "Content": "      - name: prometheus",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: prometheus",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "        image: prom/prometheus:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: prom/prometheus:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "        - containerPort: 9090",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9090",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "        args:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33margs\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "        - --config.file=/etc/prometheus/prometheus.yml",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --config.file=/etc/prometheus/prometheus.yml",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "        - --storage.tsdb.path=/prometheus",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --storage.tsdb.path=/prometheus",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "        - --web.enable-admin-api",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --web.enable-admin-api",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "        volumeMounts:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 28,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_114",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV021",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with GID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/monitoring.yaml",
      "line": 104,
      "end_line": 138,
      "message": "Container 'grafana' of Deployment 'grafana' should set 'securityContext.runAsGroup' > 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'grafana' of Deployment 'grafana' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 104,
          "EndLine": 138,
          "Code": {
            "Lines": [
              {
                "Number": 104,
                "Content": "      - name: grafana",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: grafana",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 105,
                "Content": "        image: grafana/grafana:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: grafana/grafana:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 106,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 107,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 108,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 109,
                "Content": "        - name: GF_SECURITY_ADMIN_USER",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: GF_SECURITY_ADMIN_USER",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 110,
                "Content": "          value: admin",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: admin",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 111,
                "Content": "        - name: GF_SECURITY_ADMIN_PASSWORD",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: GF_SECURITY_ADMIN_PASSWORD",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 112,
                "Content": "          value: admin",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: admin",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 113,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_115",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV021",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with GID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/monitoring.yaml",
      "line": 19,
      "end_line": 46,
      "message": "Container 'prometheus' of Deployment 'prometheus' should set 'securityContext.runAsGroup' > 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'prometheus' of Deployment 'prometheus' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 19,
          "EndLine": 46,
          "Code": {
            "Lines": [
              {
                "Number": 19,
                "Content": "      - name: prometheus",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: prometheus",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "        image: prom/prometheus:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: prom/prometheus:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "        - containerPort: 9090",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9090",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "        args:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33margs\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "        - --config.file=/etc/prometheus/prometheus.yml",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --config.file=/etc/prometheus/prometheus.yml",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "        - --storage.tsdb.path=/prometheus",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --storage.tsdb.path=/prometheus",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "        - --web.enable-admin-api",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --web.enable-admin-api",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "        volumeMounts:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 28,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_116",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV030",
      "check_type": "Kubernetes Security Check",
      "title": "Runtime/Default Seccomp profile not set",
      "severity": "LOW",
      "file": "infrastructure/k8s/monitoring.yaml",
      "line": 104,
      "end_line": 138,
      "message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
      "description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
      "remediation": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv030"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV030",
        "AVDID": "AVD-KSV-0030",
        "Title": "Runtime/Default Seccomp profile not set",
        "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
        "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
        "Namespace": "builtin.kubernetes.KSV030",
        "Query": "data.builtin.kubernetes.KSV030.deny",
        "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv030"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 104,
          "EndLine": 138,
          "Code": {
            "Lines": [
              {
                "Number": 104,
                "Content": "      - name: grafana",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: grafana",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 105,
                "Content": "        image: grafana/grafana:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: grafana/grafana:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 106,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 107,
                "Content": "        - containerPort: 3000",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3000",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 108,
                "Content": "        env:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33menv\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 109,
                "Content": "        - name: GF_SECURITY_ADMIN_USER",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: GF_SECURITY_ADMIN_USER",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 110,
                "Content": "          value: admin",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: admin",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 111,
                "Content": "        - name: GF_SECURITY_ADMIN_PASSWORD",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: GF_SECURITY_ADMIN_PASSWORD",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 112,
                "Content": "          value: admin",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: admin",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 113,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_117",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV030",
      "check_type": "Kubernetes Security Check",
      "title": "Runtime/Default Seccomp profile not set",
      "severity": "LOW",
      "file": "infrastructure/k8s/monitoring.yaml",
      "line": 19,
      "end_line": 46,
      "message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
      "description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
      "remediation": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv030"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV030",
        "AVDID": "AVD-KSV-0030",
        "Title": "Runtime/Default Seccomp profile not set",
        "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
        "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
        "Namespace": "builtin.kubernetes.KSV030",
        "Query": "data.builtin.kubernetes.KSV030.deny",
        "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv030"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 19,
          "EndLine": 46,
          "Code": {
            "Lines": [
              {
                "Number": 19,
                "Content": "      - name: prometheus",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: prometheus",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "        image: prom/prometheus:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: prom/prometheus:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "        - containerPort: 9090",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m9090",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "        args:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33margs\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "        - --config.file=/etc/prometheus/prometheus.yml",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --config.file=/etc/prometheus/prometheus.yml",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "        - --storage.tsdb.path=/prometheus",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --storage.tsdb.path=/prometheus",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "        - --web.enable-admin-api",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - --web.enable-admin-api",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "        volumeMounts:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 28,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_118",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV104",
      "check_type": "Kubernetes Security Check",
      "title": "Seccomp policies disabled",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/monitoring.yaml",
      "line": 85,
      "end_line": 85,
      "message": "container \"grafana\" of deployment \"grafana\" in \"securebank\" namespace should specify a seccomp profile",
      "description": "A program inside the container can bypass Seccomp protection policies.",
      "remediation": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv104"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV104",
        "AVDID": "AVD-KSV-0104",
        "Title": "Seccomp policies disabled",
        "Description": "A program inside the container can bypass Seccomp protection policies.",
        "Message": "container \"grafana\" of deployment \"grafana\" in \"securebank\" namespace should specify a seccomp profile",
        "Namespace": "builtin.kubernetes.KSV104",
        "Query": "data.builtin.kubernetes.KSV104.deny",
        "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 85,
          "EndLine": 85,
          "Code": {
            "Lines": [
              {
                "Number": 85,
                "Content": "---",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m---",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_119",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV104",
      "check_type": "Kubernetes Security Check",
      "title": "Seccomp policies disabled",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/monitoring.yaml",
      "line": 0,
      "end_line": 0,
      "message": "container \"prometheus\" of deployment \"prometheus\" in \"securebank\" namespace should specify a seccomp profile",
      "description": "A program inside the container can bypass Seccomp protection policies.",
      "remediation": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv104"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV104",
        "AVDID": "AVD-KSV-0104",
        "Title": "Seccomp policies disabled",
        "Description": "A program inside the container can bypass Seccomp protection policies.",
        "Message": "container \"prometheus\" of deployment \"prometheus\" in \"securebank\" namespace should specify a seccomp profile",
        "Namespace": "builtin.kubernetes.KSV104",
        "Query": "data.builtin.kubernetes.KSV104.deny",
        "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_120",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV011",
      "check_type": "Kubernetes Security Check",
      "title": "CPU not limited",
      "severity": "LOW",
      "file": "infrastructure/k8s/opa-gatekeeper.yaml",
      "line": 57,
      "end_line": 83,
      "message": "Container 'opa' of Deployment 'opa-server' should set 'resources.limits.cpu'",
      "description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
      "remediation": "Set a limit value under 'containers[].resources.limits.cpu'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
        "https://avd.aquasec.com/misconfig/ksv011"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV011",
        "AVDID": "AVD-KSV-0011",
        "Title": "CPU not limited",
        "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
        "Message": "Container 'opa' of Deployment 'opa-server' should set 'resources.limits.cpu'",
        "Namespace": "builtin.kubernetes.KSV011",
        "Query": "data.builtin.kubernetes.KSV011.deny",
        "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
        "References": [
          "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
          "https://avd.aquasec.com/misconfig/ksv011"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 57,
          "EndLine": 83,
          "Code": {
            "Lines": [
              {
                "Number": 57,
                "Content": "      - name: opa",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: opa",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 58,
                "Content": "        image: openpolicyagent/opa:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: openpolicyagent/opa:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 59,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 60,
                "Content": "        - name: http",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: http",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 61,
                "Content": "          containerPort: 8181",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8181",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 62,
                "Content": "        args:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33margs\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 63,
                "Content": "        - \"run\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;37m\"run\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 64,
                "Content": "        - \"--server\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;37m\"--server\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 65,
                "Content": "        - \"--log-level=debug\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;37m\"--log-level=debug\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 66,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_121",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV013",
      "check_type": "Kubernetes Security Check",
      "title": "Image tag \":latest\" used",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/opa-gatekeeper.yaml",
      "line": 57,
      "end_line": 83,
      "message": "Container 'opa' of Deployment 'opa-server' should specify an image tag",
      "description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
      "remediation": "Use a specific container image tag that is not 'latest'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
        "https://avd.aquasec.com/misconfig/ksv013"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV013",
        "AVDID": "AVD-KSV-0013",
        "Title": "Image tag \":latest\" used",
        "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
        "Message": "Container 'opa' of Deployment 'opa-server' should specify an image tag",
        "Namespace": "builtin.kubernetes.KSV013",
        "Query": "data.builtin.kubernetes.KSV013.deny",
        "Resolution": "Use a specific container image tag that is not 'latest'.",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
        "References": [
          "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
          "https://avd.aquasec.com/misconfig/ksv013"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 57,
          "EndLine": 83,
          "Code": {
            "Lines": [
              {
                "Number": 57,
                "Content": "      - name: opa",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: opa",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 58,
                "Content": "        image: openpolicyagent/opa:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: openpolicyagent/opa:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 59,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 60,
                "Content": "        - name: http",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: http",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 61,
                "Content": "          containerPort: 8181",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8181",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 62,
                "Content": "        args:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33margs\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 63,
                "Content": "        - \"run\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;37m\"run\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 64,
                "Content": "        - \"--server\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;37m\"--server\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 65,
                "Content": "        - \"--log-level=debug\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;37m\"--log-level=debug\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 66,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_122",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV015",
      "check_type": "Kubernetes Security Check",
      "title": "CPU requests not specified",
      "severity": "LOW",
      "file": "infrastructure/k8s/opa-gatekeeper.yaml",
      "line": 57,
      "end_line": 83,
      "message": "Container 'opa' of Deployment 'opa-server' should set 'resources.requests.cpu'",
      "description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
      "remediation": "Set 'containers[].resources.requests.cpu'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
        "https://avd.aquasec.com/misconfig/ksv015"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV015",
        "AVDID": "AVD-KSV-0015",
        "Title": "CPU requests not specified",
        "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
        "Message": "Container 'opa' of Deployment 'opa-server' should set 'resources.requests.cpu'",
        "Namespace": "builtin.kubernetes.KSV015",
        "Query": "data.builtin.kubernetes.KSV015.deny",
        "Resolution": "Set 'containers[].resources.requests.cpu'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
        "References": [
          "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
          "https://avd.aquasec.com/misconfig/ksv015"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 57,
          "EndLine": 83,
          "Code": {
            "Lines": [
              {
                "Number": 57,
                "Content": "      - name: opa",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: opa",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 58,
                "Content": "        image: openpolicyagent/opa:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: openpolicyagent/opa:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 59,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 60,
                "Content": "        - name: http",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: http",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 61,
                "Content": "          containerPort: 8181",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8181",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 62,
                "Content": "        args:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33margs\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 63,
                "Content": "        - \"run\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;37m\"run\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 64,
                "Content": "        - \"--server\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;37m\"--server\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 65,
                "Content": "        - \"--log-level=debug\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;37m\"--log-level=debug\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 66,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_123",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV016",
      "check_type": "Kubernetes Security Check",
      "title": "Memory requests not specified",
      "severity": "LOW",
      "file": "infrastructure/k8s/opa-gatekeeper.yaml",
      "line": 57,
      "end_line": 83,
      "message": "Container 'opa' of Deployment 'opa-server' should set 'resources.requests.memory'",
      "description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
      "remediation": "Set 'containers[].resources.requests.memory'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-resources-limits-memory/",
        "https://avd.aquasec.com/misconfig/ksv016"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV016",
        "AVDID": "AVD-KSV-0016",
        "Title": "Memory requests not specified",
        "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
        "Message": "Container 'opa' of Deployment 'opa-server' should set 'resources.requests.memory'",
        "Namespace": "builtin.kubernetes.KSV016",
        "Query": "data.builtin.kubernetes.KSV016.deny",
        "Resolution": "Set 'containers[].resources.requests.memory'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
        "References": [
          "https://kubesec.io/basics/containers-resources-limits-memory/",
          "https://avd.aquasec.com/misconfig/ksv016"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 57,
          "EndLine": 83,
          "Code": {
            "Lines": [
              {
                "Number": 57,
                "Content": "      - name: opa",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: opa",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 58,
                "Content": "        image: openpolicyagent/opa:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: openpolicyagent/opa:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 59,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 60,
                "Content": "        - name: http",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: http",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 61,
                "Content": "          containerPort: 8181",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8181",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 62,
                "Content": "        args:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33margs\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 63,
                "Content": "        - \"run\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;37m\"run\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 64,
                "Content": "        - \"--server\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;37m\"--server\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 65,
                "Content": "        - \"--log-level=debug\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;37m\"--log-level=debug\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 66,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_124",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV018",
      "check_type": "Kubernetes Security Check",
      "title": "Memory not limited",
      "severity": "LOW",
      "file": "infrastructure/k8s/opa-gatekeeper.yaml",
      "line": 57,
      "end_line": 83,
      "message": "Container 'opa' of Deployment 'opa-server' should set 'resources.limits.memory'",
      "description": "Enforcing memory limits prevents DoS via resource exhaustion.",
      "remediation": "Set a limit value under 'containers[].resources.limits.memory'.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-resources-limits-memory/",
        "https://avd.aquasec.com/misconfig/ksv018"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV018",
        "AVDID": "AVD-KSV-0018",
        "Title": "Memory not limited",
        "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
        "Message": "Container 'opa' of Deployment 'opa-server' should set 'resources.limits.memory'",
        "Namespace": "builtin.kubernetes.KSV018",
        "Query": "data.builtin.kubernetes.KSV018.deny",
        "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
        "References": [
          "https://kubesec.io/basics/containers-resources-limits-memory/",
          "https://avd.aquasec.com/misconfig/ksv018"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 57,
          "EndLine": 83,
          "Code": {
            "Lines": [
              {
                "Number": 57,
                "Content": "      - name: opa",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: opa",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 58,
                "Content": "        image: openpolicyagent/opa:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: openpolicyagent/opa:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 59,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 60,
                "Content": "        - name: http",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: http",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 61,
                "Content": "          containerPort: 8181",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8181",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 62,
                "Content": "        args:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33margs\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 63,
                "Content": "        - \"run\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;37m\"run\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 64,
                "Content": "        - \"--server\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;37m\"--server\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 65,
                "Content": "        - \"--log-level=debug\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;37m\"--log-level=debug\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 66,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_125",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV020",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with UID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/opa-gatekeeper.yaml",
      "line": 57,
      "end_line": 83,
      "message": "Container 'opa' of Deployment 'opa-server' should set 'securityContext.runAsUser' > 10000",
      "description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv020"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV020",
        "AVDID": "AVD-KSV-0020",
        "Title": "Runs with UID <= 10000",
        "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'opa' of Deployment 'opa-server' should set 'securityContext.runAsUser' > 10000",
        "Namespace": "builtin.kubernetes.KSV020",
        "Query": "data.builtin.kubernetes.KSV020.deny",
        "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv020"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 57,
          "EndLine": 83,
          "Code": {
            "Lines": [
              {
                "Number": 57,
                "Content": "      - name: opa",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: opa",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 58,
                "Content": "        image: openpolicyagent/opa:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: openpolicyagent/opa:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 59,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 60,
                "Content": "        - name: http",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: http",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 61,
                "Content": "          containerPort: 8181",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8181",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 62,
                "Content": "        args:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33margs\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 63,
                "Content": "        - \"run\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;37m\"run\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 64,
                "Content": "        - \"--server\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;37m\"--server\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 65,
                "Content": "        - \"--log-level=debug\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;37m\"--log-level=debug\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 66,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_126",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV021",
      "check_type": "Kubernetes Security Check",
      "title": "Runs with GID <= 10000",
      "severity": "LOW",
      "file": "infrastructure/k8s/opa-gatekeeper.yaml",
      "line": 57,
      "end_line": 83,
      "message": "Container 'opa' of Deployment 'opa-server' should set 'securityContext.runAsGroup' > 10000",
      "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
      "remediation": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubesec.io/basics/containers-securitycontext-runasuser/",
        "https://avd.aquasec.com/misconfig/ksv021"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV021",
        "AVDID": "AVD-KSV-0021",
        "Title": "Runs with GID <= 10000",
        "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.",
        "Message": "Container 'opa' of Deployment 'opa-server' should set 'securityContext.runAsGroup' > 10000",
        "Namespace": "builtin.kubernetes.KSV021",
        "Query": "data.builtin.kubernetes.KSV021.deny",
        "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
        "References": [
          "https://kubesec.io/basics/containers-securitycontext-runasuser/",
          "https://avd.aquasec.com/misconfig/ksv021"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 57,
          "EndLine": 83,
          "Code": {
            "Lines": [
              {
                "Number": 57,
                "Content": "      - name: opa",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: opa",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 58,
                "Content": "        image: openpolicyagent/opa:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: openpolicyagent/opa:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 59,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 60,
                "Content": "        - name: http",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: http",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 61,
                "Content": "          containerPort: 8181",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8181",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 62,
                "Content": "        args:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33margs\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 63,
                "Content": "        - \"run\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;37m\"run\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 64,
                "Content": "        - \"--server\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;37m\"--server\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 65,
                "Content": "        - \"--log-level=debug\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;37m\"--log-level=debug\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 66,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_127",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV030",
      "check_type": "Kubernetes Security Check",
      "title": "Runtime/Default Seccomp profile not set",
      "severity": "LOW",
      "file": "infrastructure/k8s/opa-gatekeeper.yaml",
      "line": 57,
      "end_line": 83,
      "message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
      "description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
      "remediation": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
        "https://avd.aquasec.com/misconfig/ksv030"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV030",
        "AVDID": "AVD-KSV-0030",
        "Title": "Runtime/Default Seccomp profile not set",
        "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
        "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
        "Namespace": "builtin.kubernetes.KSV030",
        "Query": "data.builtin.kubernetes.KSV030.deny",
        "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
          "https://avd.aquasec.com/misconfig/ksv030"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 57,
          "EndLine": 83,
          "Code": {
            "Lines": [
              {
                "Number": 57,
                "Content": "      - name: opa",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: opa",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 58,
                "Content": "        image: openpolicyagent/opa:latest",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: openpolicyagent/opa:latest",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 59,
                "Content": "        ports:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 60,
                "Content": "        - name: http",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: http",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 61,
                "Content": "          containerPort: 8181",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "          \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m8181",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 62,
                "Content": "        args:",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        \u001b[38;5;33margs\u001b[0m:",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 63,
                "Content": "        - \"run\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "        - \u001b[38;5;37m\"run\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 64,
                "Content": "        - \"--server\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;37m\"--server\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 65,
                "Content": "        - \"--log-level=debug\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m        - \u001b[38;5;37m\"--log-level=debug\"",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 66,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_128",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "KSV104",
      "check_type": "Kubernetes Security Check",
      "title": "Seccomp policies disabled",
      "severity": "MEDIUM",
      "file": "infrastructure/k8s/opa-gatekeeper.yaml",
      "line": 31,
      "end_line": 31,
      "message": "container \"opa\" of deployment \"opa-server\" in \"securebank\" namespace should specify a seccomp profile",
      "description": "A program inside the container can bypass Seccomp protection policies.",
      "remediation": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
      "provider": "Kubernetes",
      "service": "general",
      "references": [
        "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
        "https://avd.aquasec.com/misconfig/ksv104"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Kubernetes Security Check",
        "ID": "KSV104",
        "AVDID": "AVD-KSV-0104",
        "Title": "Seccomp policies disabled",
        "Description": "A program inside the container can bypass Seccomp protection policies.",
        "Message": "container \"opa\" of deployment \"opa-server\" in \"securebank\" namespace should specify a seccomp profile",
        "Namespace": "builtin.kubernetes.KSV104",
        "Query": "data.builtin.kubernetes.KSV104.deny",
        "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
        "References": [
          "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
          "https://avd.aquasec.com/misconfig/ksv104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Kubernetes",
          "Service": "general",
          "StartLine": 31,
          "EndLine": 31,
          "Code": {
            "Lines": [
              {
                "Number": 31,
                "Content": "---",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "---",
                "FirstCause": true,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_129",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "DS002",
      "check_type": "Dockerfile Security Check",
      "title": "Image user should not be 'root'",
      "severity": "HIGH",
      "file": "infrastructure/postgres/Dockerfile",
      "line": 0,
      "end_line": 0,
      "message": "Specify at least 1 USER command in Dockerfile with non-root user as argument",
      "description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
      "remediation": "Add 'USER <non root user name>' line to the Dockerfile",
      "provider": "Dockerfile",
      "service": "general",
      "references": [
        "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
        "https://avd.aquasec.com/misconfig/ds002"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Dockerfile Security Check",
        "ID": "DS002",
        "AVDID": "AVD-DS-0002",
        "Title": "Image user should not be 'root'",
        "Description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
        "Message": "Specify at least 1 USER command in Dockerfile with non-root user as argument",
        "Namespace": "builtin.dockerfile.DS002",
        "Query": "data.builtin.dockerfile.DS002.deny",
        "Resolution": "Add 'USER <non root user name>' line to the Dockerfile",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ds002",
        "References": [
          "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
          "https://avd.aquasec.com/misconfig/ds002"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Dockerfile",
          "Service": "general",
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_130",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "DS026",
      "check_type": "Dockerfile Security Check",
      "title": "No HEALTHCHECK defined",
      "severity": "LOW",
      "file": "infrastructure/postgres/Dockerfile",
      "line": 0,
      "end_line": 0,
      "message": "Add HEALTHCHECK instruction in your Dockerfile",
      "description": "You should add HEALTHCHECK instruction in your docker container images to perform the health check on running containers.",
      "remediation": "Add HEALTHCHECK instruction in Dockerfile",
      "provider": "Dockerfile",
      "service": "general",
      "references": [
        "https://blog.aquasec.com/docker-security-best-practices",
        "https://avd.aquasec.com/misconfig/ds026"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Dockerfile Security Check",
        "ID": "DS026",
        "AVDID": "AVD-DS-0026",
        "Title": "No HEALTHCHECK defined",
        "Description": "You should add HEALTHCHECK instruction in your docker container images to perform the health check on running containers.",
        "Message": "Add HEALTHCHECK instruction in your Dockerfile",
        "Namespace": "builtin.dockerfile.DS026",
        "Query": "data.builtin.dockerfile.DS026.deny",
        "Resolution": "Add HEALTHCHECK instruction in Dockerfile",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/ds026",
        "References": [
          "https://blog.aquasec.com/docker-security-best-practices",
          "https://avd.aquasec.com/misconfig/ds026"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Provider": "Dockerfile",
          "Service": "general",
          "Code": {
            "Lines": null
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_131",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0057",
      "check_type": "Terraform Security Check",
      "title": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
      "severity": "HIGH",
      "file": "infrastructure/terraform/iam-least-privilege.tf",
      "line": 41,
      "end_line": 41,
      "message": "IAM policy document uses sensitive action 's3:GetObject' on wildcarded resource '7ac627d6-a5f4-462d-a60d-7f310f930bb6/*'",
      "description": "You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.",
      "remediation": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
      "provider": "AWS",
      "service": "iam",
      "references": [
        "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0057"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0057",
        "AVDID": "AVD-AWS-0057",
        "Title": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
        "Description": "You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.",
        "Message": "IAM policy document uses sensitive action 's3:GetObject' on wildcarded resource '7ac627d6-a5f4-462d-a60d-7f310f930bb6/*'",
        "Query": "data..",
        "Resolution": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0057",
        "References": [
          "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0057"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_iam_policy.backend_s3",
          "Provider": "AWS",
          "Service": "iam",
          "StartLine": 41,
          "EndLine": 41,
          "Code": {
            "Lines": [
              {
                "Number": 36,
                "Content": "resource \"aws_iam_policy\" \"backend_s3\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_iam_policy\"\u001b[0m \u001b[38;5;37m\"backend_s3\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 37,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 41,
                "Content": "    Version = \"2012-10-17\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mVersion\u001b[0m = \u001b[38;5;37m\"2012-10-17\"",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 74,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 75,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "aws_iam_policy.backend_s3.policy",
              "Filename": "infrastructure/terraform/iam-least-privilege.tf",
              "Location": {
                "StartLine": 41,
                "EndLine": 41
              }
            },
            {
              "Resource": "aws_iam_policy.backend_s3.policy",
              "Filename": "infrastructure/terraform/iam-least-privilege.tf",
              "Location": {
                "StartLine": 40,
                "EndLine": 69
              }
            },
            {
              "Resource": "aws_iam_policy.backend_s3",
              "Filename": "infrastructure/terraform/iam-least-privilege.tf",
              "Location": {
                "StartLine": 36,
                "EndLine": 75
              }
            }
          ]
        }
      }
    },
    {
      "id": "trivy_misconfig_132",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0057",
      "check_type": "Terraform Security Check",
      "title": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
      "severity": "HIGH",
      "file": "infrastructure/terraform/iam.tf",
      "line": 185,
      "end_line": 185,
      "message": "IAM policy document uses sensitive action 'kms:Decrypt' on wildcarded resource 'arn:aws:kms:*:*:key/*'",
      "description": "You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.",
      "remediation": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
      "provider": "AWS",
      "service": "iam",
      "references": [
        "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0057"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0057",
        "AVDID": "AVD-AWS-0057",
        "Title": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
        "Description": "You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.",
        "Message": "IAM policy document uses sensitive action 'kms:Decrypt' on wildcarded resource 'arn:aws:kms:*:*:key/*'",
        "Query": "data..",
        "Resolution": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0057",
        "References": [
          "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0057"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_iam_role_policy.app_kms",
          "Provider": "AWS",
          "Service": "iam",
          "StartLine": 185,
          "EndLine": 185,
          "Code": {
            "Lines": [
              {
                "Number": 180,
                "Content": "resource \"aws_iam_role_policy\" \"app_kms\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_iam_role_policy\"\u001b[0m \u001b[38;5;37m\"app_kms\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 181,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 185,
                "Content": "    Version = \"2012-10-17\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mVersion\u001b[0m = \u001b[38;5;37m\"2012-10-17\"",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 208,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 209,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "aws_iam_role_policy.app_kms.policy",
              "Filename": "infrastructure/terraform/iam.tf",
              "Location": {
                "StartLine": 185,
                "EndLine": 185
              }
            },
            {
              "Resource": "aws_iam_role_policy.app_kms.policy",
              "Filename": "infrastructure/terraform/iam.tf",
              "Location": {
                "StartLine": 184,
                "EndLine": 208
              }
            },
            {
              "Resource": "aws_iam_role_policy.app_kms",
              "Filename": "infrastructure/terraform/iam.tf",
              "Location": {
                "StartLine": 180,
                "EndLine": 209
              }
            }
          ]
        }
      }
    },
    {
      "id": "trivy_misconfig_133",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0089",
      "check_type": "Terraform Security Check",
      "title": "S3 Bucket Logging",
      "severity": "LOW",
      "file": "infrastructure/terraform/s3.tf",
      "line": 134,
      "end_line": 143,
      "message": "Bucket has logging disabled",
      "description": "Ensures S3 bucket logging is enabled for S3 buckets",
      "remediation": "Add a logging block to the resource to enable access logging",
      "provider": "AWS",
      "service": "s3",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0089"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0089",
        "AVDID": "AVD-AWS-0089",
        "Title": "S3 Bucket Logging",
        "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
        "Message": "Bucket has logging disabled",
        "Namespace": "builtin.aws.s3.aws0089",
        "Query": "data.builtin.aws.s3.aws0089.deny",
        "Resolution": "Add a logging block to the resource to enable access logging",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0089",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0089"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_s3_bucket.audit_logs",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 134,
          "EndLine": 143,
          "Code": {
            "Lines": [
              {
                "Number": 134,
                "Content": "resource \"aws_s3_bucket\" \"audit_logs\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"audit_logs\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 135,
                "Content": "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-audit-logs\" : \"${var.project_name}-audit-logs-${var.environment}-${data.aws_caller_identity.current.account_id}\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;33mvar\u001b[0m.\u001b[38;5;245mdeployment_target\u001b[0m =\u001b[38;5;245m=\u001b[0m \u001b[38;5;37m\"localstack\"\u001b[0m \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-audit-logs\"\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-audit-logs-\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.environment\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.aws_caller_identity.current.account_id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 136,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 137,
                "Content": "  force_destroy = true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 138,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 139,
                "Content": "  tags = {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 140,
                "Content": "    Name     = \"Audit Logs\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m     = \u001b[38;5;37m\"Audit Logs\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 141,
                "Content": "    Contains = \"PCI Audit Logs\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mContains\u001b[0m = \u001b[38;5;37m\"PCI Audit Logs\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 142,
                "Content": "  }",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  }",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 143,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_134",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0104",
      "check_type": "Terraform Security Check",
      "title": "An egress security group rule allows traffic to /0.",
      "severity": "CRITICAL",
      "file": "infrastructure/terraform/security-groups.tf",
      "line": 106,
      "end_line": 106,
      "message": "Security group rule allows egress to multiple public internet addresses.",
      "description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.",
      "remediation": "Set a more restrictive cidr range",
      "provider": "AWS",
      "service": "ec2",
      "references": [
        "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0104"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0104",
        "AVDID": "AVD-AWS-0104",
        "Title": "An egress security group rule allows traffic to /0.",
        "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.",
        "Message": "Security group rule allows egress to multiple public internet addresses.",
        "Query": "data..",
        "Resolution": "Set a more restrictive cidr range",
        "Severity": "CRITICAL",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0104",
        "References": [
          "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_security_group_rule.backend_egress_https",
          "Provider": "AWS",
          "Service": "ec2",
          "StartLine": 106,
          "EndLine": 106,
          "Code": {
            "Lines": [
              {
                "Number": 98,
                "Content": "resource \"aws_security_group_rule\" \"backend_egress_https\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"backend_egress_https\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 99,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 106,
                "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]  # TODO: Replace with VPC endpoint",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]\u001b[38;5;239m  # TODO: Replace with VPC endpoint",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 108,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 109,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "aws_security_group_rule.backend_egress_https",
              "Filename": "infrastructure/terraform/security-groups.tf",
              "Location": {
                "StartLine": 98,
                "EndLine": 109
              }
            }
          ]
        }
      }
    },
    {
      "id": "trivy_misconfig_135",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0104",
      "check_type": "Terraform Security Check",
      "title": "An egress security group rule allows traffic to /0.",
      "severity": "CRITICAL",
      "file": "infrastructure/terraform/security-groups.tf",
      "line": 240,
      "end_line": 240,
      "message": "Security group rule allows egress to multiple public internet addresses.",
      "description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.",
      "remediation": "Set a more restrictive cidr range",
      "provider": "AWS",
      "service": "ec2",
      "references": [
        "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0104"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0104",
        "AVDID": "AVD-AWS-0104",
        "Title": "An egress security group rule allows traffic to /0.",
        "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.",
        "Message": "Security group rule allows egress to multiple public internet addresses.",
        "Query": "data..",
        "Resolution": "Set a more restrictive cidr range",
        "Severity": "CRITICAL",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0104",
        "References": [
          "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_security_group_rule.eks_nodes_egress_https",
          "Provider": "AWS",
          "Service": "ec2",
          "StartLine": 240,
          "EndLine": 240,
          "Code": {
            "Lines": [
              {
                "Number": 235,
                "Content": "resource \"aws_security_group_rule\" \"eks_nodes_egress_https\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"eks_nodes_egress_https\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 236,
                "Content": "  type              = \"egress\"",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"egress\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 237,
                "Content": "  from_port         = 443",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m443",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 238,
                "Content": "  to_port           = 443",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m443",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 239,
                "Content": "  protocol          = \"tcp\"",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 240,
                "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 241,
                "Content": "  description       = \"Internet for images/updates\"",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mdescription\u001b[0m       = \u001b[38;5;37m\"Internet for images/updates\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 242,
                "Content": "  security_group_id = aws_security_group.eks_nodes.id",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245msecurity_group_id\u001b[0m = aws_security_group.eks_nodes.id",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 243,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "aws_security_group_rule.eks_nodes_egress_https",
              "Filename": "infrastructure/terraform/security-groups.tf",
              "Location": {
                "StartLine": 235,
                "EndLine": 243
              }
            }
          ]
        }
      }
    },
    {
      "id": "trivy_misconfig_136",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0107",
      "check_type": "Terraform Security Check",
      "title": "An ingress security group rule allows traffic from /0.",
      "severity": "CRITICAL",
      "file": "infrastructure/terraform/security-groups.tf",
      "line": 37,
      "end_line": 37,
      "message": "Security group rule allows ingress from public internet.",
      "description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
      "remediation": "Set a more restrictive cidr range",
      "provider": "AWS",
      "service": "ec2",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0107"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0107",
        "AVDID": "AVD-AWS-0107",
        "Title": "An ingress security group rule allows traffic from /0.",
        "Description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
        "Message": "Security group rule allows ingress from public internet.",
        "Query": "data..",
        "Resolution": "Set a more restrictive cidr range",
        "Severity": "CRITICAL",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
        "References": [
          "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0107"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_security_group_rule.alb_ingress_http",
          "Provider": "AWS",
          "Service": "ec2",
          "StartLine": 37,
          "EndLine": 37,
          "Code": {
            "Lines": [
              {
                "Number": 32,
                "Content": "resource \"aws_security_group_rule\" \"alb_ingress_http\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"alb_ingress_http\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "  type              = \"ingress\"",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 34,
                "Content": "  from_port         = 80",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m80",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 35,
                "Content": "  to_port           = 80",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m80",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 36,
                "Content": "  protocol          = \"tcp\"",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 37,
                "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 38,
                "Content": "  description       = \"HTTP redirect to HTTPS\"",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mdescription\u001b[0m       = \u001b[38;5;37m\"HTTP redirect to HTTPS\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "  security_group_id = aws_security_group.alb.id",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245msecurity_group_id\u001b[0m = aws_security_group.alb.id",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 40,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "aws_security_group_rule.alb_ingress_http",
              "Filename": "infrastructure/terraform/security-groups.tf",
              "Location": {
                "StartLine": 32,
                "EndLine": 40
              }
            }
          ]
        }
      }
    },
    {
      "id": "trivy_misconfig_137",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0107",
      "check_type": "Terraform Security Check",
      "title": "An ingress security group rule allows traffic from /0.",
      "severity": "CRITICAL",
      "file": "infrastructure/terraform/security-groups.tf",
      "line": 27,
      "end_line": 27,
      "message": "Security group rule allows ingress from public internet.",
      "description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
      "remediation": "Set a more restrictive cidr range",
      "provider": "AWS",
      "service": "ec2",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0107"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0107",
        "AVDID": "AVD-AWS-0107",
        "Title": "An ingress security group rule allows traffic from /0.",
        "Description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
        "Message": "Security group rule allows ingress from public internet.",
        "Query": "data..",
        "Resolution": "Set a more restrictive cidr range",
        "Severity": "CRITICAL",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
        "References": [
          "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0107"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_security_group_rule.alb_ingress_https",
          "Provider": "AWS",
          "Service": "ec2",
          "StartLine": 27,
          "EndLine": 27,
          "Code": {
            "Lines": [
              {
                "Number": 22,
                "Content": "resource \"aws_security_group_rule\" \"alb_ingress_https\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group_rule\"\u001b[0m \u001b[38;5;37m\"alb_ingress_https\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "  type              = \"ingress\"",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtype\u001b[0m              = \u001b[38;5;37m\"ingress\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 24,
                "Content": "  from_port         = 443",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mfrom_port\u001b[0m         = \u001b[38;5;37m443",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "  to_port           = 443",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mto_port\u001b[0m           = \u001b[38;5;37m443",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "  protocol          = \"tcp\"",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mprotocol\u001b[0m          = \u001b[38;5;37m\"tcp\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mcidr_blocks\u001b[0m       = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 28,
                "Content": "  description       = \"HTTPS from internet\"",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mdescription\u001b[0m       = \u001b[38;5;37m\"HTTPS from internet\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "  security_group_id = aws_security_group.alb.id",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245msecurity_group_id\u001b[0m = aws_security_group.alb.id",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 30,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "aws_security_group_rule.alb_ingress_https",
              "Filename": "infrastructure/terraform/security-groups.tf",
              "Location": {
                "StartLine": 22,
                "EndLine": 30
              }
            }
          ]
        }
      }
    },
    {
      "id": "trivy_misconfig_138",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0057",
      "check_type": "Terraform Security Check",
      "title": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
      "severity": "HIGH",
      "file": "infrastructure/terraform/vpc.tf",
      "line": 130,
      "end_line": 130,
      "message": "IAM policy document uses sensitive action 'logs:CreateLogStream' on wildcarded resource '*'",
      "description": "You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.",
      "remediation": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
      "provider": "AWS",
      "service": "iam",
      "references": [
        "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0057"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0057",
        "AVDID": "AVD-AWS-0057",
        "Title": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
        "Description": "You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.",
        "Message": "IAM policy document uses sensitive action 'logs:CreateLogStream' on wildcarded resource '*'",
        "Query": "data..",
        "Resolution": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0057",
        "References": [
          "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0057"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_iam_role_policy.vpc_flow_logs",
          "Provider": "AWS",
          "Service": "iam",
          "StartLine": 130,
          "EndLine": 130,
          "Code": {
            "Lines": [
              {
                "Number": 125,
                "Content": "resource \"aws_iam_role_policy\" \"vpc_flow_logs\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_iam_role_policy\"\u001b[0m \u001b[38;5;37m\"vpc_flow_logs\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 126,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 130,
                "Content": "    Version = \"2012-10-17\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mVersion\u001b[0m = \u001b[38;5;37m\"2012-10-17\"",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 144,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 145,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "aws_iam_role_policy.vpc_flow_logs.policy",
              "Filename": "infrastructure/terraform/vpc.tf",
              "Location": {
                "StartLine": 130,
                "EndLine": 130
              }
            },
            {
              "Resource": "aws_iam_role_policy.vpc_flow_logs.policy",
              "Filename": "infrastructure/terraform/vpc.tf",
              "Location": {
                "StartLine": 129,
                "EndLine": 144
              }
            },
            {
              "Resource": "aws_iam_role_policy.vpc_flow_logs",
              "Filename": "infrastructure/terraform/vpc.tf",
              "Location": {
                "StartLine": 125,
                "EndLine": 145
              }
            }
          ]
        }
      }
    },
    {
      "id": "trivy_misconfig_139",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0164",
      "check_type": "Terraform Security Check",
      "title": "Instances in a subnet should not receive a public IP address by default.",
      "severity": "HIGH",
      "file": "infrastructure/terraform/vpc.tf",
      "line": 26,
      "end_line": 26,
      "message": "Subnet associates public IP address.",
      "description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.",
      "remediation": "Set the instance to not be publicly accessible",
      "provider": "AWS",
      "service": "ec2",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
        "https://avd.aquasec.com/misconfig/avd-aws-0164"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0164",
        "AVDID": "AVD-AWS-0164",
        "Title": "Instances in a subnet should not receive a public IP address by default.",
        "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.",
        "Message": "Subnet associates public IP address.",
        "Query": "data..",
        "Resolution": "Set the instance to not be publicly accessible",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0164",
        "References": [
          "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
          "https://avd.aquasec.com/misconfig/avd-aws-0164"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_subnet.public_1",
          "Provider": "AWS",
          "Service": "ec2",
          "StartLine": 26,
          "EndLine": 26,
          "Code": {
            "Lines": [
              {
                "Number": 22,
                "Content": "resource \"aws_subnet\" \"public_1\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_subnet\"\u001b[0m \u001b[38;5;37m\"public_1\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "  map_public_ip_on_launch = true  # \u2705 Correct for public subnet (for ALB, bastion)",
                "IsCause": true,
                "Annotation": "true",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mmap_public_ip_on_launch\u001b[0m = \u001b[38;5;166mtrue\u001b[0m\u001b[38;5;239m  # \u2705 Correct for public subnet (for ALB, bastion)",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 32,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "aws_subnet.public_1",
              "Filename": "infrastructure/terraform/vpc.tf",
              "Location": {
                "StartLine": 22,
                "EndLine": 33
              }
            }
          ]
        }
      }
    },
    {
      "id": "trivy_misconfig_140",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0164",
      "check_type": "Terraform Security Check",
      "title": "Instances in a subnet should not receive a public IP address by default.",
      "severity": "HIGH",
      "file": "infrastructure/terraform/vpc.tf",
      "line": 39,
      "end_line": 39,
      "message": "Subnet associates public IP address.",
      "description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.",
      "remediation": "Set the instance to not be publicly accessible",
      "provider": "AWS",
      "service": "ec2",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
        "https://avd.aquasec.com/misconfig/avd-aws-0164"
      ],
      "scan_timestamp": "20251015_124747",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0164",
        "AVDID": "AVD-AWS-0164",
        "Title": "Instances in a subnet should not receive a public IP address by default.",
        "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.",
        "Message": "Subnet associates public IP address.",
        "Query": "data..",
        "Resolution": "Set the instance to not be publicly accessible",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0164",
        "References": [
          "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
          "https://avd.aquasec.com/misconfig/avd-aws-0164"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_subnet.public_2",
          "Provider": "AWS",
          "Service": "ec2",
          "StartLine": 39,
          "EndLine": 39,
          "Code": {
            "Lines": [
              {
                "Number": 35,
                "Content": "resource \"aws_subnet\" \"public_2\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_subnet\"\u001b[0m \u001b[38;5;37m\"public_2\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 36,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "  map_public_ip_on_launch = true  # \u2705 Correct for public subnet (for ALB, bastion)",
                "IsCause": true,
                "Annotation": "true",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mmap_public_ip_on_launch\u001b[0m = \u001b[38;5;166mtrue\u001b[0m\u001b[38;5;239m  # \u2705 Correct for public subnet (for ALB, bastion)",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 45,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 46,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "aws_subnet.public_2",
              "Filename": "infrastructure/terraform/vpc.tf",
              "Location": {
                "StartLine": 35,
                "EndLine": 46
              }
            }
          ]
        }
      }
    }
  ],
  "metadata": {
    "scanner": "trivy-config",
    "scan_mode": "config",
    "scan_timestamp": "2025-10-15T12:47:47.910237",
    "target": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project",
    "issue_count": 140,
    "severity_breakdown": {
      "CRITICAL": 4,
      "HIGH": 21,
      "MEDIUM": 36,
      "LOW": 79,
      "INFO": 0
    },
    "misconfiguration_summary": {
      "total_checks": 140,
      "by_type": {
        "Dockerfile Security Check": 9,
        "Kubernetes Security Check": 121,
        "Terraform Security Check": 10
      },
      "by_service": {
        "general": 130,
        "iam": 3,
        "s3": 1,
        "ec2": 6
      },
      "unique_files": 15
    }
  }
}