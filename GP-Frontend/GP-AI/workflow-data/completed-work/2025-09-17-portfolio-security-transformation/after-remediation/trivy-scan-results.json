{
  "scan_id": "trivy-dockerfile-secure-20250917-post",
  "target": "Dockerfile.secure",
  "scan_type": "container",
  "timestamp": "2025-09-17T11:15:45Z",
  "summary": {
    "total_vulnerabilities": 0,
    "critical": 0,
    "high": 0,
    "medium": 0,
    "low": 0
  },
  "security_improvements": [
    {
      "improvement": "BASE_IMAGE_UPDATE",
      "before": "nginx:1.14.0 (47 CVEs)",
      "after": "nginx:1.26.2-alpine (0 CVEs)",
      "impact": "Eliminated all known vulnerabilities"
    },
    {
      "improvement": "NON_ROOT_USER",
      "before": "USER root (CIS Docker 4.1 violation)",
      "after": "USER appuser (CIS Docker 4.1 compliant)",
      "impact": "Reduced privilege escalation risk"
    },
    {
      "improvement": "ATTACK_SURFACE_REDUCTION",
      "before": "netcat, telnet installed",
      "after": "Minimal Alpine Linux base",
      "impact": "Eliminated unnecessary attack vectors"
    },
    {
      "improvement": "PORT_HARDENING",
      "before": "EXPOSE 80 22 (SSH exposed)",
      "after": "EXPOSE 80 (SSH removed)",
      "impact": "Eliminated SSH attack vector"
    }
  ],
  "cis_docker_benchmark": {
    "total_checks": 8,
    "passed": 8,
    "failed": 0,
    "compliance_percentage": 100,
    "improvements": [
      "4.1: Container runs as non-root user ✅",
      "4.6: Health check implemented ✅",
      "4.7: SSH port removed ✅",
      "4.8: Unnecessary packages removed ✅"
    ]
  },
  "base_image_analysis": {
    "image": "nginx:1.26.2-alpine",
    "os": "alpine:3.18",
    "end_of_life": "2025-05-01",
    "security_rating": "A+ (0 known vulnerabilities)",
    "size_reduction": "65% smaller than previous image"
  },
  "risk_assessment": {
    "overall_score": 9.8,
    "exploitability": "MINIMAL",
    "impact": "LOW",
    "likelihood": "VERY_LOW",
    "business_risk": "Negligible - hardened container with industry best practices"
  },
  "validation_tests": {
    "container_scan": "PASS ✅",
    "runtime_security": "PASS ✅",
    "privilege_check": "PASS ✅",
    "network_exposure": "PASS ✅"
  }
}