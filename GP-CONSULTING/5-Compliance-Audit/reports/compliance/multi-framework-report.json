{
  "report_metadata": {
    "title": "Multi-Framework Security Compliance Report",
    "frameworks": [
      "ISO 27001:2022",
      "SOC2 Trust Service Criteria"
    ],
    "generated_date": "2025-10-10T12:55:04.052619",
    "scanner_count": 5,
    "scanners_used": [
      "Bandit",
      "Semgrep",
      "Gitleaks",
      "Trivy",
      "Checkov"
    ]
  },
  "executive_summary": {
    "scan_date": "2025-10-10T12:55:04.052600",
    "overview": {
      "total_findings": 146,
      "mapped_findings": 31,
      "critical_issues": 27,
      "high_issues": 8,
      "medium_issues": 104,
      "low_issues": 7
    },
    "compliance_impact": {
      "iso27001_controls_affected": 9,
      "soc2_criteria_affected": 4,
      "cross_framework_findings": 31,
      "high_impact_findings": 31
    },
    "remediation": {
      "total_effort_hours": 170,
      "total_effort_days": 21.2,
      "total_effort_weeks": 4.2,
      "priority_items": 21,
      "quick_wins_available": 10
    },
    "key_recommendations": [
      {
        "priority": 1,
        "title": "Address Cross-Framework Issues First",
        "description": "Fix 31 issues that affect BOTH ISO 27001 and SOC2",
        "impact": "Maximum compliance ROI",
        "effort": "170 hours"
      },
      {
        "priority": 2,
        "title": "Resolve Critical Security Issues",
        "description": "Address 27 CRITICAL vulnerabilities",
        "impact": "Prevent potential security breaches",
        "effort": "116 hours"
      },
      {
        "priority": 3,
        "title": "Implement Quick Wins",
        "description": "Complete 10 high-ROI, low-effort fixes",
        "impact": "Fast compliance improvements",
        "effort": "28 hours"
      }
    ]
  },
  "cross_framework_analysis": {
    "total_findings": 146,
    "iso27001_only": 0,
    "soc2_only": 0,
    "both_frameworks": 31,
    "unmapped": 115,
    "high_impact_findings": [
      {
        "scanner": "gitleaks",
        "file": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/.env.example",
        "line": 34,
        "issue": "Generic API Key detected",
        "severity": "CRITICAL",
        "iso27001_controls": 2,
        "soc2_criteria": 3,
        "total_controls": 5
      },
      {
        "scanner": "gitleaks",
        "file": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/README.md",
        "line": 112,
        "issue": "Generic API Key detected",
        "severity": "CRITICAL",
        "iso27001_controls": 2,
        "soc2_criteria": 3,
        "total_controls": 5
      },
      {
        "scanner": "gitleaks",
        "file": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/README.md",
        "line": 132,
        "issue": "Generic API Key detected",
        "severity": "CRITICAL",
        "iso27001_controls": 2,
        "soc2_criteria": 3,
        "total_controls": 5
      },
      {
        "scanner": "gitleaks",
        "file": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/README.md",
        "line": 329,
        "issue": "Generic API Key detected",
        "severity": "CRITICAL",
        "iso27001_controls": 2,
        "soc2_criteria": 3,
        "total_controls": 5
      },
      {
        "scanner": "gitleaks",
        "file": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/services/aws.service.js",
        "line": 27,
        "issue": "AWS detected",
        "severity": "CRITICAL",
        "iso27001_controls": 2,
        "soc2_criteria": 3,
        "total_controls": 5
      },
      {
        "scanner": "bandit",
        "file": "../GP-AI/cli/jade_chat.py",
        "line": 365,
        "issue": "subprocess call with shell=True identified, security issue.",
        "severity": "CRITICAL",
        "iso27001_controls": 2,
        "soc2_criteria": 3,
        "total_controls": 5
      },
      {
        "scanner": "bandit",
        "file": "../GP-AI/cli/jade_chat.py",
        "line": 586,
        "issue": "subprocess call with shell=True identified, security issue.",
        "severity": "CRITICAL",
        "iso27001_controls": 2,
        "soc2_criteria": 3,
        "total_controls": 5
      },
      {
        "scanner": "bandit",
        "file": "../GP-PLATFORM/core/james_orchestrator.py",
        "line": 60,
        "issue": "subprocess call with shell=True identified, security issue.",
        "severity": "CRITICAL",
        "iso27001_controls": 2,
        "soc2_criteria": 3,
        "total_controls": 5
      },
      {
        "scanner": "bandit",
        "file": "../GP-PLATFORM/core/james_orchestrator.py",
        "line": 121,
        "issue": "subprocess call with shell=True identified, security issue.",
        "severity": "CRITICAL",
        "iso27001_controls": 2,
        "soc2_criteria": 3,
        "total_controls": 5
      },
      {
        "scanner": "bandit",
        "file": "../GP-PROJECTS/kubernetes-goat/infrastructure/info-app/app.py",
        "line": 11,
        "issue": "A Flask app appears to be run with debug=True, which exposes the Werkzeug debugger and allows the execution of arbitrary code.",
        "severity": "HIGH",
        "iso27001_controls": 2,
        "soc2_criteria": 3,
        "total_controls": 5
      },
      {
        "scanner": "bandit",
        "file": "../GP-RAG/jade_api.py",
        "line": 331,
        "issue": "A Flask app appears to be run with debug=True, which exposes the Werkzeug debugger and allows the execution of arbitrary code.",
        "severity": "HIGH",
        "iso27001_controls": 2,
        "soc2_criteria": 3,
        "total_controls": 5
      },
      {
        "scanner": "bandit",
        "file": "../GP-TESTING-VAL/jade_chat_tests.py",
        "line": 29,
        "issue": "subprocess call with shell=True identified, security issue.",
        "severity": "CRITICAL",
        "iso27001_controls": 2,
        "soc2_criteria": 3,
        "total_controls": 5
      },
      {
        "scanner": "bandit",
        "file": "../GP-TESTING-VAL/jade_knowledge_tests.py",
        "line": 29,
        "issue": "subprocess call with shell=True identified, security issue.",
        "severity": "CRITICAL",
        "iso27001_controls": 2,
        "soc2_criteria": 3,
        "total_controls": 5
      },
      {
        "scanner": "bandit",
        "file": "../GP-AI/core/rag_graph_engine.py",
        "line": 518,
        "issue": "Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.",
        "severity": "MEDIUM",
        "iso27001_controls": 2,
        "soc2_criteria": 2,
        "total_controls": 4
      },
      {
        "scanner": "bandit",
        "file": "../GP-RAG/graph_ingest_knowledge.py",
        "line": 56,
        "issue": "Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.",
        "severity": "MEDIUM",
        "iso27001_controls": 2,
        "soc2_criteria": 2,
        "total_controls": 4
      },
      {
        "scanner": "bandit",
        "file": "../GP-RAG/ingest_scan_results.py",
        "line": 64,
        "issue": "Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.",
        "severity": "MEDIUM",
        "iso27001_controls": 2,
        "soc2_criteria": 2,
        "total_controls": 4
      },
      {
        "scanner": "semgrep",
        "file": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/server.js",
        "line": 13,
        "issue": "Express Check Csurf Middleware Usage",
        "severity": "LOW",
        "iso27001_controls": 1,
        "soc2_criteria": 2,
        "total_controls": 3
      },
      {
        "scanner": "checkov",
        "file": "/cloudwatch.tf",
        "line": 8,
        "issue": "Ensure CloudWatch log groups retains logs for at least 1 year",
        "severity": "MEDIUM",
        "iso27001_controls": 2,
        "soc2_criteria": 1,
        "total_controls": 3
      },
      {
        "scanner": "checkov",
        "file": "/cloudwatch.tf",
        "line": 8,
        "issue": "Ensure CloudWatch log groups retains logs for at least 1 year",
        "severity": "MEDIUM",
        "iso27001_controls": 2,
        "soc2_criteria": 1,
        "total_controls": 3
      },
      {
        "scanner": "bandit",
        "file": "../GP-AI/core/scan_graph_integrator.py",
        "line": 144,
        "issue": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
        "severity": "CRITICAL",
        "iso27001_controls": 1,
        "soc2_criteria": 1,
        "total_controls": 2
      },
      {
        "scanner": "bandit",
        "file": "../GP-AI/core/scan_graph_integrator.py",
        "line": 176,
        "issue": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
        "severity": "CRITICAL",
        "iso27001_controls": 1,
        "soc2_criteria": 1,
        "total_controls": 2
      },
      {
        "scanner": "bandit",
        "file": "../GP-AI/core/scan_graph_integrator.py",
        "line": 214,
        "issue": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
        "severity": "CRITICAL",
        "iso27001_controls": 1,
        "soc2_criteria": 1,
        "total_controls": 2
      },
      {
        "scanner": "bandit",
        "file": "../GP-AI/core/scan_graph_integrator.py",
        "line": 246,
        "issue": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
        "severity": "CRITICAL",
        "iso27001_controls": 1,
        "soc2_criteria": 1,
        "total_controls": 2
      },
      {
        "scanner": "bandit",
        "file": "../GP-AI/core/scan_graph_integrator.py",
        "line": 272,
        "issue": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
        "severity": "CRITICAL",
        "iso27001_controls": 1,
        "soc2_criteria": 1,
        "total_controls": 2
      },
      {
        "scanner": "bandit",
        "file": "../GP-DATA/active/scans/scan_manifest.py",
        "line": 145,
        "issue": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
        "severity": "CRITICAL",
        "iso27001_controls": 1,
        "soc2_criteria": 1,
        "total_controls": 2
      },
      {
        "scanner": "bandit",
        "file": "../GP-PLATFORM/model_client/james_mlops_client.py",
        "line": 125,
        "issue": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
        "severity": "CRITICAL",
        "iso27001_controls": 1,
        "soc2_criteria": 1,
        "total_controls": 2
      },
      {
        "scanner": "bandit",
        "file": "../GP-PLATFORM/workflow/work_order_processor.py",
        "line": 223,
        "issue": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
        "severity": "CRITICAL",
        "iso27001_controls": 1,
        "soc2_criteria": 1,
        "total_controls": 2
      },
      {
        "scanner": "checkov",
        "file": "/vpc.tf",
        "line": 19,
        "issue": "Ensure VPC subnets do not assign public IP by default",
        "severity": "MEDIUM",
        "iso27001_controls": 1,
        "soc2_criteria": 1,
        "total_controls": 2
      },
      {
        "scanner": "checkov",
        "file": "/vpc.tf",
        "line": 30,
        "issue": "Ensure VPC subnets do not assign public IP by default",
        "severity": "MEDIUM",
        "iso27001_controls": 1,
        "soc2_criteria": 1,
        "total_controls": 2
      },
      {
        "scanner": "checkov",
        "file": "/vpc.tf",
        "line": 19,
        "issue": "Ensure VPC subnets do not assign public IP by default",
        "severity": "MEDIUM",
        "iso27001_controls": 1,
        "soc2_criteria": 1,
        "total_controls": 2
      },
      {
        "scanner": "checkov",
        "file": "/vpc.tf",
        "line": 30,
        "issue": "Ensure VPC subnets do not assign public IP by default",
        "severity": "MEDIUM",
        "iso27001_controls": 1,
        "soc2_criteria": 1,
        "total_controls": 2
      }
    ]
  },
  "prioritized_roadmap": [
    {
      "priority_score": 100,
      "roi_score": 25.0,
      "scanner": "gitleaks",
      "file": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/.env.example",
      "line": 34,
      "issue": "Generic API Key detected",
      "severity": "CRITICAL",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 5,
      "effort_hours": 4,
      "remediation_guidance": "Move all secrets to vault, use environment variables, implement secret rotation"
    },
    {
      "priority_score": 100,
      "roi_score": 25.0,
      "scanner": "gitleaks",
      "file": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/README.md",
      "line": 112,
      "issue": "Generic API Key detected",
      "severity": "CRITICAL",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 5,
      "effort_hours": 4,
      "remediation_guidance": "Move all secrets to vault, use environment variables, implement secret rotation"
    },
    {
      "priority_score": 100,
      "roi_score": 25.0,
      "scanner": "gitleaks",
      "file": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/README.md",
      "line": 132,
      "issue": "Generic API Key detected",
      "severity": "CRITICAL",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 5,
      "effort_hours": 4,
      "remediation_guidance": "Move all secrets to vault, use environment variables, implement secret rotation"
    },
    {
      "priority_score": 100,
      "roi_score": 25.0,
      "scanner": "gitleaks",
      "file": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/README.md",
      "line": 329,
      "issue": "Generic API Key detected",
      "severity": "CRITICAL",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 5,
      "effort_hours": 4,
      "remediation_guidance": "Move all secrets to vault, use environment variables, implement secret rotation"
    },
    {
      "priority_score": 100,
      "roi_score": 25.0,
      "scanner": "gitleaks",
      "file": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/services/aws.service.js",
      "line": 27,
      "issue": "AWS detected",
      "severity": "CRITICAL",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 5,
      "effort_hours": 4,
      "remediation_guidance": "Move all secrets to vault, use environment variables, implement secret rotation"
    },
    {
      "priority_score": 100,
      "roi_score": 12.5,
      "scanner": "bandit",
      "file": "../GP-AI/cli/jade_chat.py",
      "line": 365,
      "issue": "subprocess call with shell=True identified, security issue.",
      "severity": "CRITICAL",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 5,
      "effort_hours": 8,
      "remediation_guidance": "Use parameterized commands, avoid shell=True, validate all inputs"
    },
    {
      "priority_score": 100,
      "roi_score": 12.5,
      "scanner": "bandit",
      "file": "../GP-AI/cli/jade_chat.py",
      "line": 586,
      "issue": "subprocess call with shell=True identified, security issue.",
      "severity": "CRITICAL",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 5,
      "effort_hours": 8,
      "remediation_guidance": "Use parameterized commands, avoid shell=True, validate all inputs"
    },
    {
      "priority_score": 100,
      "roi_score": 12.5,
      "scanner": "bandit",
      "file": "../GP-PLATFORM/core/james_orchestrator.py",
      "line": 60,
      "issue": "subprocess call with shell=True identified, security issue.",
      "severity": "CRITICAL",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 5,
      "effort_hours": 8,
      "remediation_guidance": "Use parameterized commands, avoid shell=True, validate all inputs"
    },
    {
      "priority_score": 100,
      "roi_score": 12.5,
      "scanner": "bandit",
      "file": "../GP-PLATFORM/core/james_orchestrator.py",
      "line": 121,
      "issue": "subprocess call with shell=True identified, security issue.",
      "severity": "CRITICAL",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 5,
      "effort_hours": 8,
      "remediation_guidance": "Use parameterized commands, avoid shell=True, validate all inputs"
    },
    {
      "priority_score": 100,
      "roi_score": 12.5,
      "scanner": "bandit",
      "file": "../GP-TESTING-VAL/jade_chat_tests.py",
      "line": 29,
      "issue": "subprocess call with shell=True identified, security issue.",
      "severity": "CRITICAL",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 5,
      "effort_hours": 8,
      "remediation_guidance": "Use parameterized commands, avoid shell=True, validate all inputs"
    },
    {
      "priority_score": 100,
      "roi_score": 12.5,
      "scanner": "bandit",
      "file": "../GP-TESTING-VAL/jade_knowledge_tests.py",
      "line": 29,
      "issue": "subprocess call with shell=True identified, security issue.",
      "severity": "CRITICAL",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 5,
      "effort_hours": 8,
      "remediation_guidance": "Use parameterized commands, avoid shell=True, validate all inputs"
    },
    {
      "priority_score": 94,
      "roi_score": 15.67,
      "scanner": "bandit",
      "file": "../GP-AI/core/scan_graph_integrator.py",
      "line": 144,
      "issue": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "severity": "CRITICAL",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 2,
      "effort_hours": 6,
      "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use modern encryption algorithms"
    },
    {
      "priority_score": 94,
      "roi_score": 15.67,
      "scanner": "bandit",
      "file": "../GP-AI/core/scan_graph_integrator.py",
      "line": 176,
      "issue": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "severity": "CRITICAL",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 2,
      "effort_hours": 6,
      "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use modern encryption algorithms"
    },
    {
      "priority_score": 94,
      "roi_score": 15.67,
      "scanner": "bandit",
      "file": "../GP-AI/core/scan_graph_integrator.py",
      "line": 214,
      "issue": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "severity": "CRITICAL",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 2,
      "effort_hours": 6,
      "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use modern encryption algorithms"
    },
    {
      "priority_score": 94,
      "roi_score": 15.67,
      "scanner": "bandit",
      "file": "../GP-AI/core/scan_graph_integrator.py",
      "line": 246,
      "issue": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "severity": "CRITICAL",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 2,
      "effort_hours": 6,
      "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use modern encryption algorithms"
    },
    {
      "priority_score": 94,
      "roi_score": 15.67,
      "scanner": "bandit",
      "file": "../GP-AI/core/scan_graph_integrator.py",
      "line": 272,
      "issue": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "severity": "CRITICAL",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 2,
      "effort_hours": 6,
      "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use modern encryption algorithms"
    },
    {
      "priority_score": 94,
      "roi_score": 15.67,
      "scanner": "bandit",
      "file": "../GP-DATA/active/scans/scan_manifest.py",
      "line": 145,
      "issue": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "severity": "CRITICAL",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 2,
      "effort_hours": 6,
      "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use modern encryption algorithms"
    },
    {
      "priority_score": 94,
      "roi_score": 15.67,
      "scanner": "bandit",
      "file": "../GP-PLATFORM/model_client/james_mlops_client.py",
      "line": 125,
      "issue": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "severity": "CRITICAL",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 2,
      "effort_hours": 6,
      "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use modern encryption algorithms"
    },
    {
      "priority_score": 94,
      "roi_score": 15.67,
      "scanner": "bandit",
      "file": "../GP-PLATFORM/workflow/work_order_processor.py",
      "line": 223,
      "issue": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "severity": "CRITICAL",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 2,
      "effort_hours": 6,
      "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use modern encryption algorithms"
    },
    {
      "priority_score": 90,
      "roi_score": 11.25,
      "scanner": "bandit",
      "file": "../GP-PROJECTS/kubernetes-goat/infrastructure/info-app/app.py",
      "line": 11,
      "issue": "A Flask app appears to be run with debug=True, which exposes the Werkzeug debugger and allows the execution of arbitrary code.",
      "severity": "HIGH",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 5,
      "effort_hours": 8,
      "remediation_guidance": "Use parameterized commands, avoid shell=True, validate all inputs"
    },
    {
      "priority_score": 90,
      "roi_score": 11.25,
      "scanner": "bandit",
      "file": "../GP-RAG/jade_api.py",
      "line": 331,
      "issue": "A Flask app appears to be run with debug=True, which exposes the Werkzeug debugger and allows the execution of arbitrary code.",
      "severity": "HIGH",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 5,
      "effort_hours": 8,
      "remediation_guidance": "Use parameterized commands, avoid shell=True, validate all inputs"
    },
    {
      "priority_score": 78,
      "roi_score": 9.75,
      "scanner": "bandit",
      "file": "../GP-AI/core/rag_graph_engine.py",
      "line": 518,
      "issue": "Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.",
      "severity": "MEDIUM",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 4,
      "effort_hours": 8,
      "remediation_guidance": "Avoid pickle with untrusted data, use JSON, validate deserialized objects"
    },
    {
      "priority_score": 78,
      "roi_score": 9.75,
      "scanner": "bandit",
      "file": "../GP-RAG/graph_ingest_knowledge.py",
      "line": 56,
      "issue": "Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.",
      "severity": "MEDIUM",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 4,
      "effort_hours": 8,
      "remediation_guidance": "Avoid pickle with untrusted data, use JSON, validate deserialized objects"
    },
    {
      "priority_score": 78,
      "roi_score": 9.75,
      "scanner": "bandit",
      "file": "../GP-RAG/ingest_scan_results.py",
      "line": 64,
      "issue": "Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.",
      "severity": "MEDIUM",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 4,
      "effort_hours": 8,
      "remediation_guidance": "Avoid pickle with untrusted data, use JSON, validate deserialized objects"
    },
    {
      "priority_score": 76,
      "roi_score": 76.0,
      "scanner": "checkov",
      "file": "/cloudwatch.tf",
      "line": 8,
      "issue": "Ensure CloudWatch log groups retains logs for at least 1 year",
      "severity": "MEDIUM",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 3,
      "effort_hours": 1,
      "remediation_guidance": null
    },
    {
      "priority_score": 76,
      "roi_score": 76.0,
      "scanner": "checkov",
      "file": "/cloudwatch.tf",
      "line": 8,
      "issue": "Ensure CloudWatch log groups retains logs for at least 1 year",
      "severity": "MEDIUM",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 3,
      "effort_hours": 1,
      "remediation_guidance": null
    },
    {
      "priority_score": 74,
      "roi_score": 37.0,
      "scanner": "checkov",
      "file": "/vpc.tf",
      "line": 19,
      "issue": "Ensure VPC subnets do not assign public IP by default",
      "severity": "MEDIUM",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 2,
      "effort_hours": 2,
      "remediation_guidance": null
    },
    {
      "priority_score": 74,
      "roi_score": 37.0,
      "scanner": "checkov",
      "file": "/vpc.tf",
      "line": 30,
      "issue": "Ensure VPC subnets do not assign public IP by default",
      "severity": "MEDIUM",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 2,
      "effort_hours": 2,
      "remediation_guidance": null
    },
    {
      "priority_score": 74,
      "roi_score": 37.0,
      "scanner": "checkov",
      "file": "/vpc.tf",
      "line": 19,
      "issue": "Ensure VPC subnets do not assign public IP by default",
      "severity": "MEDIUM",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 2,
      "effort_hours": 2,
      "remediation_guidance": null
    },
    {
      "priority_score": 74,
      "roi_score": 37.0,
      "scanner": "checkov",
      "file": "/vpc.tf",
      "line": 30,
      "issue": "Ensure VPC subnets do not assign public IP by default",
      "severity": "MEDIUM",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 2,
      "effort_hours": 2,
      "remediation_guidance": null
    },
    {
      "priority_score": 66,
      "roi_score": 16.5,
      "scanner": "semgrep",
      "file": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/server.js",
      "line": 13,
      "issue": "Express Check Csurf Middleware Usage",
      "severity": "LOW",
      "cross_framework": true,
      "frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "controls_affected": 3,
      "effort_hours": 4,
      "remediation_guidance": "Implement CSRF tokens, set SameSite=Strict on cookies"
    }
  ],
  "detailed_findings": [
    {
      "id": "semgrep_1",
      "scanner": "semgrep",
      "rule_id": "javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage",
      "title": "Express Check Csurf Middleware Usage",
      "message": "A CSRF middleware was not detected in your express application. Ensure you are either using one such as `csurf` or `csrf` (see rule references) and/or you are properly doing CSRF validation in your routes with a token or cookies.",
      "severity": "LOW",
      "confidence": "LOW",
      "file": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/server.js",
      "line": 13,
      "end_line": 13,
      "column": 7,
      "category": "security",
      "owasp": [
        "A01:2021 - Broken Access Control"
      ],
      "cwe": [
        "CWE-352"
      ],
      "scan_timestamp": "20251010_120814",
      "_original": {
        "check_id": "javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage",
        "end": {
          "col": 22,
          "line": 13,
          "offset": 528
        },
        "extra": {
          "engine_kind": "OSS",
          "fingerprint": "d6c698b144a711273d483e8d84e9f9b91e6b5849b16a22405f33ec13a7165b433109bd31f1c2945da3cbfcf8416577ddc6e68e65740e379d2d91ed286de38cc7_0",
          "is_ignored": false,
          "lines": "const app = express();",
          "message": "A CSRF middleware was not detected in your express application. Ensure you are either using one such as `csurf` or `csrf` (see rule references) and/or you are properly doing CSRF validation in your routes with a token or cookies.",
          "metadata": {
            "category": "security",
            "confidence": "LOW",
            "cwe": [
              "CWE-352: Cross-Site Request Forgery (CSRF)"
            ],
            "cwe2021-top25": true,
            "cwe2022-top25": true,
            "impact": "HIGH",
            "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license",
            "likelihood": "LOW",
            "owasp": [
              "A01:2021 - Broken Access Control"
            ],
            "references": [
              "https://www.npmjs.com/package/csurf",
              "https://www.npmjs.com/package/csrf",
              "https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html"
            ],
            "semgrep.dev": {
              "rule": {
                "origin": "community",
                "r_id": 22551,
                "rule_id": "wdUKEq",
                "rv_id": 945789,
                "url": "https://semgrep.dev/playground/r/NdTqkvB/javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage",
                "version_id": "NdTqkvB"
              }
            },
            "shortlink": "https://sg.run/BxzR",
            "source": "https://semgrep.dev/r/javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage",
            "subcategory": [
              "audit"
            ],
            "technology": [
              "javascript",
              "typescript",
              "express"
            ],
            "vulnerability_class": [
              "Cross-Site Request Forgery (CSRF)"
            ]
          },
          "metavars": {
            "$APP": {
              "abstract_content": "app",
              "end": {
                "col": 10,
                "line": 13,
                "offset": 516
              },
              "start": {
                "col": 7,
                "line": 13,
                "offset": 513
              }
            },
            "$EXPRESS": {
              "abstract_content": "express",
              "end": {
                "col": 20,
                "line": 13,
                "offset": 526
              },
              "start": {
                "col": 13,
                "line": 13,
                "offset": 519
              }
            }
          },
          "severity": "INFO",
          "validation_state": "NO_VALIDATOR"
        },
        "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/server.js",
        "start": {
          "col": 7,
          "line": 13,
          "offset": 513
        }
      },
      "iso27001_compliance": {
        "controls": [
          "A.14.2.1"
        ],
        "control_name": "Secure development policy",
        "domain": "A.14 - System Acquisition, Development and Maintenance",
        "description": "CSRF vulnerabilities from missing token validation",
        "audit_evidence": [
          "CSRF tokens implemented in all state-changing operations",
          "SameSite cookie attribute configured",
          "Framework CSRF protection enabled (Flask-WTF, Django, Express)",
          "Session management security review documentation"
        ],
        "remediation_priority": "MEDIUM",
        "estimated_effort_hours": 4,
        "remediation_guidance": "Implement CSRF tokens, set SameSite=Strict on cookies"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1",
          "CC7.2"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls",
          "CC7.2 - System Monitoring - Security Events"
        ],
        "trust_service_category": "Security",
        "description": "CSRF vulnerabilities allow unauthorized state changes",
        "control_objective": "The entity prevents cross-site request forgery attacks",
        "audit_evidence": [
          "CSRF token implementation in all state-changing operations",
          "SameSite cookie attribute configuration",
          "Framework CSRF protection enabled",
          "Session management security documentation"
        ],
        "remediation_priority": "MEDIUM",
        "estimated_effort_hours": 4,
        "remediation_guidance": "Implement CSRF tokens, configure SameSite=Strict on cookies"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 3,
      "cross_framework_impact": true
    },
    {
      "id": "gitleaks_1",
      "scanner": "gitleaks",
      "secret_type": "generic-api-key",
      "description": "Generic API Key",
      "title": "Generic API Key detected",
      "severity": "CRITICAL",
      "cwe": [
        "CWE-798"
      ],
      "file": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/.env.example",
      "line": 34,
      "column": 13,
      "end_line": 35,
      "secret_masked": "0123************************cdef",
      "match": "KEY=0123456789abcdef0123456789abcdef",
      "commit": "",
      "author": "",
      "date": "",
      "entropy": 4,
      "scan_timestamp": "20251010_121033",
      "_original": {
        "Description": "Generic API Key",
        "StartLine": 34,
        "EndLine": 35,
        "StartColumn": 13,
        "EndColumn": 1,
        "Match": "KEY=0123456789abcdef0123456789abcdef",
        "File": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/.env.example",
        "SymlinkFile": "",
        "Commit": "",
        "Entropy": 4,
        "Author": "",
        "Email": "",
        "Date": "",
        "Message": "",
        "Tags": [],
        "RuleID": "generic-api-key",
        "Fingerprint": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/.env.example:generic-api-key:34"
      },
      "iso27001_compliance": {
        "controls": [
          "A.9.4.3",
          "A.8.3.1"
        ],
        "control_name": "Password management system / Management of removable media",
        "domain": "A.9 - Access Control, A.8 - Asset Management",
        "description": "Hardcoded credentials violate secrets management policy",
        "audit_evidence": [
          "No hardcoded credentials in code (Gitleaks scan clean)",
          "All secrets stored in AWS Secrets Manager/HashiCorp Vault/Azure Key Vault",
          "Code review logs checking for hardcoded secrets",
          "Documented secrets management policy",
          "Access logs for secrets management system"
        ],
        "remediation_priority": "CRITICAL",
        "estimated_effort_hours": 4,
        "remediation_guidance": "Move all secrets to vault, use environment variables, implement secret rotation"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1",
          "CC6.6",
          "CC6.7"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls",
          "CC6.6 - Logical Access - Authentication",
          "CC6.7 - Logical Access - Authorization"
        ],
        "trust_service_category": "Security",
        "description": "Hardcoded credentials violate authentication and secrets management controls",
        "control_objective": "The entity requires unique identification and strong authentication for system access",
        "audit_evidence": [
          "Secrets management solution implementation (AWS Secrets Manager, Vault)",
          "Gitleaks scan results showing no hardcoded credentials",
          "Secret rotation policies and logs",
          "Access control matrix for secret access",
          "Code review logs checking for hardcoded secrets"
        ],
        "remediation_priority": "CRITICAL",
        "estimated_effort_hours": 4,
        "remediation_guidance": "Migrate all secrets to vault, implement rotation, remove hardcoded credentials"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 5,
      "cross_framework_impact": true
    },
    {
      "id": "gitleaks_2",
      "scanner": "gitleaks",
      "secret_type": "generic-api-key",
      "description": "Generic API Key",
      "title": "Generic API Key detected",
      "severity": "CRITICAL",
      "cwe": [
        "CWE-798"
      ],
      "file": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/README.md",
      "line": 112,
      "column": 5,
      "end_line": 112,
      "secret_masked": "sk_l*********3...",
      "match": "api_key\": \"sk_live_abc123...\"",
      "commit": "",
      "author": "",
      "date": "",
      "entropy": 3.6901164,
      "scan_timestamp": "20251010_121033",
      "_original": {
        "Description": "Generic API Key",
        "StartLine": 112,
        "EndLine": 112,
        "StartColumn": 5,
        "EndColumn": 33,
        "Match": "api_key\": \"sk_live_abc123...\"",
        "File": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/README.md",
        "SymlinkFile": "",
        "Commit": "",
        "Entropy": 3.6901164,
        "Author": "",
        "Email": "",
        "Date": "",
        "Message": "",
        "Tags": [],
        "RuleID": "generic-api-key",
        "Fingerprint": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/README.md:generic-api-key:112"
      },
      "iso27001_compliance": {
        "controls": [
          "A.9.4.3",
          "A.8.3.1"
        ],
        "control_name": "Password management system / Management of removable media",
        "domain": "A.9 - Access Control, A.8 - Asset Management",
        "description": "Hardcoded credentials violate secrets management policy",
        "audit_evidence": [
          "No hardcoded credentials in code (Gitleaks scan clean)",
          "All secrets stored in AWS Secrets Manager/HashiCorp Vault/Azure Key Vault",
          "Code review logs checking for hardcoded secrets",
          "Documented secrets management policy",
          "Access logs for secrets management system"
        ],
        "remediation_priority": "CRITICAL",
        "estimated_effort_hours": 4,
        "remediation_guidance": "Move all secrets to vault, use environment variables, implement secret rotation"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1",
          "CC6.6",
          "CC6.7"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls",
          "CC6.6 - Logical Access - Authentication",
          "CC6.7 - Logical Access - Authorization"
        ],
        "trust_service_category": "Security",
        "description": "Hardcoded credentials violate authentication and secrets management controls",
        "control_objective": "The entity requires unique identification and strong authentication for system access",
        "audit_evidence": [
          "Secrets management solution implementation (AWS Secrets Manager, Vault)",
          "Gitleaks scan results showing no hardcoded credentials",
          "Secret rotation policies and logs",
          "Access control matrix for secret access",
          "Code review logs checking for hardcoded secrets"
        ],
        "remediation_priority": "CRITICAL",
        "estimated_effort_hours": 4,
        "remediation_guidance": "Migrate all secrets to vault, implement rotation, remove hardcoded credentials"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 5,
      "cross_framework_impact": true
    },
    {
      "id": "gitleaks_3",
      "scanner": "gitleaks",
      "secret_type": "generic-api-key",
      "description": "Generic API Key",
      "title": "Generic API Key detected",
      "severity": "CRITICAL",
      "cwe": [
        "CWE-798"
      ],
      "file": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/README.md",
      "line": 132,
      "column": 5,
      "end_line": 132,
      "secret_masked": "eyJh*******************************9...",
      "match": "token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\"",
      "commit": "",
      "author": "",
      "date": "",
      "entropy": 4.419391,
      "scan_timestamp": "20251010_121033",
      "_original": {
        "Description": "Generic API Key",
        "StartLine": 132,
        "EndLine": 132,
        "StartColumn": 5,
        "EndColumn": 53,
        "Match": "token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\"",
        "File": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/README.md",
        "SymlinkFile": "",
        "Commit": "",
        "Entropy": 4.419391,
        "Author": "",
        "Email": "",
        "Date": "",
        "Message": "",
        "Tags": [],
        "RuleID": "generic-api-key",
        "Fingerprint": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/README.md:generic-api-key:132"
      },
      "iso27001_compliance": {
        "controls": [
          "A.9.4.3",
          "A.8.3.1"
        ],
        "control_name": "Password management system / Management of removable media",
        "domain": "A.9 - Access Control, A.8 - Asset Management",
        "description": "Hardcoded credentials violate secrets management policy",
        "audit_evidence": [
          "No hardcoded credentials in code (Gitleaks scan clean)",
          "All secrets stored in AWS Secrets Manager/HashiCorp Vault/Azure Key Vault",
          "Code review logs checking for hardcoded secrets",
          "Documented secrets management policy",
          "Access logs for secrets management system"
        ],
        "remediation_priority": "CRITICAL",
        "estimated_effort_hours": 4,
        "remediation_guidance": "Move all secrets to vault, use environment variables, implement secret rotation"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1",
          "CC6.6",
          "CC6.7"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls",
          "CC6.6 - Logical Access - Authentication",
          "CC6.7 - Logical Access - Authorization"
        ],
        "trust_service_category": "Security",
        "description": "Hardcoded credentials violate authentication and secrets management controls",
        "control_objective": "The entity requires unique identification and strong authentication for system access",
        "audit_evidence": [
          "Secrets management solution implementation (AWS Secrets Manager, Vault)",
          "Gitleaks scan results showing no hardcoded credentials",
          "Secret rotation policies and logs",
          "Access control matrix for secret access",
          "Code review logs checking for hardcoded secrets"
        ],
        "remediation_priority": "CRITICAL",
        "estimated_effort_hours": 4,
        "remediation_guidance": "Migrate all secrets to vault, implement rotation, remove hardcoded credentials"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 5,
      "cross_framework_impact": true
    },
    {
      "id": "gitleaks_4",
      "scanner": "gitleaks",
      "secret_type": "generic-api-key",
      "description": "Generic API Key",
      "title": "Generic API Key detected",
      "severity": "CRITICAL",
      "cwe": [
        "CWE-798"
      ],
      "file": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/README.md",
      "line": 329,
      "column": 13,
      "end_line": 330,
      "secret_masked": "0123************************cdef",
      "match": "KEY=0123456789abcdef0123456789abcdef",
      "commit": "",
      "author": "",
      "date": "",
      "entropy": 4,
      "scan_timestamp": "20251010_121033",
      "_original": {
        "Description": "Generic API Key",
        "StartLine": 329,
        "EndLine": 330,
        "StartColumn": 13,
        "EndColumn": 1,
        "Match": "KEY=0123456789abcdef0123456789abcdef",
        "File": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/README.md",
        "SymlinkFile": "",
        "Commit": "",
        "Entropy": 4,
        "Author": "",
        "Email": "",
        "Date": "",
        "Message": "",
        "Tags": [],
        "RuleID": "generic-api-key",
        "Fingerprint": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/README.md:generic-api-key:329"
      },
      "iso27001_compliance": {
        "controls": [
          "A.9.4.3",
          "A.8.3.1"
        ],
        "control_name": "Password management system / Management of removable media",
        "domain": "A.9 - Access Control, A.8 - Asset Management",
        "description": "Hardcoded credentials violate secrets management policy",
        "audit_evidence": [
          "No hardcoded credentials in code (Gitleaks scan clean)",
          "All secrets stored in AWS Secrets Manager/HashiCorp Vault/Azure Key Vault",
          "Code review logs checking for hardcoded secrets",
          "Documented secrets management policy",
          "Access logs for secrets management system"
        ],
        "remediation_priority": "CRITICAL",
        "estimated_effort_hours": 4,
        "remediation_guidance": "Move all secrets to vault, use environment variables, implement secret rotation"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1",
          "CC6.6",
          "CC6.7"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls",
          "CC6.6 - Logical Access - Authentication",
          "CC6.7 - Logical Access - Authorization"
        ],
        "trust_service_category": "Security",
        "description": "Hardcoded credentials violate authentication and secrets management controls",
        "control_objective": "The entity requires unique identification and strong authentication for system access",
        "audit_evidence": [
          "Secrets management solution implementation (AWS Secrets Manager, Vault)",
          "Gitleaks scan results showing no hardcoded credentials",
          "Secret rotation policies and logs",
          "Access control matrix for secret access",
          "Code review logs checking for hardcoded secrets"
        ],
        "remediation_priority": "CRITICAL",
        "estimated_effort_hours": 4,
        "remediation_guidance": "Migrate all secrets to vault, implement rotation, remove hardcoded credentials"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 5,
      "cross_framework_impact": true
    },
    {
      "id": "gitleaks_5",
      "scanner": "gitleaks",
      "secret_type": "aws-access-token",
      "description": "AWS",
      "title": "AWS detected",
      "severity": "CRITICAL",
      "cwe": [
        "CWE-798"
      ],
      "file": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/services/aws.service.js",
      "line": 27,
      "column": 53,
      "end_line": 27,
      "secret_masked": "AKIA************MPLE",
      "match": "AKIAIOSFODNN7EXAMPLE",
      "commit": "",
      "author": "",
      "date": "",
      "entropy": 3.6841838,
      "scan_timestamp": "20251010_121033",
      "_original": {
        "Description": "AWS",
        "StartLine": 27,
        "EndLine": 27,
        "StartColumn": 53,
        "EndColumn": 72,
        "Match": "AKIAIOSFODNN7EXAMPLE",
        "File": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/services/aws.service.js",
        "SymlinkFile": "",
        "Commit": "",
        "Entropy": 3.6841838,
        "Author": "",
        "Email": "",
        "Date": "",
        "Message": "",
        "Tags": [],
        "RuleID": "aws-access-token",
        "Fingerprint": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/backend/services/aws.service.js:aws-access-token:27"
      },
      "iso27001_compliance": {
        "controls": [
          "A.9.4.3",
          "A.8.3.1"
        ],
        "control_name": "Password management system / Management of removable media",
        "domain": "A.9 - Access Control, A.8 - Asset Management",
        "description": "Hardcoded credentials violate secrets management policy",
        "audit_evidence": [
          "No hardcoded credentials in code (Gitleaks scan clean)",
          "All secrets stored in AWS Secrets Manager/HashiCorp Vault/Azure Key Vault",
          "Code review logs checking for hardcoded secrets",
          "Documented secrets management policy",
          "Access logs for secrets management system"
        ],
        "remediation_priority": "CRITICAL",
        "estimated_effort_hours": 4,
        "remediation_guidance": "Move all secrets to vault, use environment variables, implement secret rotation"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1",
          "CC6.6",
          "CC6.7"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls",
          "CC6.6 - Logical Access - Authentication",
          "CC6.7 - Logical Access - Authorization"
        ],
        "trust_service_category": "Security",
        "description": "Hardcoded credentials violate authentication and secrets management controls",
        "control_objective": "The entity requires unique identification and strong authentication for system access",
        "audit_evidence": [
          "Secrets management solution implementation (AWS Secrets Manager, Vault)",
          "Gitleaks scan results showing no hardcoded credentials",
          "Secret rotation policies and logs",
          "Access control matrix for secret access",
          "Code review logs checking for hardcoded secrets"
        ],
        "remediation_priority": "CRITICAL",
        "estimated_effort_hours": 4,
        "remediation_guidance": "Migrate all secrets to vault, implement rotation, remove hardcoded credentials"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 5,
      "cross_framework_impact": true
    },
    {
      "id": "bandit_1",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Possible binding to all interfaces.",
      "description": "Possible binding to all interfaces.",
      "file": "./fixers/bandit_fixer.py",
      "line": 397,
      "code": "396             # Replace 0.0.0.0 with 127.0.0.1 or use environment variable\n397             if '0.0.0.0' in line:\n398                 # Add import for os if not present",
      "test_id": "B104",
      "test_name": "hardcoded_bind_all_interfaces",
      "cwe": [],
      "scan_timestamp": "20251010_125345",
      "file_hash": "ef7c90d19ef0a04d",
      "_original": {
        "code": "396             # Replace 0.0.0.0 with 127.0.0.1 or use environment variable\n397             if '0.0.0.0' in line:\n398                 # Add import for os if not present\n",
        "col_offset": 15,
        "end_col_offset": 24,
        "filename": "./fixers/bandit_fixer.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 605,
          "link": "https://cwe.mitre.org/data/definitions/605.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Possible binding to all interfaces.",
        "line_number": 397,
        "line_range": [
          397
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html",
        "test_id": "B104",
        "test_name": "hardcoded_bind_all_interfaces"
      }
    },
    {
      "id": "bandit_2",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Probable insecure usage of temp file/directory.",
      "description": "Probable insecure usage of temp file/directory.",
      "file": "./fixers/bandit_fixer.py",
      "line": 428,
      "code": "427             # Replace hardcoded temp path with secure tempfile\n428             if '/tmp/' in line:\n429                 # Extract variable name",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory",
      "cwe": [],
      "scan_timestamp": "20251010_125345",
      "file_hash": "ef7c90d19ef0a04d",
      "_original": {
        "code": "427             # Replace hardcoded temp path with secure tempfile\n428             if '/tmp/' in line:\n429                 # Extract variable name\n",
        "col_offset": 15,
        "end_col_offset": 22,
        "filename": "./fixers/bandit_fixer.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 377,
          "link": "https://cwe.mitre.org/data/definitions/377.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Probable insecure usage of temp file/directory.",
        "line_number": 428,
        "line_range": [
          428
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html",
        "test_id": "B108",
        "test_name": "hardcoded_tmp_directory"
      }
    },
    {
      "id": "bandit_3",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Probable insecure usage of temp file/directory.",
      "description": "Probable insecure usage of temp file/directory.",
      "file": "./fixers/gatekeeper_fixer.py",
      "line": 261,
      "code": "260                     # Add common writable directories\n261                     writable_dirs = ['/tmp', '/var/cache', '/var/run']\n262                     for dir_path in writable_dirs:",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory",
      "cwe": [],
      "scan_timestamp": "20251010_125345",
      "file_hash": "bea26a72cec9ea41",
      "_original": {
        "code": "260                     # Add common writable directories\n261                     writable_dirs = ['/tmp', '/var/cache', '/var/run']\n262                     for dir_path in writable_dirs:\n",
        "col_offset": 37,
        "end_col_offset": 43,
        "filename": "./fixers/gatekeeper_fixer.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 377,
          "link": "https://cwe.mitre.org/data/definitions/377.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Probable insecure usage of temp file/directory.",
        "line_number": 261,
        "line_range": [
          261
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html",
        "test_id": "B108",
        "test_name": "hardcoded_tmp_directory"
      }
    },
    {
      "id": "bandit_4",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Probable insecure usage of temp file/directory.",
      "description": "Probable insecure usage of temp file/directory.",
      "file": "./policy-framework/2-AUTOMATION/agents/patch_rollout_agent.py",
      "line": 92,
      "code": "91         # Write modified constraint to temp file\n92         temp_file = Path(f\"/tmp/{constraint_file.stem}_{enforcement_action}.yaml\")\n93         temp_file.write_text(yaml.dump(constraint))",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory",
      "cwe": [],
      "scan_timestamp": "20251010_125345",
      "file_hash": "e7c160a0c661bd26",
      "_original": {
        "code": "91         # Write modified constraint to temp file\n92         temp_file = Path(f\"/tmp/{constraint_file.stem}_{enforcement_action}.yaml\")\n93         temp_file.write_text(yaml.dump(constraint))\n",
        "col_offset": 25,
        "end_col_offset": 81,
        "filename": "./policy-framework/2-AUTOMATION/agents/patch_rollout_agent.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 377,
          "link": "https://cwe.mitre.org/data/definitions/377.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Probable insecure usage of temp file/directory.",
        "line_number": 92,
        "line_range": [
          92
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html",
        "test_id": "B108",
        "test_name": "hardcoded_tmp_directory"
      }
    },
    {
      "id": "bandit_5",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Probable insecure usage of temp file/directory.",
      "description": "Probable insecure usage of temp file/directory.",
      "file": "./policy-framework/2-AUTOMATION/agents/patch_rollout_agent.py",
      "line": 202,
      "code": "201         import yaml\n202         temp_file = Path(\"/tmp/gatekeeper_mutation.yaml\")\n203         temp_file.write_text(yaml.dump(mutation_policy))",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory",
      "cwe": [],
      "scan_timestamp": "20251010_125345",
      "file_hash": "e7c160a0c661bd26",
      "_original": {
        "code": "201         import yaml\n202         temp_file = Path(\"/tmp/gatekeeper_mutation.yaml\")\n203         temp_file.write_text(yaml.dump(mutation_policy))\n",
        "col_offset": 25,
        "end_col_offset": 56,
        "filename": "./policy-framework/2-AUTOMATION/agents/patch_rollout_agent.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 377,
          "link": "https://cwe.mitre.org/data/definitions/377.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Probable insecure usage of temp file/directory.",
        "line_number": 202,
        "line_range": [
          202
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html",
        "test_id": "B108",
        "test_name": "hardcoded_tmp_directory"
      }
    },
    {
      "id": "bandit_6",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Possible binding to all interfaces.",
      "description": "Possible binding to all interfaces.",
      "file": "./policy-framework/2-AUTOMATION/fixers/opa_fixer.py",
      "line": 446,
      "code": "445             return 'rds_encryption'\n446         elif 'public' in policy_lower and ('access' in policy_lower or '0.0.0.0' in policy_lower):\n447             return 'tf_deny_public_access'",
      "test_id": "B104",
      "test_name": "hardcoded_bind_all_interfaces",
      "cwe": [],
      "scan_timestamp": "20251010_125345",
      "file_hash": "fe4da43fd8878324",
      "_original": {
        "code": "445             return 'rds_encryption'\n446         elif 'public' in policy_lower and ('access' in policy_lower or '0.0.0.0' in policy_lower):\n447             return 'tf_deny_public_access'\n",
        "col_offset": 71,
        "end_col_offset": 80,
        "filename": "./policy-framework/2-AUTOMATION/fixers/opa_fixer.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 605,
          "link": "https://cwe.mitre.org/data/definitions/605.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Possible binding to all interfaces.",
        "line_number": 446,
        "line_range": [
          446
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html",
        "test_id": "B104",
        "test_name": "hardcoded_bind_all_interfaces"
      }
    },
    {
      "id": "bandit_7",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Probable insecure usage of temp file/directory.",
      "description": "Probable insecure usage of temp file/directory.",
      "file": "./policy-framework/2-AUTOMATION/orchestrators/opa_cluster_manager.py",
      "line": 192,
      "code": "191 \n192         test_file = Path(\"/tmp/test-violation.yaml\")\n193         with open(test_file, 'w') as f:",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory",
      "cwe": [],
      "scan_timestamp": "20251010_125345",
      "file_hash": "22235ccde96d2607",
      "_original": {
        "code": "191 \n192         test_file = Path(\"/tmp/test-violation.yaml\")\n193         with open(test_file, 'w') as f:\n",
        "col_offset": 25,
        "end_col_offset": 51,
        "filename": "./policy-framework/2-AUTOMATION/orchestrators/opa_cluster_manager.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 377,
          "link": "https://cwe.mitre.org/data/definitions/377.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Probable insecure usage of temp file/directory.",
        "line_number": 192,
        "line_range": [
          192
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html",
        "test_id": "B108",
        "test_name": "hardcoded_tmp_directory"
      }
    },
    {
      "id": "bandit_8",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "LOW",
      "title": "Call to requests without timeout",
      "description": "Call to requests without timeout",
      "file": "./scanners/example_scanner_with_secrets.py",
      "line": 55,
      "code": "54         try:\n55             response = requests.get(repo_url, headers=headers)\n56             logger.info(f\"GitHub API call successful: {response.status_code}\")",
      "test_id": "B113",
      "test_name": "request_without_timeout",
      "cwe": [],
      "scan_timestamp": "20251010_125345",
      "file_hash": "f49a547258fa71a8",
      "_original": {
        "code": "54         try:\n55             response = requests.get(repo_url, headers=headers)\n56             logger.info(f\"GitHub API call successful: {response.status_code}\")\n",
        "col_offset": 23,
        "end_col_offset": 62,
        "filename": "./scanners/example_scanner_with_secrets.py",
        "issue_confidence": "LOW",
        "issue_cwe": {
          "id": 400,
          "link": "https://cwe.mitre.org/data/definitions/400.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Call to requests without timeout",
        "line_number": 55,
        "line_range": [
          55
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html",
        "test_id": "B113",
        "test_name": "request_without_timeout"
      }
    },
    {
      "id": "bandit_9",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Possible binding to all interfaces.",
      "description": "Possible binding to all interfaces.",
      "file": "./secops-framework/4-mutators/webhook-server/mutating-webhook.py",
      "line": 221,
      "code": "220         logger.info(\"Starting webhook server with TLS\")\n221         app.run(host='0.0.0.0', port=8443, ssl_context=(cert_file, key_file))\n222     else:",
      "test_id": "B104",
      "test_name": "hardcoded_bind_all_interfaces",
      "cwe": [],
      "scan_timestamp": "20251010_125345",
      "file_hash": "3cd94a73a96c0183",
      "_original": {
        "code": "220         logger.info(\"Starting webhook server with TLS\")\n221         app.run(host='0.0.0.0', port=8443, ssl_context=(cert_file, key_file))\n222     else:\n",
        "col_offset": 21,
        "end_col_offset": 30,
        "filename": "./secops-framework/4-mutators/webhook-server/mutating-webhook.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 605,
          "link": "https://cwe.mitre.org/data/definitions/605.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Possible binding to all interfaces.",
        "line_number": 221,
        "line_range": [
          221
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html",
        "test_id": "B104",
        "test_name": "hardcoded_bind_all_interfaces"
      }
    },
    {
      "id": "bandit_10",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Possible binding to all interfaces.",
      "description": "Possible binding to all interfaces.",
      "file": "./secops-framework/4-mutators/webhook-server/mutating-webhook.py",
      "line": 224,
      "code": "223         logger.warning(\"TLS certificates not found. Running without TLS (DEV ONLY)\")\n224         app.run(host='0.0.0.0', port=8080)",
      "test_id": "B104",
      "test_name": "hardcoded_bind_all_interfaces",
      "cwe": [],
      "scan_timestamp": "20251010_125345",
      "file_hash": "3cd94a73a96c0183",
      "_original": {
        "code": "223         logger.warning(\"TLS certificates not found. Running without TLS (DEV ONLY)\")\n224         app.run(host='0.0.0.0', port=8080)\n",
        "col_offset": 21,
        "end_col_offset": 30,
        "filename": "./secops-framework/4-mutators/webhook-server/mutating-webhook.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 605,
          "link": "https://cwe.mitre.org/data/definitions/605.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Possible binding to all interfaces.",
        "line_number": 224,
        "line_range": [
          224
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html",
        "test_id": "B104",
        "test_name": "hardcoded_bind_all_interfaces"
      }
    },
    {
      "id": "bandit_1",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Possible binding to all interfaces.",
      "description": "Possible binding to all interfaces.",
      "file": "../GP-AI/api/main.py",
      "line": 275,
      "code": "274     import uvicorn\n275     uvicorn.run(app, host=\"0.0.0.0\", port=8000)",
      "test_id": "B104",
      "test_name": "hardcoded_bind_all_interfaces",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "da71699a5a111936",
      "_original": {
        "code": "274     import uvicorn\n275     uvicorn.run(app, host=\"0.0.0.0\", port=8000)\n",
        "col_offset": 26,
        "end_col_offset": 35,
        "filename": "../GP-AI/api/main.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 605,
          "link": "https://cwe.mitre.org/data/definitions/605.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Possible binding to all interfaces.",
        "line_number": 275,
        "line_range": [
          275
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html",
        "test_id": "B104",
        "test_name": "hardcoded_bind_all_interfaces"
      }
    },
    {
      "id": "bandit_2",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Probable insecure usage of temp file/directory.",
      "description": "Probable insecure usage of temp file/directory.",
      "file": "../GP-AI/cli/gha_analyzer.py",
      "line": 74,
      "code": "73                     # Download artifact to temp directory\n74                     download_dir = Path(\"/tmp\") / f\"gha-{run_id}-{artifact_name}\"\n75",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "77f7ea1b99d93ab4",
      "_original": {
        "code": "73                     # Download artifact to temp directory\n74                     download_dir = Path(\"/tmp\") / f\"gha-{run_id}-{artifact_name}\"\n75 \n",
        "col_offset": 40,
        "end_col_offset": 46,
        "filename": "../GP-AI/cli/gha_analyzer.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 377,
          "link": "https://cwe.mitre.org/data/definitions/377.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Probable insecure usage of temp file/directory.",
        "line_number": 74,
        "line_range": [
          74
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html",
        "test_id": "B108",
        "test_name": "hardcoded_tmp_directory"
      }
    },
    {
      "id": "bandit_3",
      "scanner": "bandit",
      "severity": "CRITICAL",
      "confidence": "HIGH",
      "title": "subprocess call with shell=True identified, security issue.",
      "description": "subprocess call with shell=True identified, security issue.",
      "file": "../GP-AI/cli/jade_chat.py",
      "line": 365,
      "code": "364                 command,\n365                 shell=True,\n366                 cwd=str(self.gp_copilot_root),\n367                 capture_output=True,\n368                 text=True,\n369                 timeout=300\n370             )\n371 \n372             # Display output\n373             if result.stdout:",
      "test_id": "B602",
      "test_name": "subprocess_popen_with_shell_equals_true",
      "cwe": [
        "CWE-78"
      ],
      "scan_timestamp": "20251010_113628",
      "file_hash": "66cfe96e7f9e8db6",
      "_original": {
        "code": "364                 command,\n365                 shell=True,\n366                 cwd=str(self.gp_copilot_root),\n367                 capture_output=True,\n368                 text=True,\n369                 timeout=300\n370             )\n371 \n372             # Display output\n373             if result.stdout:\n",
        "col_offset": 21,
        "end_col_offset": 13,
        "filename": "../GP-AI/cli/jade_chat.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 78,
          "link": "https://cwe.mitre.org/data/definitions/78.html"
        },
        "issue_severity": "HIGH",
        "issue_text": "subprocess call with shell=True identified, security issue.",
        "line_number": 365,
        "line_range": [
          363,
          364,
          365,
          366,
          367,
          368,
          369,
          370
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html",
        "test_id": "B602",
        "test_name": "subprocess_popen_with_shell_equals_true"
      },
      "iso27001_compliance": {
        "controls": [
          "A.14.2.1",
          "A.14.2.5"
        ],
        "control_name": "Secure development policy / Secure system engineering",
        "domain": "A.14 - System Acquisition, Development and Maintenance",
        "description": "Command injection vulnerabilities indicate lack of input validation in development process",
        "audit_evidence": [
          "Code review logs showing input validation checks",
          "SAST scan results (Bandit/Semgrep) with no command injection",
          "Developer training records on secure coding practices",
          "Documented secure coding standards including input validation"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 8,
        "remediation_guidance": "Use parameterized commands, avoid shell=True, validate all inputs"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1",
          "CC6.6",
          "CC7.2"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls",
          "CC6.6 - Logical Access - Authentication",
          "CC7.2 - System Monitoring - Security Events"
        ],
        "trust_service_category": "Security",
        "description": "Command injection vulnerabilities compromise system security controls",
        "control_objective": "The entity restricts logical access to system resources through authorization and authentication mechanisms",
        "audit_evidence": [
          "Code review documentation showing input validation",
          "SAST scan results (Bandit/Semgrep) demonstrating no command injection",
          "Secure coding training records",
          "Change management logs for security patches"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 8,
        "remediation_guidance": "Implement parameterized commands, avoid shell=True, validate all user inputs"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 5,
      "cross_framework_impact": true
    },
    {
      "id": "bandit_4",
      "scanner": "bandit",
      "severity": "CRITICAL",
      "confidence": "HIGH",
      "title": "subprocess call with shell=True identified, security issue.",
      "description": "subprocess call with shell=True identified, security issue.",
      "file": "../GP-AI/cli/jade_chat.py",
      "line": 586,
      "code": "585                         cmd,\n586                         shell=True,\n587                         cwd=str(self.gp_copilot_root),\n588                         capture_output=True,\n589                         text=True,\n590                         timeout=120\n591                     )\n592 \n593                     if result.returncode == 0:\n594                         console.print(f\"  [green]\u2705 {scanner} fixer completed[/green]\")",
      "test_id": "B602",
      "test_name": "subprocess_popen_with_shell_equals_true",
      "cwe": [
        "CWE-78"
      ],
      "scan_timestamp": "20251010_113628",
      "file_hash": "66cfe96e7f9e8db6",
      "_original": {
        "code": "585                         cmd,\n586                         shell=True,\n587                         cwd=str(self.gp_copilot_root),\n588                         capture_output=True,\n589                         text=True,\n590                         timeout=120\n591                     )\n592 \n593                     if result.returncode == 0:\n594                         console.print(f\"  [green]\u2705 {scanner} fixer completed[/green]\")\n",
        "col_offset": 29,
        "end_col_offset": 21,
        "filename": "../GP-AI/cli/jade_chat.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 78,
          "link": "https://cwe.mitre.org/data/definitions/78.html"
        },
        "issue_severity": "HIGH",
        "issue_text": "subprocess call with shell=True identified, security issue.",
        "line_number": 586,
        "line_range": [
          584,
          585,
          586,
          587,
          588,
          589,
          590,
          591
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html",
        "test_id": "B602",
        "test_name": "subprocess_popen_with_shell_equals_true"
      },
      "iso27001_compliance": {
        "controls": [
          "A.14.2.1",
          "A.14.2.5"
        ],
        "control_name": "Secure development policy / Secure system engineering",
        "domain": "A.14 - System Acquisition, Development and Maintenance",
        "description": "Command injection vulnerabilities indicate lack of input validation in development process",
        "audit_evidence": [
          "Code review logs showing input validation checks",
          "SAST scan results (Bandit/Semgrep) with no command injection",
          "Developer training records on secure coding practices",
          "Documented secure coding standards including input validation"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 8,
        "remediation_guidance": "Use parameterized commands, avoid shell=True, validate all inputs"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1",
          "CC6.6",
          "CC7.2"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls",
          "CC6.6 - Logical Access - Authentication",
          "CC7.2 - System Monitoring - Security Events"
        ],
        "trust_service_category": "Security",
        "description": "Command injection vulnerabilities compromise system security controls",
        "control_objective": "The entity restricts logical access to system resources through authorization and authentication mechanisms",
        "audit_evidence": [
          "Code review documentation showing input validation",
          "SAST scan results (Bandit/Semgrep) demonstrating no command injection",
          "Secure coding training records",
          "Change management logs for security patches"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 8,
        "remediation_guidance": "Implement parameterized commands, avoid shell=True, validate all user inputs"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 5,
      "cross_framework_impact": true
    },
    {
      "id": "bandit_5",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "title": "Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.",
      "description": "Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.",
      "file": "../GP-AI/core/rag_graph_engine.py",
      "line": 518,
      "code": "517             with open(self.graph_path, 'rb') as f:\n518                 data = pickle.load(f)\n519                 self.graph = data['graph']",
      "test_id": "B301",
      "test_name": "blacklist",
      "cwe": [
        "CWE-502"
      ],
      "scan_timestamp": "20251010_113628",
      "file_hash": "79f7f70a1e789465",
      "_original": {
        "code": "517             with open(self.graph_path, 'rb') as f:\n518                 data = pickle.load(f)\n519                 self.graph = data['graph']\n",
        "col_offset": 23,
        "end_col_offset": 37,
        "filename": "../GP-AI/core/rag_graph_engine.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 502,
          "link": "https://cwe.mitre.org/data/definitions/502.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.",
        "line_number": 518,
        "line_range": [
          518
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle",
        "test_id": "B301",
        "test_name": "blacklist"
      },
      "iso27001_compliance": {
        "controls": [
          "A.14.2.1",
          "A.14.2.8"
        ],
        "control_name": "Secure development policy / System security testing",
        "domain": "A.14 - System Acquisition, Development and Maintenance",
        "description": "Insecure deserialization allows arbitrary code execution",
        "audit_evidence": [
          "No pickle/yaml.unsafe_load usage with untrusted data",
          "JSON used for serialization where possible",
          "Input validation on all deserialized data",
          "Deserialization security review documentation"
        ],
        "remediation_priority": "CRITICAL",
        "estimated_effort_hours": 8,
        "remediation_guidance": "Avoid pickle with untrusted data, use JSON, validate deserialized objects"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1",
          "CC7.2"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls",
          "CC7.2 - System Monitoring - Security Events"
        ],
        "trust_service_category": "Security",
        "description": "Insecure deserialization allows remote code execution",
        "control_objective": "The entity validates and sanitizes all deserialized data",
        "audit_evidence": [
          "No pickle usage with untrusted data",
          "JSON used for serialization",
          "Input validation on deserialized objects",
          "Security testing results"
        ],
        "remediation_priority": "CRITICAL",
        "estimated_effort_hours": 8,
        "remediation_guidance": "Avoid pickle with untrusted data, use JSON, validate all deserialized data"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 4,
      "cross_framework_impact": true
    },
    {
      "id": "bandit_6",
      "scanner": "bandit",
      "severity": "CRITICAL",
      "confidence": "HIGH",
      "title": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "description": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "file": "../GP-AI/core/scan_graph_integrator.py",
      "line": 144,
      "code": "143             # Create unique finding ID\n144             finding_hash = hashlib.md5(\n145                 f\"{finding.get('file')}:{finding.get('line')}:{finding.get('test_id')}\".encode()\n146             ).hexdigest()[:8]\n147",
      "test_id": "B324",
      "test_name": "hashlib",
      "cwe": [
        "CWE-327"
      ],
      "scan_timestamp": "20251010_113628",
      "file_hash": "7a3fa01c9dd057c0",
      "_original": {
        "code": "143             # Create unique finding ID\n144             finding_hash = hashlib.md5(\n145                 f\"{finding.get('file')}:{finding.get('line')}:{finding.get('test_id')}\".encode()\n146             ).hexdigest()[:8]\n147 \n",
        "col_offset": 27,
        "end_col_offset": 13,
        "filename": "../GP-AI/core/scan_graph_integrator.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 327,
          "link": "https://cwe.mitre.org/data/definitions/327.html"
        },
        "issue_severity": "HIGH",
        "issue_text": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
        "line_number": 144,
        "line_range": [
          144,
          145,
          146
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html",
        "test_id": "B324",
        "test_name": "hashlib"
      },
      "iso27001_compliance": {
        "controls": [
          "A.10.1.1"
        ],
        "control_name": "Policy on the use of cryptographic controls",
        "domain": "A.10 - Cryptography",
        "description": "Use of broken or risky cryptographic algorithm",
        "audit_evidence": [
          "Only approved algorithms used (AES-256, RSA-2048+, SHA-256+)",
          "No MD5, SHA-1, DES, or weak ciphers in use",
          "Cryptographic standards policy documented",
          "Regular cryptographic algorithm review process"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 6,
        "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use modern encryption algorithms"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls"
        ],
        "trust_service_category": "Security",
        "description": "Weak cryptographic algorithms fail to protect data",
        "control_objective": "The entity uses strong cryptographic algorithms",
        "audit_evidence": [
          "Approved cryptographic algorithm list (AES-256, RSA-2048+, SHA-256+)",
          "No weak algorithms in use (MD5, SHA-1, DES)",
          "Cryptographic standards documentation",
          "Regular algorithm review process"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 6,
        "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use approved algorithms only"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 2,
      "cross_framework_impact": true
    },
    {
      "id": "bandit_7",
      "scanner": "bandit",
      "severity": "CRITICAL",
      "confidence": "HIGH",
      "title": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "description": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "file": "../GP-AI/core/scan_graph_integrator.py",
      "line": 176,
      "code": "175 \n176             finding_hash = hashlib.md5(\n177                 f\"{finding.get('PkgName', 'pkg')}:{cve_id}\".encode()\n178             ).hexdigest()[:8]\n179",
      "test_id": "B324",
      "test_name": "hashlib",
      "cwe": [
        "CWE-327"
      ],
      "scan_timestamp": "20251010_113628",
      "file_hash": "7a3fa01c9dd057c0",
      "_original": {
        "code": "175 \n176             finding_hash = hashlib.md5(\n177                 f\"{finding.get('PkgName', 'pkg')}:{cve_id}\".encode()\n178             ).hexdigest()[:8]\n179 \n",
        "col_offset": 27,
        "end_col_offset": 13,
        "filename": "../GP-AI/core/scan_graph_integrator.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 327,
          "link": "https://cwe.mitre.org/data/definitions/327.html"
        },
        "issue_severity": "HIGH",
        "issue_text": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
        "line_number": 176,
        "line_range": [
          176,
          177,
          178
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html",
        "test_id": "B324",
        "test_name": "hashlib"
      },
      "iso27001_compliance": {
        "controls": [
          "A.10.1.1"
        ],
        "control_name": "Policy on the use of cryptographic controls",
        "domain": "A.10 - Cryptography",
        "description": "Use of broken or risky cryptographic algorithm",
        "audit_evidence": [
          "Only approved algorithms used (AES-256, RSA-2048+, SHA-256+)",
          "No MD5, SHA-1, DES, or weak ciphers in use",
          "Cryptographic standards policy documented",
          "Regular cryptographic algorithm review process"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 6,
        "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use modern encryption algorithms"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls"
        ],
        "trust_service_category": "Security",
        "description": "Weak cryptographic algorithms fail to protect data",
        "control_objective": "The entity uses strong cryptographic algorithms",
        "audit_evidence": [
          "Approved cryptographic algorithm list (AES-256, RSA-2048+, SHA-256+)",
          "No weak algorithms in use (MD5, SHA-1, DES)",
          "Cryptographic standards documentation",
          "Regular algorithm review process"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 6,
        "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use approved algorithms only"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 2,
      "cross_framework_impact": true
    },
    {
      "id": "bandit_8",
      "scanner": "bandit",
      "severity": "CRITICAL",
      "confidence": "HIGH",
      "title": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "description": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "file": "../GP-AI/core/scan_graph_integrator.py",
      "line": 214,
      "code": "213         for finding in scan_data.get(\"findings\", []):\n214             finding_hash = hashlib.md5(\n215                 f\"{finding.get('path')}:{finding.get('start', {}).get('line')}:{finding.get('check_id')}\".encode()\n216             ).hexdigest()[:8]\n217",
      "test_id": "B324",
      "test_name": "hashlib",
      "cwe": [
        "CWE-327"
      ],
      "scan_timestamp": "20251010_113628",
      "file_hash": "7a3fa01c9dd057c0",
      "_original": {
        "code": "213         for finding in scan_data.get(\"findings\", []):\n214             finding_hash = hashlib.md5(\n215                 f\"{finding.get('path')}:{finding.get('start', {}).get('line')}:{finding.get('check_id')}\".encode()\n216             ).hexdigest()[:8]\n217 \n",
        "col_offset": 27,
        "end_col_offset": 13,
        "filename": "../GP-AI/core/scan_graph_integrator.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 327,
          "link": "https://cwe.mitre.org/data/definitions/327.html"
        },
        "issue_severity": "HIGH",
        "issue_text": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
        "line_number": 214,
        "line_range": [
          214,
          215,
          216
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html",
        "test_id": "B324",
        "test_name": "hashlib"
      },
      "iso27001_compliance": {
        "controls": [
          "A.10.1.1"
        ],
        "control_name": "Policy on the use of cryptographic controls",
        "domain": "A.10 - Cryptography",
        "description": "Use of broken or risky cryptographic algorithm",
        "audit_evidence": [
          "Only approved algorithms used (AES-256, RSA-2048+, SHA-256+)",
          "No MD5, SHA-1, DES, or weak ciphers in use",
          "Cryptographic standards policy documented",
          "Regular cryptographic algorithm review process"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 6,
        "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use modern encryption algorithms"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls"
        ],
        "trust_service_category": "Security",
        "description": "Weak cryptographic algorithms fail to protect data",
        "control_objective": "The entity uses strong cryptographic algorithms",
        "audit_evidence": [
          "Approved cryptographic algorithm list (AES-256, RSA-2048+, SHA-256+)",
          "No weak algorithms in use (MD5, SHA-1, DES)",
          "Cryptographic standards documentation",
          "Regular algorithm review process"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 6,
        "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use approved algorithms only"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 2,
      "cross_framework_impact": true
    },
    {
      "id": "bandit_9",
      "scanner": "bandit",
      "severity": "CRITICAL",
      "confidence": "HIGH",
      "title": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "description": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "file": "../GP-AI/core/scan_graph_integrator.py",
      "line": 246,
      "code": "245         for finding in scan_data.get(\"findings\", []):\n246             finding_hash = hashlib.md5(\n247                 f\"{finding.get('file_path')}:{finding.get('resource')}:{finding.get('check_id')}\".encode()\n248             ).hexdigest()[:8]\n249",
      "test_id": "B324",
      "test_name": "hashlib",
      "cwe": [
        "CWE-327"
      ],
      "scan_timestamp": "20251010_113628",
      "file_hash": "7a3fa01c9dd057c0",
      "_original": {
        "code": "245         for finding in scan_data.get(\"findings\", []):\n246             finding_hash = hashlib.md5(\n247                 f\"{finding.get('file_path')}:{finding.get('resource')}:{finding.get('check_id')}\".encode()\n248             ).hexdigest()[:8]\n249 \n",
        "col_offset": 27,
        "end_col_offset": 13,
        "filename": "../GP-AI/core/scan_graph_integrator.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 327,
          "link": "https://cwe.mitre.org/data/definitions/327.html"
        },
        "issue_severity": "HIGH",
        "issue_text": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
        "line_number": 246,
        "line_range": [
          246,
          247,
          248
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html",
        "test_id": "B324",
        "test_name": "hashlib"
      },
      "iso27001_compliance": {
        "controls": [
          "A.10.1.1"
        ],
        "control_name": "Policy on the use of cryptographic controls",
        "domain": "A.10 - Cryptography",
        "description": "Use of broken or risky cryptographic algorithm",
        "audit_evidence": [
          "Only approved algorithms used (AES-256, RSA-2048+, SHA-256+)",
          "No MD5, SHA-1, DES, or weak ciphers in use",
          "Cryptographic standards policy documented",
          "Regular cryptographic algorithm review process"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 6,
        "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use modern encryption algorithms"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls"
        ],
        "trust_service_category": "Security",
        "description": "Weak cryptographic algorithms fail to protect data",
        "control_objective": "The entity uses strong cryptographic algorithms",
        "audit_evidence": [
          "Approved cryptographic algorithm list (AES-256, RSA-2048+, SHA-256+)",
          "No weak algorithms in use (MD5, SHA-1, DES)",
          "Cryptographic standards documentation",
          "Regular algorithm review process"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 6,
        "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use approved algorithms only"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 2,
      "cross_framework_impact": true
    },
    {
      "id": "bandit_10",
      "scanner": "bandit",
      "severity": "CRITICAL",
      "confidence": "HIGH",
      "title": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "description": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "file": "../GP-AI/core/scan_graph_integrator.py",
      "line": 272,
      "code": "271         for finding in scan_data.get(\"findings\", []):\n272             finding_hash = hashlib.md5(\n273                 f\"{finding.get('File')}:{finding.get('StartLine')}:{finding.get('RuleID')}\".encode()\n274             ).hexdigest()[:8]\n275",
      "test_id": "B324",
      "test_name": "hashlib",
      "cwe": [
        "CWE-327"
      ],
      "scan_timestamp": "20251010_113628",
      "file_hash": "7a3fa01c9dd057c0",
      "_original": {
        "code": "271         for finding in scan_data.get(\"findings\", []):\n272             finding_hash = hashlib.md5(\n273                 f\"{finding.get('File')}:{finding.get('StartLine')}:{finding.get('RuleID')}\".encode()\n274             ).hexdigest()[:8]\n275 \n",
        "col_offset": 27,
        "end_col_offset": 13,
        "filename": "../GP-AI/core/scan_graph_integrator.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 327,
          "link": "https://cwe.mitre.org/data/definitions/327.html"
        },
        "issue_severity": "HIGH",
        "issue_text": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
        "line_number": 272,
        "line_range": [
          272,
          273,
          274
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html",
        "test_id": "B324",
        "test_name": "hashlib"
      },
      "iso27001_compliance": {
        "controls": [
          "A.10.1.1"
        ],
        "control_name": "Policy on the use of cryptographic controls",
        "domain": "A.10 - Cryptography",
        "description": "Use of broken or risky cryptographic algorithm",
        "audit_evidence": [
          "Only approved algorithms used (AES-256, RSA-2048+, SHA-256+)",
          "No MD5, SHA-1, DES, or weak ciphers in use",
          "Cryptographic standards policy documented",
          "Regular cryptographic algorithm review process"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 6,
        "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use modern encryption algorithms"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls"
        ],
        "trust_service_category": "Security",
        "description": "Weak cryptographic algorithms fail to protect data",
        "control_objective": "The entity uses strong cryptographic algorithms",
        "audit_evidence": [
          "Approved cryptographic algorithm list (AES-256, RSA-2048+, SHA-256+)",
          "No weak algorithms in use (MD5, SHA-1, DES)",
          "Cryptographic standards documentation",
          "Regular algorithm review process"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 6,
        "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use approved algorithms only"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 2,
      "cross_framework_impact": true
    },
    {
      "id": "bandit_11",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "title": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "description": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "file": "../GP-AI/engines/llm_adapter.py",
      "line": 45,
      "code": "44 \n45             self.tokenizer = AutoTokenizer.from_pretrained(\n46                 model_name,\n47                 cache_dir=str(cache_dir),\n48                 trust_remote_code=True\n49             )\n50",
      "test_id": "B615",
      "test_name": "huggingface_unsafe_download",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "6492ed7ab16e1543",
      "_original": {
        "code": "44 \n45             self.tokenizer = AutoTokenizer.from_pretrained(\n46                 model_name,\n47                 cache_dir=str(cache_dir),\n48                 trust_remote_code=True\n49             )\n50 \n",
        "col_offset": 29,
        "end_col_offset": 13,
        "filename": "../GP-AI/engines/llm_adapter.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 494,
          "link": "https://cwe.mitre.org/data/definitions/494.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
        "line_number": 45,
        "line_range": [
          45,
          46,
          47,
          48,
          49
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html",
        "test_id": "B615",
        "test_name": "huggingface_unsafe_download"
      }
    },
    {
      "id": "bandit_12",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "title": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "description": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "file": "../GP-AI/engines/llm_adapter.py",
      "line": 57,
      "code": "56 \n57             self.model = AutoModelForCausalLM.from_pretrained(\n58                 model_name,\n59                 cache_dir=str(cache_dir),\n60                 trust_remote_code=True,\n61                 torch_dtype=torch.float32,\n62                 device_map=None,\n63                 low_cpu_mem_usage=True\n64             )\n65",
      "test_id": "B615",
      "test_name": "huggingface_unsafe_download",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "6492ed7ab16e1543",
      "_original": {
        "code": "56 \n57             self.model = AutoModelForCausalLM.from_pretrained(\n58                 model_name,\n59                 cache_dir=str(cache_dir),\n60                 trust_remote_code=True,\n61                 torch_dtype=torch.float32,\n62                 device_map=None,\n63                 low_cpu_mem_usage=True\n64             )\n65 \n",
        "col_offset": 25,
        "end_col_offset": 13,
        "filename": "../GP-AI/engines/llm_adapter.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 494,
          "link": "https://cwe.mitre.org/data/definitions/494.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
        "line_number": 57,
        "line_range": [
          57,
          58,
          59,
          60,
          61,
          62,
          63,
          64
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html",
        "test_id": "B615",
        "test_name": "huggingface_unsafe_download"
      }
    },
    {
      "id": "bandit_13",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "title": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "description": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "file": "../GP-AI/engines/llm_adapter.py",
      "line": 86,
      "code": "85 \n86             self.tokenizer = AutoTokenizer.from_pretrained(\n87                 model_name,\n88                 trust_remote_code=True\n89             )\n90",
      "test_id": "B615",
      "test_name": "huggingface_unsafe_download",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "6492ed7ab16e1543",
      "_original": {
        "code": "85 \n86             self.tokenizer = AutoTokenizer.from_pretrained(\n87                 model_name,\n88                 trust_remote_code=True\n89             )\n90 \n",
        "col_offset": 29,
        "end_col_offset": 13,
        "filename": "../GP-AI/engines/llm_adapter.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 494,
          "link": "https://cwe.mitre.org/data/definitions/494.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
        "line_number": 86,
        "line_range": [
          86,
          87,
          88,
          89
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html",
        "test_id": "B615",
        "test_name": "huggingface_unsafe_download"
      }
    },
    {
      "id": "bandit_14",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "title": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "description": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "file": "../GP-AI/engines/llm_adapter.py",
      "line": 99,
      "code": "98 \n99             self.model = AutoModelForCausalLM.from_pretrained(\n100                 model_name,\n101                 trust_remote_code=True,\n102                 torch_dtype=torch.float16 if device == \"cuda\" else torch.float32,\n103                 device_map=\"auto\" if device == \"cuda\" else None,\n104                 low_cpu_mem_usage=True\n105             )\n106",
      "test_id": "B615",
      "test_name": "huggingface_unsafe_download",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "6492ed7ab16e1543",
      "_original": {
        "code": "98 \n99             self.model = AutoModelForCausalLM.from_pretrained(\n100                 model_name,\n101                 trust_remote_code=True,\n102                 torch_dtype=torch.float16 if device == \"cuda\" else torch.float32,\n103                 device_map=\"auto\" if device == \"cuda\" else None,\n104                 low_cpu_mem_usage=True\n105             )\n106 \n",
        "col_offset": 25,
        "end_col_offset": 13,
        "filename": "../GP-AI/engines/llm_adapter.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 494,
          "link": "https://cwe.mitre.org/data/definitions/494.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
        "line_number": 99,
        "line_range": [
          99,
          100,
          101,
          102,
          103,
          104,
          105
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html",
        "test_id": "B615",
        "test_name": "huggingface_unsafe_download"
      }
    },
    {
      "id": "bandit_15",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Probable insecure usage of temp file/directory.",
      "description": "Probable insecure usage of temp file/directory.",
      "file": "../GP-AI/integrations/jade_gatekeeper_integration.py",
      "line": 135,
      "code": "134         \"\"\"Create test manifests for policy validation\"\"\"\n135         test_dir = Path(\"/tmp/jade-test-manifests\")\n136         test_dir.mkdir(exist_ok=True)",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "16f9277c2b04f8c7",
      "_original": {
        "code": "134         \"\"\"Create test manifests for policy validation\"\"\"\n135         test_dir = Path(\"/tmp/jade-test-manifests\")\n136         test_dir.mkdir(exist_ok=True)\n",
        "col_offset": 24,
        "end_col_offset": 50,
        "filename": "../GP-AI/integrations/jade_gatekeeper_integration.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 377,
          "link": "https://cwe.mitre.org/data/definitions/377.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Probable insecure usage of temp file/directory.",
        "line_number": 135,
        "line_range": [
          135
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html",
        "test_id": "B108",
        "test_name": "hardcoded_tmp_directory"
      }
    },
    {
      "id": "bandit_16",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "title": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "description": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "file": "../GP-AI/models/model_manager.py",
      "line": 56,
      "code": "55             print(\"\ud83d\udcdd Downloading tokenizer...\")\n56             tokenizer = AutoTokenizer.from_pretrained(\n57                 model_name,\n58                 cache_dir=str(local_path),\n59                 trust_remote_code=True\n60             )\n61",
      "test_id": "B615",
      "test_name": "huggingface_unsafe_download",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "f5f7a5baaa80d097",
      "_original": {
        "code": "55             print(\"\ud83d\udcdd Downloading tokenizer...\")\n56             tokenizer = AutoTokenizer.from_pretrained(\n57                 model_name,\n58                 cache_dir=str(local_path),\n59                 trust_remote_code=True\n60             )\n61 \n",
        "col_offset": 24,
        "end_col_offset": 13,
        "filename": "../GP-AI/models/model_manager.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 494,
          "link": "https://cwe.mitre.org/data/definitions/494.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
        "line_number": 56,
        "line_range": [
          56,
          57,
          58,
          59,
          60
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html",
        "test_id": "B615",
        "test_name": "huggingface_unsafe_download"
      }
    },
    {
      "id": "bandit_17",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "title": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "description": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "file": "../GP-AI/models/model_manager.py",
      "line": 64,
      "code": "63             print(\"\ud83e\udde0 Downloading model weights...\")\n64             model = AutoModelForCausalLM.from_pretrained(\n65                 model_name,\n66                 cache_dir=str(local_path),\n67                 trust_remote_code=True,\n68                 torch_dtype=torch.float16,\n69                 device_map=\"auto\" if torch.cuda.is_available() else None,\n70                 quantization_config=quantization_config,\n71                 low_cpu_mem_usage=True\n72             )\n73",
      "test_id": "B615",
      "test_name": "huggingface_unsafe_download",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "f5f7a5baaa80d097",
      "_original": {
        "code": "63             print(\"\ud83e\udde0 Downloading model weights...\")\n64             model = AutoModelForCausalLM.from_pretrained(\n65                 model_name,\n66                 cache_dir=str(local_path),\n67                 trust_remote_code=True,\n68                 torch_dtype=torch.float16,\n69                 device_map=\"auto\" if torch.cuda.is_available() else None,\n70                 quantization_config=quantization_config,\n71                 low_cpu_mem_usage=True\n72             )\n73 \n",
        "col_offset": 20,
        "end_col_offset": 13,
        "filename": "../GP-AI/models/model_manager.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 494,
          "link": "https://cwe.mitre.org/data/definitions/494.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
        "line_number": 64,
        "line_range": [
          64,
          65,
          66,
          67,
          68,
          69,
          70,
          71,
          72
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html",
        "test_id": "B615",
        "test_name": "huggingface_unsafe_download"
      }
    },
    {
      "id": "bandit_18",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "title": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "description": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "file": "../GP-AI/models/model_manager.py",
      "line": 91,
      "code": "90             # Load tokenizer\n91             self.tokenizer = AutoTokenizer.from_pretrained(\n92                 model_name,\n93                 trust_remote_code=True\n94             )\n95",
      "test_id": "B615",
      "test_name": "huggingface_unsafe_download",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "f5f7a5baaa80d097",
      "_original": {
        "code": "90             # Load tokenizer\n91             self.tokenizer = AutoTokenizer.from_pretrained(\n92                 model_name,\n93                 trust_remote_code=True\n94             )\n95 \n",
        "col_offset": 29,
        "end_col_offset": 13,
        "filename": "../GP-AI/models/model_manager.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 494,
          "link": "https://cwe.mitre.org/data/definitions/494.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
        "line_number": 91,
        "line_range": [
          91,
          92,
          93,
          94
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html",
        "test_id": "B615",
        "test_name": "huggingface_unsafe_download"
      }
    },
    {
      "id": "bandit_19",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "title": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "description": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "file": "../GP-AI/models/model_manager.py",
      "line": 105,
      "code": "104             # Load model with optimized settings\n105             self.model = AutoModelForCausalLM.from_pretrained(\n106                 model_name,\n107                 torch_dtype=torch.float16,\n108                 device_map=\"auto\",\n109                 trust_remote_code=True,\n110                 quantization_config=quantization_config,\n111                 low_cpu_mem_usage=True\n112             )\n113",
      "test_id": "B615",
      "test_name": "huggingface_unsafe_download",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "f5f7a5baaa80d097",
      "_original": {
        "code": "104             # Load model with optimized settings\n105             self.model = AutoModelForCausalLM.from_pretrained(\n106                 model_name,\n107                 torch_dtype=torch.float16,\n108                 device_map=\"auto\",\n109                 trust_remote_code=True,\n110                 quantization_config=quantization_config,\n111                 low_cpu_mem_usage=True\n112             )\n113 \n",
        "col_offset": 25,
        "end_col_offset": 13,
        "filename": "../GP-AI/models/model_manager.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 494,
          "link": "https://cwe.mitre.org/data/definitions/494.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
        "line_number": 105,
        "line_range": [
          105,
          106,
          107,
          108,
          109,
          110,
          111,
          112
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html",
        "test_id": "B615",
        "test_name": "huggingface_unsafe_download"
      }
    },
    {
      "id": "bandit_20",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Possible binding to all interfaces.",
      "description": "Possible binding to all interfaces.",
      "file": "../GP-CONSULTING/fixers/bandit_fixer.py",
      "line": 397,
      "code": "396             # Replace 0.0.0.0 with 127.0.0.1 or use environment variable\n397             if '0.0.0.0' in line:\n398                 # Add import for os if not present",
      "test_id": "B104",
      "test_name": "hardcoded_bind_all_interfaces",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "ef7c90d19ef0a04d",
      "_original": {
        "code": "396             # Replace 0.0.0.0 with 127.0.0.1 or use environment variable\n397             if '0.0.0.0' in line:\n398                 # Add import for os if not present\n",
        "col_offset": 15,
        "end_col_offset": 24,
        "filename": "../GP-CONSULTING/fixers/bandit_fixer.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 605,
          "link": "https://cwe.mitre.org/data/definitions/605.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Possible binding to all interfaces.",
        "line_number": 397,
        "line_range": [
          397
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html",
        "test_id": "B104",
        "test_name": "hardcoded_bind_all_interfaces"
      }
    },
    {
      "id": "bandit_21",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Probable insecure usage of temp file/directory.",
      "description": "Probable insecure usage of temp file/directory.",
      "file": "../GP-CONSULTING/fixers/bandit_fixer.py",
      "line": 428,
      "code": "427             # Replace hardcoded temp path with secure tempfile\n428             if '/tmp/' in line:\n429                 # Extract variable name",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "ef7c90d19ef0a04d",
      "_original": {
        "code": "427             # Replace hardcoded temp path with secure tempfile\n428             if '/tmp/' in line:\n429                 # Extract variable name\n",
        "col_offset": 15,
        "end_col_offset": 22,
        "filename": "../GP-CONSULTING/fixers/bandit_fixer.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 377,
          "link": "https://cwe.mitre.org/data/definitions/377.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Probable insecure usage of temp file/directory.",
        "line_number": 428,
        "line_range": [
          428
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html",
        "test_id": "B108",
        "test_name": "hardcoded_tmp_directory"
      }
    },
    {
      "id": "bandit_22",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Probable insecure usage of temp file/directory.",
      "description": "Probable insecure usage of temp file/directory.",
      "file": "../GP-CONSULTING/fixers/gatekeeper_fixer.py",
      "line": 261,
      "code": "260                     # Add common writable directories\n261                     writable_dirs = ['/tmp', '/var/cache', '/var/run']\n262                     for dir_path in writable_dirs:",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "bea26a72cec9ea41",
      "_original": {
        "code": "260                     # Add common writable directories\n261                     writable_dirs = ['/tmp', '/var/cache', '/var/run']\n262                     for dir_path in writable_dirs:\n",
        "col_offset": 37,
        "end_col_offset": 43,
        "filename": "../GP-CONSULTING/fixers/gatekeeper_fixer.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 377,
          "link": "https://cwe.mitre.org/data/definitions/377.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Probable insecure usage of temp file/directory.",
        "line_number": 261,
        "line_range": [
          261
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html",
        "test_id": "B108",
        "test_name": "hardcoded_tmp_directory"
      }
    },
    {
      "id": "bandit_23",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Probable insecure usage of temp file/directory.",
      "description": "Probable insecure usage of temp file/directory.",
      "file": "../GP-CONSULTING/policy-framework/2-AUTOMATION/agents/patch_rollout_agent.py",
      "line": 92,
      "code": "91         # Write modified constraint to temp file\n92         temp_file = Path(f\"/tmp/{constraint_file.stem}_{enforcement_action}.yaml\")\n93         temp_file.write_text(yaml.dump(constraint))",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "e7c160a0c661bd26",
      "_original": {
        "code": "91         # Write modified constraint to temp file\n92         temp_file = Path(f\"/tmp/{constraint_file.stem}_{enforcement_action}.yaml\")\n93         temp_file.write_text(yaml.dump(constraint))\n",
        "col_offset": 25,
        "end_col_offset": 81,
        "filename": "../GP-CONSULTING/policy-framework/2-AUTOMATION/agents/patch_rollout_agent.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 377,
          "link": "https://cwe.mitre.org/data/definitions/377.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Probable insecure usage of temp file/directory.",
        "line_number": 92,
        "line_range": [
          92
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html",
        "test_id": "B108",
        "test_name": "hardcoded_tmp_directory"
      }
    },
    {
      "id": "bandit_24",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Probable insecure usage of temp file/directory.",
      "description": "Probable insecure usage of temp file/directory.",
      "file": "../GP-CONSULTING/policy-framework/2-AUTOMATION/agents/patch_rollout_agent.py",
      "line": 202,
      "code": "201         import yaml\n202         temp_file = Path(\"/tmp/gatekeeper_mutation.yaml\")\n203         temp_file.write_text(yaml.dump(mutation_policy))",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "e7c160a0c661bd26",
      "_original": {
        "code": "201         import yaml\n202         temp_file = Path(\"/tmp/gatekeeper_mutation.yaml\")\n203         temp_file.write_text(yaml.dump(mutation_policy))\n",
        "col_offset": 25,
        "end_col_offset": 56,
        "filename": "../GP-CONSULTING/policy-framework/2-AUTOMATION/agents/patch_rollout_agent.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 377,
          "link": "https://cwe.mitre.org/data/definitions/377.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Probable insecure usage of temp file/directory.",
        "line_number": 202,
        "line_range": [
          202
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html",
        "test_id": "B108",
        "test_name": "hardcoded_tmp_directory"
      }
    },
    {
      "id": "bandit_25",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Possible binding to all interfaces.",
      "description": "Possible binding to all interfaces.",
      "file": "../GP-CONSULTING/policy-framework/2-AUTOMATION/fixers/opa_fixer.py",
      "line": 446,
      "code": "445             return 'rds_encryption'\n446         elif 'public' in policy_lower and ('access' in policy_lower or '0.0.0.0' in policy_lower):\n447             return 'tf_deny_public_access'",
      "test_id": "B104",
      "test_name": "hardcoded_bind_all_interfaces",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "fe4da43fd8878324",
      "_original": {
        "code": "445             return 'rds_encryption'\n446         elif 'public' in policy_lower and ('access' in policy_lower or '0.0.0.0' in policy_lower):\n447             return 'tf_deny_public_access'\n",
        "col_offset": 71,
        "end_col_offset": 80,
        "filename": "../GP-CONSULTING/policy-framework/2-AUTOMATION/fixers/opa_fixer.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 605,
          "link": "https://cwe.mitre.org/data/definitions/605.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Possible binding to all interfaces.",
        "line_number": 446,
        "line_range": [
          446
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html",
        "test_id": "B104",
        "test_name": "hardcoded_bind_all_interfaces"
      }
    },
    {
      "id": "bandit_26",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Probable insecure usage of temp file/directory.",
      "description": "Probable insecure usage of temp file/directory.",
      "file": "../GP-CONSULTING/policy-framework/2-AUTOMATION/orchestrators/opa_cluster_manager.py",
      "line": 192,
      "code": "191 \n192         test_file = Path(\"/tmp/test-violation.yaml\")\n193         with open(test_file, 'w') as f:",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "22235ccde96d2607",
      "_original": {
        "code": "191 \n192         test_file = Path(\"/tmp/test-violation.yaml\")\n193         with open(test_file, 'w') as f:\n",
        "col_offset": 25,
        "end_col_offset": 51,
        "filename": "../GP-CONSULTING/policy-framework/2-AUTOMATION/orchestrators/opa_cluster_manager.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 377,
          "link": "https://cwe.mitre.org/data/definitions/377.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Probable insecure usage of temp file/directory.",
        "line_number": 192,
        "line_range": [
          192
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html",
        "test_id": "B108",
        "test_name": "hardcoded_tmp_directory"
      }
    },
    {
      "id": "bandit_27",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "LOW",
      "title": "Call to requests without timeout",
      "description": "Call to requests without timeout",
      "file": "../GP-CONSULTING/scanners/example_scanner_with_secrets.py",
      "line": 55,
      "code": "54         try:\n55             response = requests.get(repo_url, headers=headers)\n56             logger.info(f\"GitHub API call successful: {response.status_code}\")",
      "test_id": "B113",
      "test_name": "request_without_timeout",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "f49a547258fa71a8",
      "_original": {
        "code": "54         try:\n55             response = requests.get(repo_url, headers=headers)\n56             logger.info(f\"GitHub API call successful: {response.status_code}\")\n",
        "col_offset": 23,
        "end_col_offset": 62,
        "filename": "../GP-CONSULTING/scanners/example_scanner_with_secrets.py",
        "issue_confidence": "LOW",
        "issue_cwe": {
          "id": 400,
          "link": "https://cwe.mitre.org/data/definitions/400.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Call to requests without timeout",
        "line_number": 55,
        "line_range": [
          55
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html",
        "test_id": "B113",
        "test_name": "request_without_timeout"
      }
    },
    {
      "id": "bandit_28",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Possible binding to all interfaces.",
      "description": "Possible binding to all interfaces.",
      "file": "../GP-CONSULTING/secops-framework/4-mutators/webhook-server/mutating-webhook.py",
      "line": 221,
      "code": "220         logger.info(\"Starting webhook server with TLS\")\n221         app.run(host='0.0.0.0', port=8443, ssl_context=(cert_file, key_file))\n222     else:",
      "test_id": "B104",
      "test_name": "hardcoded_bind_all_interfaces",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "3cd94a73a96c0183",
      "_original": {
        "code": "220         logger.info(\"Starting webhook server with TLS\")\n221         app.run(host='0.0.0.0', port=8443, ssl_context=(cert_file, key_file))\n222     else:\n",
        "col_offset": 21,
        "end_col_offset": 30,
        "filename": "../GP-CONSULTING/secops-framework/4-mutators/webhook-server/mutating-webhook.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 605,
          "link": "https://cwe.mitre.org/data/definitions/605.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Possible binding to all interfaces.",
        "line_number": 221,
        "line_range": [
          221
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html",
        "test_id": "B104",
        "test_name": "hardcoded_bind_all_interfaces"
      }
    },
    {
      "id": "bandit_29",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Possible binding to all interfaces.",
      "description": "Possible binding to all interfaces.",
      "file": "../GP-CONSULTING/secops-framework/4-mutators/webhook-server/mutating-webhook.py",
      "line": 224,
      "code": "223         logger.warning(\"TLS certificates not found. Running without TLS (DEV ONLY)\")\n224         app.run(host='0.0.0.0', port=8080)",
      "test_id": "B104",
      "test_name": "hardcoded_bind_all_interfaces",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "3cd94a73a96c0183",
      "_original": {
        "code": "223         logger.warning(\"TLS certificates not found. Running without TLS (DEV ONLY)\")\n224         app.run(host='0.0.0.0', port=8080)\n",
        "col_offset": 21,
        "end_col_offset": 30,
        "filename": "../GP-CONSULTING/secops-framework/4-mutators/webhook-server/mutating-webhook.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 605,
          "link": "https://cwe.mitre.org/data/definitions/605.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Possible binding to all interfaces.",
        "line_number": 224,
        "line_range": [
          224
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html",
        "test_id": "B104",
        "test_name": "hardcoded_bind_all_interfaces"
      }
    },
    {
      "id": "bandit_30",
      "scanner": "bandit",
      "severity": "CRITICAL",
      "confidence": "HIGH",
      "title": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "description": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "file": "../GP-DATA/active/scans/scan_manifest.py",
      "line": 145,
      "code": "144         timestamp = datetime.now().strftime(\"%Y%m%d_%H%M%S\")\n145         target_hash = hashlib.md5(target.encode()).hexdigest()[:8]\n146         return f\"scan_session_{timestamp}_{target_hash}\"",
      "test_id": "B324",
      "test_name": "hashlib",
      "cwe": [
        "CWE-327"
      ],
      "scan_timestamp": "20251010_113628",
      "file_hash": "ba26029dc4f64b83",
      "_original": {
        "code": "144         timestamp = datetime.now().strftime(\"%Y%m%d_%H%M%S\")\n145         target_hash = hashlib.md5(target.encode()).hexdigest()[:8]\n146         return f\"scan_session_{timestamp}_{target_hash}\"\n",
        "col_offset": 22,
        "end_col_offset": 50,
        "filename": "../GP-DATA/active/scans/scan_manifest.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 327,
          "link": "https://cwe.mitre.org/data/definitions/327.html"
        },
        "issue_severity": "HIGH",
        "issue_text": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
        "line_number": 145,
        "line_range": [
          145
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html",
        "test_id": "B324",
        "test_name": "hashlib"
      },
      "iso27001_compliance": {
        "controls": [
          "A.10.1.1"
        ],
        "control_name": "Policy on the use of cryptographic controls",
        "domain": "A.10 - Cryptography",
        "description": "Use of broken or risky cryptographic algorithm",
        "audit_evidence": [
          "Only approved algorithms used (AES-256, RSA-2048+, SHA-256+)",
          "No MD5, SHA-1, DES, or weak ciphers in use",
          "Cryptographic standards policy documented",
          "Regular cryptographic algorithm review process"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 6,
        "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use modern encryption algorithms"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls"
        ],
        "trust_service_category": "Security",
        "description": "Weak cryptographic algorithms fail to protect data",
        "control_objective": "The entity uses strong cryptographic algorithms",
        "audit_evidence": [
          "Approved cryptographic algorithm list (AES-256, RSA-2048+, SHA-256+)",
          "No weak algorithms in use (MD5, SHA-1, DES)",
          "Cryptographic standards documentation",
          "Regular algorithm review process"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 6,
        "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use approved algorithms only"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 2,
      "cross_framework_impact": true
    },
    {
      "id": "bandit_31",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Possible binding to all interfaces.",
      "description": "Possible binding to all interfaces.",
      "file": "../GP-PLATFORM/api/agent_gateway.py",
      "line": 278,
      "code": "277         app,\n278         host=\"0.0.0.0\",\n279         port=8000,",
      "test_id": "B104",
      "test_name": "hardcoded_bind_all_interfaces",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "4456c3ef47e7176a",
      "_original": {
        "code": "277         app,\n278         host=\"0.0.0.0\",\n279         port=8000,\n",
        "col_offset": 13,
        "end_col_offset": 22,
        "filename": "../GP-PLATFORM/api/agent_gateway.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 605,
          "link": "https://cwe.mitre.org/data/definitions/605.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Possible binding to all interfaces.",
        "line_number": 278,
        "line_range": [
          278
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html",
        "test_id": "B104",
        "test_name": "hardcoded_bind_all_interfaces"
      }
    },
    {
      "id": "bandit_32",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Possible binding to all interfaces.",
      "description": "Possible binding to all interfaces.",
      "file": "../GP-PLATFORM/api/unified/automation_api.py",
      "line": 215,
      "code": "214     import uvicorn\n215     uvicorn.run(app, host=\"0.0.0.0\", port=8000)",
      "test_id": "B104",
      "test_name": "hardcoded_bind_all_interfaces",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "755bcee1cc931774",
      "_original": {
        "code": "214     import uvicorn\n215     uvicorn.run(app, host=\"0.0.0.0\", port=8000)\n",
        "col_offset": 26,
        "end_col_offset": 35,
        "filename": "../GP-PLATFORM/api/unified/automation_api.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 605,
          "link": "https://cwe.mitre.org/data/definitions/605.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Possible binding to all interfaces.",
        "line_number": 215,
        "line_range": [
          215
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html",
        "test_id": "B104",
        "test_name": "hardcoded_bind_all_interfaces"
      }
    },
    {
      "id": "bandit_33",
      "scanner": "bandit",
      "severity": "CRITICAL",
      "confidence": "HIGH",
      "title": "subprocess call with shell=True identified, security issue.",
      "description": "subprocess call with shell=True identified, security issue.",
      "file": "../GP-PLATFORM/core/james_orchestrator.py",
      "line": 60,
      "code": "59             scan_cmd = f\"PYTHONPATH={GP_COPILOT_BASE} python3 {GP_COPILOT_BASE}/GP-CONSULTING-AGENTS/scanners/run_all_scanners.py {target_path}\"\n60             result = subprocess.run(scan_cmd, shell=True, capture_output=True, text=True)\n61",
      "test_id": "B602",
      "test_name": "subprocess_popen_with_shell_equals_true",
      "cwe": [
        "CWE-78"
      ],
      "scan_timestamp": "20251010_113628",
      "file_hash": "3811f323bb5c1064",
      "_original": {
        "code": "59             scan_cmd = f\"PYTHONPATH={GP_COPILOT_BASE} python3 {GP_COPILOT_BASE}/GP-CONSULTING-AGENTS/scanners/run_all_scanners.py {target_path}\"\n60             result = subprocess.run(scan_cmd, shell=True, capture_output=True, text=True)\n61 \n",
        "col_offset": 21,
        "end_col_offset": 89,
        "filename": "../GP-PLATFORM/core/james_orchestrator.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 78,
          "link": "https://cwe.mitre.org/data/definitions/78.html"
        },
        "issue_severity": "HIGH",
        "issue_text": "subprocess call with shell=True identified, security issue.",
        "line_number": 60,
        "line_range": [
          60
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html",
        "test_id": "B602",
        "test_name": "subprocess_popen_with_shell_equals_true"
      },
      "iso27001_compliance": {
        "controls": [
          "A.14.2.1",
          "A.14.2.5"
        ],
        "control_name": "Secure development policy / Secure system engineering",
        "domain": "A.14 - System Acquisition, Development and Maintenance",
        "description": "Command injection vulnerabilities indicate lack of input validation in development process",
        "audit_evidence": [
          "Code review logs showing input validation checks",
          "SAST scan results (Bandit/Semgrep) with no command injection",
          "Developer training records on secure coding practices",
          "Documented secure coding standards including input validation"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 8,
        "remediation_guidance": "Use parameterized commands, avoid shell=True, validate all inputs"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1",
          "CC6.6",
          "CC7.2"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls",
          "CC6.6 - Logical Access - Authentication",
          "CC7.2 - System Monitoring - Security Events"
        ],
        "trust_service_category": "Security",
        "description": "Command injection vulnerabilities compromise system security controls",
        "control_objective": "The entity restricts logical access to system resources through authorization and authentication mechanisms",
        "audit_evidence": [
          "Code review documentation showing input validation",
          "SAST scan results (Bandit/Semgrep) demonstrating no command injection",
          "Secure coding training records",
          "Change management logs for security patches"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 8,
        "remediation_guidance": "Implement parameterized commands, avoid shell=True, validate all user inputs"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 5,
      "cross_framework_impact": true
    },
    {
      "id": "bandit_34",
      "scanner": "bandit",
      "severity": "CRITICAL",
      "confidence": "HIGH",
      "title": "subprocess call with shell=True identified, security issue.",
      "description": "subprocess call with shell=True identified, security issue.",
      "file": "../GP-PLATFORM/core/james_orchestrator.py",
      "line": 121,
      "code": "120                 fix_cmd = f\"PYTHONPATH={GP_COPILOT_BASE} python3 {GP_COPILOT_BASE}/GP-CONSULTING-AGENTS/fixers/apply_all_fixes.py {scan_file} {target_path}\"\n121                 subprocess.run(fix_cmd, shell=True, capture_output=True, text=True)\n122",
      "test_id": "B602",
      "test_name": "subprocess_popen_with_shell_equals_true",
      "cwe": [
        "CWE-78"
      ],
      "scan_timestamp": "20251010_113628",
      "file_hash": "3811f323bb5c1064",
      "_original": {
        "code": "120                 fix_cmd = f\"PYTHONPATH={GP_COPILOT_BASE} python3 {GP_COPILOT_BASE}/GP-CONSULTING-AGENTS/fixers/apply_all_fixes.py {scan_file} {target_path}\"\n121                 subprocess.run(fix_cmd, shell=True, capture_output=True, text=True)\n122 \n",
        "col_offset": 16,
        "end_col_offset": 83,
        "filename": "../GP-PLATFORM/core/james_orchestrator.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 78,
          "link": "https://cwe.mitre.org/data/definitions/78.html"
        },
        "issue_severity": "HIGH",
        "issue_text": "subprocess call with shell=True identified, security issue.",
        "line_number": 121,
        "line_range": [
          121
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html",
        "test_id": "B602",
        "test_name": "subprocess_popen_with_shell_equals_true"
      },
      "iso27001_compliance": {
        "controls": [
          "A.14.2.1",
          "A.14.2.5"
        ],
        "control_name": "Secure development policy / Secure system engineering",
        "domain": "A.14 - System Acquisition, Development and Maintenance",
        "description": "Command injection vulnerabilities indicate lack of input validation in development process",
        "audit_evidence": [
          "Code review logs showing input validation checks",
          "SAST scan results (Bandit/Semgrep) with no command injection",
          "Developer training records on secure coding practices",
          "Documented secure coding standards including input validation"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 8,
        "remediation_guidance": "Use parameterized commands, avoid shell=True, validate all inputs"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1",
          "CC6.6",
          "CC7.2"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls",
          "CC6.6 - Logical Access - Authentication",
          "CC7.2 - System Monitoring - Security Events"
        ],
        "trust_service_category": "Security",
        "description": "Command injection vulnerabilities compromise system security controls",
        "control_objective": "The entity restricts logical access to system resources through authorization and authentication mechanisms",
        "audit_evidence": [
          "Code review documentation showing input validation",
          "SAST scan results (Bandit/Semgrep) demonstrating no command injection",
          "Secure coding training records",
          "Change management logs for security patches"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 8,
        "remediation_guidance": "Implement parameterized commands, avoid shell=True, validate all user inputs"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 5,
      "cross_framework_impact": true
    },
    {
      "id": "bandit_35",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Possible binding to all interfaces.",
      "description": "Possible binding to all interfaces.",
      "file": "../GP-PLATFORM/core/james_ui_integration.py",
      "line": 233,
      "code": "232         app,\n233         host=\"0.0.0.0\",\n234         port=8003,",
      "test_id": "B104",
      "test_name": "hardcoded_bind_all_interfaces",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "f34825ddde1565ee",
      "_original": {
        "code": "232         app,\n233         host=\"0.0.0.0\",\n234         port=8003,\n",
        "col_offset": 13,
        "end_col_offset": 22,
        "filename": "../GP-PLATFORM/core/james_ui_integration.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 605,
          "link": "https://cwe.mitre.org/data/definitions/605.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Possible binding to all interfaces.",
        "line_number": 233,
        "line_range": [
          233
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html",
        "test_id": "B104",
        "test_name": "hardcoded_bind_all_interfaces"
      }
    },
    {
      "id": "bandit_36",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Possible binding to all interfaces.",
      "description": "Possible binding to all interfaces.",
      "file": "../GP-PLATFORM/core/main.py",
      "line": 124,
      "code": "123     import uvicorn\n124     uvicorn.run(app, host=\"0.0.0.0\", port=8000)",
      "test_id": "B104",
      "test_name": "hardcoded_bind_all_interfaces",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "14dcda852e0b81e9",
      "_original": {
        "code": "123     import uvicorn\n124     uvicorn.run(app, host=\"0.0.0.0\", port=8000)\n",
        "col_offset": 26,
        "end_col_offset": 35,
        "filename": "../GP-PLATFORM/core/main.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 605,
          "link": "https://cwe.mitre.org/data/definitions/605.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Possible binding to all interfaces.",
        "line_number": 124,
        "line_range": [
          124
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html",
        "test_id": "B104",
        "test_name": "hardcoded_bind_all_interfaces"
      }
    },
    {
      "id": "bandit_37",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Possible binding to all interfaces.",
      "description": "Possible binding to all interfaces.",
      "file": "../GP-PLATFORM/core/main_working.py",
      "line": 158,
      "code": "157     print(\"\ud83d\ude80 Starting GuidePoint - Ready to scan your projects!\")\n158     uvicorn.run(app, host=\"0.0.0.0\", port=8080)",
      "test_id": "B104",
      "test_name": "hardcoded_bind_all_interfaces",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "8e920a13bf4d5f64",
      "_original": {
        "code": "157     print(\"\ud83d\ude80 Starting GuidePoint - Ready to scan your projects!\")\n158     uvicorn.run(app, host=\"0.0.0.0\", port=8080)\n",
        "col_offset": 26,
        "end_col_offset": 35,
        "filename": "../GP-PLATFORM/core/main_working.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 605,
          "link": "https://cwe.mitre.org/data/definitions/605.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Possible binding to all interfaces.",
        "line_number": 158,
        "line_range": [
          158
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html",
        "test_id": "B104",
        "test_name": "hardcoded_bind_all_interfaces"
      }
    },
    {
      "id": "bandit_38",
      "scanner": "bandit",
      "severity": "CRITICAL",
      "confidence": "HIGH",
      "title": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "description": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "file": "../GP-PLATFORM/model_client/james_mlops_client.py",
      "line": 125,
      "code": "124         }, sort_keys=True)\n125         return hashlib.md5(content.encode()).hexdigest()\n126",
      "test_id": "B324",
      "test_name": "hashlib",
      "cwe": [
        "CWE-327"
      ],
      "scan_timestamp": "20251010_113628",
      "file_hash": "b4b30af769f9a7ee",
      "_original": {
        "code": "124         }, sort_keys=True)\n125         return hashlib.md5(content.encode()).hexdigest()\n126 \n",
        "col_offset": 15,
        "end_col_offset": 44,
        "filename": "../GP-PLATFORM/model_client/james_mlops_client.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 327,
          "link": "https://cwe.mitre.org/data/definitions/327.html"
        },
        "issue_severity": "HIGH",
        "issue_text": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
        "line_number": 125,
        "line_range": [
          125
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html",
        "test_id": "B324",
        "test_name": "hashlib"
      },
      "iso27001_compliance": {
        "controls": [
          "A.10.1.1"
        ],
        "control_name": "Policy on the use of cryptographic controls",
        "domain": "A.10 - Cryptography",
        "description": "Use of broken or risky cryptographic algorithm",
        "audit_evidence": [
          "Only approved algorithms used (AES-256, RSA-2048+, SHA-256+)",
          "No MD5, SHA-1, DES, or weak ciphers in use",
          "Cryptographic standards policy documented",
          "Regular cryptographic algorithm review process"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 6,
        "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use modern encryption algorithms"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls"
        ],
        "trust_service_category": "Security",
        "description": "Weak cryptographic algorithms fail to protect data",
        "control_objective": "The entity uses strong cryptographic algorithms",
        "audit_evidence": [
          "Approved cryptographic algorithm list (AES-256, RSA-2048+, SHA-256+)",
          "No weak algorithms in use (MD5, SHA-1, DES)",
          "Cryptographic standards documentation",
          "Regular algorithm review process"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 6,
        "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use approved algorithms only"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 2,
      "cross_framework_impact": true
    },
    {
      "id": "bandit_39",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Probable insecure usage of temp file/directory.",
      "description": "Probable insecure usage of temp file/directory.",
      "file": "../GP-PLATFORM/scripts/gp_status.py",
      "line": 168,
      "code": "167     print(\"Starting sample workflow...\")\n168     monitor.start_workflow_tracking(workflow_id, \"/tmp/test-project\", 3)\n169",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "62cfe8c28cd53c6d",
      "_original": {
        "code": "167     print(\"Starting sample workflow...\")\n168     monitor.start_workflow_tracking(workflow_id, \"/tmp/test-project\", 3)\n169 \n",
        "col_offset": 49,
        "end_col_offset": 68,
        "filename": "../GP-PLATFORM/scripts/gp_status.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 377,
          "link": "https://cwe.mitre.org/data/definitions/377.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Probable insecure usage of temp file/directory.",
        "line_number": 168,
        "line_range": [
          168
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html",
        "test_id": "B108",
        "test_name": "hardcoded_tmp_directory"
      }
    },
    {
      "id": "bandit_40",
      "scanner": "bandit",
      "severity": "CRITICAL",
      "confidence": "HIGH",
      "title": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "description": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
      "file": "../GP-PLATFORM/workflow/work_order_processor.py",
      "line": 223,
      "code": "222         timestamp = datetime.now().strftime(\"%Y%m%d-%H%M%S\")\n223         random_suffix = hashlib.md5(str(datetime.now().timestamp()).encode()).hexdigest()[:6]\n224         return f\"WO-{timestamp}-{random_suffix}\"",
      "test_id": "B324",
      "test_name": "hashlib",
      "cwe": [
        "CWE-327"
      ],
      "scan_timestamp": "20251010_113628",
      "file_hash": "6b3dcfc5245c1343",
      "_original": {
        "code": "222         timestamp = datetime.now().strftime(\"%Y%m%d-%H%M%S\")\n223         random_suffix = hashlib.md5(str(datetime.now().timestamp()).encode()).hexdigest()[:6]\n224         return f\"WO-{timestamp}-{random_suffix}\"\n",
        "col_offset": 24,
        "end_col_offset": 77,
        "filename": "../GP-PLATFORM/workflow/work_order_processor.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 327,
          "link": "https://cwe.mitre.org/data/definitions/327.html"
        },
        "issue_severity": "HIGH",
        "issue_text": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
        "line_number": 223,
        "line_range": [
          223
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html",
        "test_id": "B324",
        "test_name": "hashlib"
      },
      "iso27001_compliance": {
        "controls": [
          "A.10.1.1"
        ],
        "control_name": "Policy on the use of cryptographic controls",
        "domain": "A.10 - Cryptography",
        "description": "Use of broken or risky cryptographic algorithm",
        "audit_evidence": [
          "Only approved algorithms used (AES-256, RSA-2048+, SHA-256+)",
          "No MD5, SHA-1, DES, or weak ciphers in use",
          "Cryptographic standards policy documented",
          "Regular cryptographic algorithm review process"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 6,
        "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use modern encryption algorithms"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls"
        ],
        "trust_service_category": "Security",
        "description": "Weak cryptographic algorithms fail to protect data",
        "control_objective": "The entity uses strong cryptographic algorithms",
        "audit_evidence": [
          "Approved cryptographic algorithm list (AES-256, RSA-2048+, SHA-256+)",
          "No weak algorithms in use (MD5, SHA-1, DES)",
          "Cryptographic standards documentation",
          "Regular algorithm review process"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 6,
        "remediation_guidance": "Replace MD5/SHA-1 with SHA-256+, use approved algorithms only"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 2,
      "cross_framework_impact": true
    },
    {
      "id": "bandit_41",
      "scanner": "bandit",
      "severity": "HIGH",
      "confidence": "MEDIUM",
      "title": "A Flask app appears to be run with debug=True, which exposes the Werkzeug debugger and allows the execution of arbitrary code.",
      "description": "A Flask app appears to be run with debug=True, which exposes the Werkzeug debugger and allows the execution of arbitrary code.",
      "file": "../GP-PROJECTS/kubernetes-goat/infrastructure/info-app/app.py",
      "line": 11,
      "code": "10 if __name__ == '__main__':\n11     app.run(host='0.0.0.0', port=5000, debug=True)",
      "test_id": "B201",
      "test_name": "flask_debug_true",
      "cwe": [
        "CWE-78"
      ],
      "scan_timestamp": "20251010_113628",
      "file_hash": "ac61748b59191ec1",
      "_original": {
        "code": "10 if __name__ == '__main__':\n11     app.run(host='0.0.0.0', port=5000, debug=True)\n",
        "col_offset": 4,
        "end_col_offset": 50,
        "filename": "../GP-PROJECTS/kubernetes-goat/infrastructure/info-app/app.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 94,
          "link": "https://cwe.mitre.org/data/definitions/94.html"
        },
        "issue_severity": "HIGH",
        "issue_text": "A Flask app appears to be run with debug=True, which exposes the Werkzeug debugger and allows the execution of arbitrary code.",
        "line_number": 11,
        "line_range": [
          11
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b201_flask_debug_true.html",
        "test_id": "B201",
        "test_name": "flask_debug_true"
      },
      "iso27001_compliance": {
        "controls": [
          "A.14.2.1",
          "A.14.2.5"
        ],
        "control_name": "Secure development policy / Secure system engineering",
        "domain": "A.14 - System Acquisition, Development and Maintenance",
        "description": "Command injection vulnerabilities indicate lack of input validation in development process",
        "audit_evidence": [
          "Code review logs showing input validation checks",
          "SAST scan results (Bandit/Semgrep) with no command injection",
          "Developer training records on secure coding practices",
          "Documented secure coding standards including input validation"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 8,
        "remediation_guidance": "Use parameterized commands, avoid shell=True, validate all inputs"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1",
          "CC6.6",
          "CC7.2"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls",
          "CC6.6 - Logical Access - Authentication",
          "CC7.2 - System Monitoring - Security Events"
        ],
        "trust_service_category": "Security",
        "description": "Command injection vulnerabilities compromise system security controls",
        "control_objective": "The entity restricts logical access to system resources through authorization and authentication mechanisms",
        "audit_evidence": [
          "Code review documentation showing input validation",
          "SAST scan results (Bandit/Semgrep) demonstrating no command injection",
          "Secure coding training records",
          "Change management logs for security patches"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 8,
        "remediation_guidance": "Implement parameterized commands, avoid shell=True, validate all user inputs"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 5,
      "cross_framework_impact": true
    },
    {
      "id": "bandit_42",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Possible binding to all interfaces.",
      "description": "Possible binding to all interfaces.",
      "file": "../GP-PROJECTS/kubernetes-goat/infrastructure/info-app/app.py",
      "line": 11,
      "code": "10 if __name__ == '__main__':\n11     app.run(host='0.0.0.0', port=5000, debug=True)",
      "test_id": "B104",
      "test_name": "hardcoded_bind_all_interfaces",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "ac61748b59191ec1",
      "_original": {
        "code": "10 if __name__ == '__main__':\n11     app.run(host='0.0.0.0', port=5000, debug=True)\n",
        "col_offset": 17,
        "end_col_offset": 26,
        "filename": "../GP-PROJECTS/kubernetes-goat/infrastructure/info-app/app.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 605,
          "link": "https://cwe.mitre.org/data/definitions/605.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Possible binding to all interfaces.",
        "line_number": 11,
        "line_range": [
          11
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html",
        "test_id": "B104",
        "test_name": "hardcoded_bind_all_interfaces"
      }
    },
    {
      "id": "bandit_43",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "LOW",
      "title": "Call to requests without timeout",
      "description": "Call to requests without timeout",
      "file": "../GP-PROJECTS/kubernetes-goat/infrastructure/users-repo/app.py",
      "line": 16,
      "code": "15     headers = {\"secret-api-key\": API_KEY}\n16     r = requests.get(\n17         \"https://api.github.com/users/\" + user_name + \"/repos\", headers=headers\n18     )\n19     return print(json.dumps(r.json(), indent=2))",
      "test_id": "B113",
      "test_name": "request_without_timeout",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "6c5b7512e72c5c33",
      "_original": {
        "code": "15     headers = {\"secret-api-key\": API_KEY}\n16     r = requests.get(\n17         \"https://api.github.com/users/\" + user_name + \"/repos\", headers=headers\n18     )\n19     return print(json.dumps(r.json(), indent=2))\n",
        "col_offset": 8,
        "end_col_offset": 5,
        "filename": "../GP-PROJECTS/kubernetes-goat/infrastructure/users-repo/app.py",
        "issue_confidence": "LOW",
        "issue_cwe": {
          "id": 400,
          "link": "https://cwe.mitre.org/data/definitions/400.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Call to requests without timeout",
        "line_number": 16,
        "line_range": [
          16,
          17,
          18
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b113_request_without_timeout.html",
        "test_id": "B113",
        "test_name": "request_without_timeout"
      }
    },
    {
      "id": "bandit_44",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "title": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "description": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "file": "../GP-RAG/core/jade_engine.py",
      "line": 98,
      "code": "97 \n98             tokenizer = AutoTokenizer.from_pretrained(\n99                 model_name,\n100                 trust_remote_code=True\n101             )\n102",
      "test_id": "B615",
      "test_name": "huggingface_unsafe_download",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "e21d7945cf5feab8",
      "_original": {
        "code": "97 \n98             tokenizer = AutoTokenizer.from_pretrained(\n99                 model_name,\n100                 trust_remote_code=True\n101             )\n102 \n",
        "col_offset": 24,
        "end_col_offset": 13,
        "filename": "../GP-RAG/core/jade_engine.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 494,
          "link": "https://cwe.mitre.org/data/definitions/494.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
        "line_number": 98,
        "line_range": [
          98,
          99,
          100,
          101
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html",
        "test_id": "B615",
        "test_name": "huggingface_unsafe_download"
      }
    },
    {
      "id": "bandit_45",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "title": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "description": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "file": "../GP-RAG/core/jade_engine.py",
      "line": 103,
      "code": "102 \n103             model = AutoModelForCausalLM.from_pretrained(\n104                 model_name,\n105                 torch_dtype=torch.bfloat16,\n106                 device_map=\"auto\",\n107                 trust_remote_code=True,\n108                 low_cpu_mem_usage=True\n109             )\n110",
      "test_id": "B615",
      "test_name": "huggingface_unsafe_download",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "e21d7945cf5feab8",
      "_original": {
        "code": "102 \n103             model = AutoModelForCausalLM.from_pretrained(\n104                 model_name,\n105                 torch_dtype=torch.bfloat16,\n106                 device_map=\"auto\",\n107                 trust_remote_code=True,\n108                 low_cpu_mem_usage=True\n109             )\n110 \n",
        "col_offset": 20,
        "end_col_offset": 13,
        "filename": "../GP-RAG/core/jade_engine.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 494,
          "link": "https://cwe.mitre.org/data/definitions/494.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
        "line_number": 103,
        "line_range": [
          103,
          104,
          105,
          106,
          107,
          108,
          109
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html",
        "test_id": "B615",
        "test_name": "huggingface_unsafe_download"
      }
    },
    {
      "id": "bandit_46",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "title": "Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.",
      "description": "Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.",
      "file": "../GP-RAG/graph_ingest_knowledge.py",
      "line": 56,
      "code": "55             with open(self.graph_file, 'rb') as f:\n56                 data = pickle.load(f)\n57                 self.graph = data['graph']",
      "test_id": "B301",
      "test_name": "blacklist",
      "cwe": [
        "CWE-502"
      ],
      "scan_timestamp": "20251010_113628",
      "file_hash": "0f6fcb4ebd83b9e5",
      "_original": {
        "code": "55             with open(self.graph_file, 'rb') as f:\n56                 data = pickle.load(f)\n57                 self.graph = data['graph']\n",
        "col_offset": 23,
        "end_col_offset": 37,
        "filename": "../GP-RAG/graph_ingest_knowledge.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 502,
          "link": "https://cwe.mitre.org/data/definitions/502.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.",
        "line_number": 56,
        "line_range": [
          56
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle",
        "test_id": "B301",
        "test_name": "blacklist"
      },
      "iso27001_compliance": {
        "controls": [
          "A.14.2.1",
          "A.14.2.8"
        ],
        "control_name": "Secure development policy / System security testing",
        "domain": "A.14 - System Acquisition, Development and Maintenance",
        "description": "Insecure deserialization allows arbitrary code execution",
        "audit_evidence": [
          "No pickle/yaml.unsafe_load usage with untrusted data",
          "JSON used for serialization where possible",
          "Input validation on all deserialized data",
          "Deserialization security review documentation"
        ],
        "remediation_priority": "CRITICAL",
        "estimated_effort_hours": 8,
        "remediation_guidance": "Avoid pickle with untrusted data, use JSON, validate deserialized objects"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1",
          "CC7.2"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls",
          "CC7.2 - System Monitoring - Security Events"
        ],
        "trust_service_category": "Security",
        "description": "Insecure deserialization allows remote code execution",
        "control_objective": "The entity validates and sanitizes all deserialized data",
        "audit_evidence": [
          "No pickle usage with untrusted data",
          "JSON used for serialization",
          "Input validation on deserialized objects",
          "Security testing results"
        ],
        "remediation_priority": "CRITICAL",
        "estimated_effort_hours": 8,
        "remediation_guidance": "Avoid pickle with untrusted data, use JSON, validate all deserialized data"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 4,
      "cross_framework_impact": true
    },
    {
      "id": "bandit_47",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "title": "Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.",
      "description": "Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.",
      "file": "../GP-RAG/ingest_scan_results.py",
      "line": 64,
      "code": "63             with open(self.graph_file, 'rb') as f:\n64                 data = pickle.load(f)\n65                 self.graph = data['graph']",
      "test_id": "B301",
      "test_name": "blacklist",
      "cwe": [
        "CWE-502"
      ],
      "scan_timestamp": "20251010_113628",
      "file_hash": "8be95e41689ca268",
      "_original": {
        "code": "63             with open(self.graph_file, 'rb') as f:\n64                 data = pickle.load(f)\n65                 self.graph = data['graph']\n",
        "col_offset": 23,
        "end_col_offset": 37,
        "filename": "../GP-RAG/ingest_scan_results.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 502,
          "link": "https://cwe.mitre.org/data/definitions/502.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.",
        "line_number": 64,
        "line_range": [
          64
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle",
        "test_id": "B301",
        "test_name": "blacklist"
      },
      "iso27001_compliance": {
        "controls": [
          "A.14.2.1",
          "A.14.2.8"
        ],
        "control_name": "Secure development policy / System security testing",
        "domain": "A.14 - System Acquisition, Development and Maintenance",
        "description": "Insecure deserialization allows arbitrary code execution",
        "audit_evidence": [
          "No pickle/yaml.unsafe_load usage with untrusted data",
          "JSON used for serialization where possible",
          "Input validation on all deserialized data",
          "Deserialization security review documentation"
        ],
        "remediation_priority": "CRITICAL",
        "estimated_effort_hours": 8,
        "remediation_guidance": "Avoid pickle with untrusted data, use JSON, validate deserialized objects"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1",
          "CC7.2"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls",
          "CC7.2 - System Monitoring - Security Events"
        ],
        "trust_service_category": "Security",
        "description": "Insecure deserialization allows remote code execution",
        "control_objective": "The entity validates and sanitizes all deserialized data",
        "audit_evidence": [
          "No pickle usage with untrusted data",
          "JSON used for serialization",
          "Input validation on deserialized objects",
          "Security testing results"
        ],
        "remediation_priority": "CRITICAL",
        "estimated_effort_hours": 8,
        "remediation_guidance": "Avoid pickle with untrusted data, use JSON, validate all deserialized data"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 4,
      "cross_framework_impact": true
    },
    {
      "id": "bandit_48",
      "scanner": "bandit",
      "severity": "HIGH",
      "confidence": "MEDIUM",
      "title": "A Flask app appears to be run with debug=True, which exposes the Werkzeug debugger and allows the execution of arbitrary code.",
      "description": "A Flask app appears to be run with debug=True, which exposes the Werkzeug debugger and allows the execution of arbitrary code.",
      "file": "../GP-RAG/jade_api.py",
      "line": 331,
      "code": "330         print(\"\ud83d\udcda API docs: http://localhost:5000/api/status\")\n331         app.run(host='0.0.0.0', port=5000, debug=True)\n332     else:",
      "test_id": "B201",
      "test_name": "flask_debug_true",
      "cwe": [
        "CWE-78"
      ],
      "scan_timestamp": "20251010_113628",
      "file_hash": "cbf2884c992cd4c9",
      "_original": {
        "code": "330         print(\"\ud83d\udcda API docs: http://localhost:5000/api/status\")\n331         app.run(host='0.0.0.0', port=5000, debug=True)\n332     else:\n",
        "col_offset": 8,
        "end_col_offset": 54,
        "filename": "../GP-RAG/jade_api.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 94,
          "link": "https://cwe.mitre.org/data/definitions/94.html"
        },
        "issue_severity": "HIGH",
        "issue_text": "A Flask app appears to be run with debug=True, which exposes the Werkzeug debugger and allows the execution of arbitrary code.",
        "line_number": 331,
        "line_range": [
          331
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b201_flask_debug_true.html",
        "test_id": "B201",
        "test_name": "flask_debug_true"
      },
      "iso27001_compliance": {
        "controls": [
          "A.14.2.1",
          "A.14.2.5"
        ],
        "control_name": "Secure development policy / Secure system engineering",
        "domain": "A.14 - System Acquisition, Development and Maintenance",
        "description": "Command injection vulnerabilities indicate lack of input validation in development process",
        "audit_evidence": [
          "Code review logs showing input validation checks",
          "SAST scan results (Bandit/Semgrep) with no command injection",
          "Developer training records on secure coding practices",
          "Documented secure coding standards including input validation"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 8,
        "remediation_guidance": "Use parameterized commands, avoid shell=True, validate all inputs"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1",
          "CC6.6",
          "CC7.2"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls",
          "CC6.6 - Logical Access - Authentication",
          "CC7.2 - System Monitoring - Security Events"
        ],
        "trust_service_category": "Security",
        "description": "Command injection vulnerabilities compromise system security controls",
        "control_objective": "The entity restricts logical access to system resources through authorization and authentication mechanisms",
        "audit_evidence": [
          "Code review documentation showing input validation",
          "SAST scan results (Bandit/Semgrep) demonstrating no command injection",
          "Secure coding training records",
          "Change management logs for security patches"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 8,
        "remediation_guidance": "Implement parameterized commands, avoid shell=True, validate all user inputs"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 5,
      "cross_framework_impact": true
    },
    {
      "id": "bandit_49",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Possible binding to all interfaces.",
      "description": "Possible binding to all interfaces.",
      "file": "../GP-RAG/jade_api.py",
      "line": 331,
      "code": "330         print(\"\ud83d\udcda API docs: http://localhost:5000/api/status\")\n331         app.run(host='0.0.0.0', port=5000, debug=True)\n332     else:",
      "test_id": "B104",
      "test_name": "hardcoded_bind_all_interfaces",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "cbf2884c992cd4c9",
      "_original": {
        "code": "330         print(\"\ud83d\udcda API docs: http://localhost:5000/api/status\")\n331         app.run(host='0.0.0.0', port=5000, debug=True)\n332     else:\n",
        "col_offset": 21,
        "end_col_offset": 30,
        "filename": "../GP-RAG/jade_api.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 605,
          "link": "https://cwe.mitre.org/data/definitions/605.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Possible binding to all interfaces.",
        "line_number": 331,
        "line_range": [
          331
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html",
        "test_id": "B104",
        "test_name": "hardcoded_bind_all_interfaces"
      }
    },
    {
      "id": "bandit_50",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "title": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "description": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "file": "../GP-RAG/jade_rag_langgraph.py",
      "line": 114,
      "code": "113 \n114             tokenizer = AutoTokenizer.from_pretrained(\n115                 model_name,\n116                 trust_remote_code=True\n117             )\n118",
      "test_id": "B615",
      "test_name": "huggingface_unsafe_download",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "313b7811dcd7d308",
      "_original": {
        "code": "113 \n114             tokenizer = AutoTokenizer.from_pretrained(\n115                 model_name,\n116                 trust_remote_code=True\n117             )\n118 \n",
        "col_offset": 24,
        "end_col_offset": 13,
        "filename": "../GP-RAG/jade_rag_langgraph.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 494,
          "link": "https://cwe.mitre.org/data/definitions/494.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
        "line_number": 114,
        "line_range": [
          114,
          115,
          116,
          117
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html",
        "test_id": "B615",
        "test_name": "huggingface_unsafe_download"
      }
    },
    {
      "id": "bandit_51",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "title": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "description": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "file": "../GP-RAG/jade_rag_langgraph.py",
      "line": 119,
      "code": "118 \n119             model = AutoModelForCausalLM.from_pretrained(\n120                 model_name,\n121                 torch_dtype=torch.bfloat16,\n122                 device_map=\"auto\",\n123                 trust_remote_code=True,\n124                 low_cpu_mem_usage=True\n125             )\n126",
      "test_id": "B615",
      "test_name": "huggingface_unsafe_download",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "313b7811dcd7d308",
      "_original": {
        "code": "118 \n119             model = AutoModelForCausalLM.from_pretrained(\n120                 model_name,\n121                 torch_dtype=torch.bfloat16,\n122                 device_map=\"auto\",\n123                 trust_remote_code=True,\n124                 low_cpu_mem_usage=True\n125             )\n126 \n",
        "col_offset": 20,
        "end_col_offset": 13,
        "filename": "../GP-RAG/jade_rag_langgraph.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 494,
          "link": "https://cwe.mitre.org/data/definitions/494.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
        "line_number": 119,
        "line_range": [
          119,
          120,
          121,
          122,
          123,
          124,
          125
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html",
        "test_id": "B615",
        "test_name": "huggingface_unsafe_download"
      }
    },
    {
      "id": "bandit_52",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Probable insecure usage of temp file/directory.",
      "description": "Probable insecure usage of temp file/directory.",
      "file": "../GP-TESTING-VAL/demos/demonstrate_gatekeeper.py",
      "line": 43,
      "code": "42     # Save insecure manifest\n43     insecure_path = Path(\"/tmp/insecure-nginx.yaml\")\n44     with open(insecure_path, 'w') as f:",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "84a5343e3814467a",
      "_original": {
        "code": "42     # Save insecure manifest\n43     insecure_path = Path(\"/tmp/insecure-nginx.yaml\")\n44     with open(insecure_path, 'w') as f:\n",
        "col_offset": 25,
        "end_col_offset": 51,
        "filename": "../GP-TESTING-VAL/demos/demonstrate_gatekeeper.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 377,
          "link": "https://cwe.mitre.org/data/definitions/377.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Probable insecure usage of temp file/directory.",
        "line_number": 43,
        "line_range": [
          43
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html",
        "test_id": "B108",
        "test_name": "hardcoded_tmp_directory"
      }
    },
    {
      "id": "bandit_53",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Probable insecure usage of temp file/directory.",
      "description": "Probable insecure usage of temp file/directory.",
      "file": "../GP-TESTING-VAL/demos/demonstrate_gatekeeper.py",
      "line": 71,
      "code": "70     # Step 4: Show fixed manifest\n71     fixed_path = Path(\"/tmp/fixed_insecure-nginx.yaml\")\n72     if fixed_path.exists():",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "84a5343e3814467a",
      "_original": {
        "code": "70     # Step 4: Show fixed manifest\n71     fixed_path = Path(\"/tmp/fixed_insecure-nginx.yaml\")\n72     if fixed_path.exists():\n",
        "col_offset": 22,
        "end_col_offset": 54,
        "filename": "../GP-TESTING-VAL/demos/demonstrate_gatekeeper.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 377,
          "link": "https://cwe.mitre.org/data/definitions/377.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Probable insecure usage of temp file/directory.",
        "line_number": 71,
        "line_range": [
          71
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html",
        "test_id": "B108",
        "test_name": "hardcoded_tmp_directory"
      }
    },
    {
      "id": "bandit_54",
      "scanner": "bandit",
      "severity": "CRITICAL",
      "confidence": "HIGH",
      "title": "subprocess call with shell=True identified, security issue.",
      "description": "subprocess call with shell=True identified, security issue.",
      "file": "../GP-TESTING-VAL/jade_chat_tests.py",
      "line": 29,
      "code": "28                 f'echo \"{command}\" | timeout {timeout} python3 {self.jade_chat_path}',\n29                 shell=True,\n30                 cwd=str(self.gp_copilot_root),\n31                 capture_output=True,\n32                 text=True,\n33                 timeout=timeout + 5\n34             )\n35 \n36             return {\n37                 'success': True,",
      "test_id": "B602",
      "test_name": "subprocess_popen_with_shell_equals_true",
      "cwe": [
        "CWE-78"
      ],
      "scan_timestamp": "20251010_113628",
      "file_hash": "d5eca67240143253",
      "_original": {
        "code": "28                 f'echo \"{command}\" | timeout {timeout} python3 {self.jade_chat_path}',\n29                 shell=True,\n30                 cwd=str(self.gp_copilot_root),\n31                 capture_output=True,\n32                 text=True,\n33                 timeout=timeout + 5\n34             )\n35 \n36             return {\n37                 'success': True,\n",
        "col_offset": 21,
        "end_col_offset": 13,
        "filename": "../GP-TESTING-VAL/jade_chat_tests.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 78,
          "link": "https://cwe.mitre.org/data/definitions/78.html"
        },
        "issue_severity": "HIGH",
        "issue_text": "subprocess call with shell=True identified, security issue.",
        "line_number": 29,
        "line_range": [
          27,
          28,
          29,
          30,
          31,
          32,
          33,
          34
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html",
        "test_id": "B602",
        "test_name": "subprocess_popen_with_shell_equals_true"
      },
      "iso27001_compliance": {
        "controls": [
          "A.14.2.1",
          "A.14.2.5"
        ],
        "control_name": "Secure development policy / Secure system engineering",
        "domain": "A.14 - System Acquisition, Development and Maintenance",
        "description": "Command injection vulnerabilities indicate lack of input validation in development process",
        "audit_evidence": [
          "Code review logs showing input validation checks",
          "SAST scan results (Bandit/Semgrep) with no command injection",
          "Developer training records on secure coding practices",
          "Documented secure coding standards including input validation"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 8,
        "remediation_guidance": "Use parameterized commands, avoid shell=True, validate all inputs"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1",
          "CC6.6",
          "CC7.2"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls",
          "CC6.6 - Logical Access - Authentication",
          "CC7.2 - System Monitoring - Security Events"
        ],
        "trust_service_category": "Security",
        "description": "Command injection vulnerabilities compromise system security controls",
        "control_objective": "The entity restricts logical access to system resources through authorization and authentication mechanisms",
        "audit_evidence": [
          "Code review documentation showing input validation",
          "SAST scan results (Bandit/Semgrep) demonstrating no command injection",
          "Secure coding training records",
          "Change management logs for security patches"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 8,
        "remediation_guidance": "Implement parameterized commands, avoid shell=True, validate all user inputs"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 5,
      "cross_framework_impact": true
    },
    {
      "id": "bandit_55",
      "scanner": "bandit",
      "severity": "CRITICAL",
      "confidence": "HIGH",
      "title": "subprocess call with shell=True identified, security issue.",
      "description": "subprocess call with shell=True identified, security issue.",
      "file": "../GP-TESTING-VAL/jade_knowledge_tests.py",
      "line": 29,
      "code": "28                 f'echo \"{command}\" | timeout {timeout} python3 {self.jade_chat_path}',\n29                 shell=True,\n30                 cwd=str(self.gp_copilot_root),\n31                 capture_output=True,\n32                 text=True,\n33                 timeout=timeout + 5\n34             )\n35 \n36             return {\n37                 'success': True,",
      "test_id": "B602",
      "test_name": "subprocess_popen_with_shell_equals_true",
      "cwe": [
        "CWE-78"
      ],
      "scan_timestamp": "20251010_113628",
      "file_hash": "f4ca86ea694d3542",
      "_original": {
        "code": "28                 f'echo \"{command}\" | timeout {timeout} python3 {self.jade_chat_path}',\n29                 shell=True,\n30                 cwd=str(self.gp_copilot_root),\n31                 capture_output=True,\n32                 text=True,\n33                 timeout=timeout + 5\n34             )\n35 \n36             return {\n37                 'success': True,\n",
        "col_offset": 21,
        "end_col_offset": 13,
        "filename": "../GP-TESTING-VAL/jade_knowledge_tests.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 78,
          "link": "https://cwe.mitre.org/data/definitions/78.html"
        },
        "issue_severity": "HIGH",
        "issue_text": "subprocess call with shell=True identified, security issue.",
        "line_number": 29,
        "line_range": [
          27,
          28,
          29,
          30,
          31,
          32,
          33,
          34
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html",
        "test_id": "B602",
        "test_name": "subprocess_popen_with_shell_equals_true"
      },
      "iso27001_compliance": {
        "controls": [
          "A.14.2.1",
          "A.14.2.5"
        ],
        "control_name": "Secure development policy / Secure system engineering",
        "domain": "A.14 - System Acquisition, Development and Maintenance",
        "description": "Command injection vulnerabilities indicate lack of input validation in development process",
        "audit_evidence": [
          "Code review logs showing input validation checks",
          "SAST scan results (Bandit/Semgrep) with no command injection",
          "Developer training records on secure coding practices",
          "Documented secure coding standards including input validation"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 8,
        "remediation_guidance": "Use parameterized commands, avoid shell=True, validate all inputs"
      },
      "soc2_compliance": {
        "criteria": [
          "CC6.1",
          "CC6.6",
          "CC7.2"
        ],
        "criteria_names": [
          "CC6.1 - Logical and Physical Access Controls",
          "CC6.6 - Logical Access - Authentication",
          "CC7.2 - System Monitoring - Security Events"
        ],
        "trust_service_category": "Security",
        "description": "Command injection vulnerabilities compromise system security controls",
        "control_objective": "The entity restricts logical access to system resources through authorization and authentication mechanisms",
        "audit_evidence": [
          "Code review documentation showing input validation",
          "SAST scan results (Bandit/Semgrep) demonstrating no command injection",
          "Secure coding training records",
          "Change management logs for security patches"
        ],
        "remediation_priority": "HIGH",
        "estimated_effort_hours": 8,
        "remediation_guidance": "Implement parameterized commands, avoid shell=True, validate all user inputs"
      },
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "total_controls_affected": 5,
      "cross_framework_impact": true
    },
    {
      "id": "bandit_56",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "MEDIUM",
      "title": "Probable insecure usage of temp file/directory.",
      "description": "Probable insecure usage of temp file/directory.",
      "file": "../GP-TESTING-VAL/test_portfolio_scan.py",
      "line": 19,
      "code": "18 \n19     portfolio_dir = \"/tmp/portfolio_test\"\n20",
      "test_id": "B108",
      "test_name": "hardcoded_tmp_directory",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "1e27f14c4c899905",
      "_original": {
        "code": "18 \n19     portfolio_dir = \"/tmp/portfolio_test\"\n20 \n",
        "col_offset": 20,
        "end_col_offset": 41,
        "filename": "../GP-TESTING-VAL/test_portfolio_scan.py",
        "issue_confidence": "MEDIUM",
        "issue_cwe": {
          "id": 377,
          "link": "https://cwe.mitre.org/data/definitions/377.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Probable insecure usage of temp file/directory.",
        "line_number": 19,
        "line_range": [
          19
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html",
        "test_id": "B108",
        "test_name": "hardcoded_tmp_directory"
      }
    },
    {
      "id": "bandit_57",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "title": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "description": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "file": "../test_deepseek.py",
      "line": 17,
      "code": "16 # Load tokenizer\n17 tokenizer = AutoTokenizer.from_pretrained(model_name, trust_remote_code=True)\n18",
      "test_id": "B615",
      "test_name": "huggingface_unsafe_download",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "57e94e65af47a199",
      "_original": {
        "code": "16 # Load tokenizer\n17 tokenizer = AutoTokenizer.from_pretrained(model_name, trust_remote_code=True)\n18 \n",
        "col_offset": 12,
        "end_col_offset": 77,
        "filename": "../test_deepseek.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 494,
          "link": "https://cwe.mitre.org/data/definitions/494.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
        "line_number": 17,
        "line_range": [
          17
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html",
        "test_id": "B615",
        "test_name": "huggingface_unsafe_download"
      }
    },
    {
      "id": "bandit_58",
      "scanner": "bandit",
      "severity": "MEDIUM",
      "confidence": "HIGH",
      "title": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "description": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
      "file": "../test_deepseek.py",
      "line": 29,
      "code": "28 print(\"\ud83d\udce6 Loading model with 4-bit quantization...\")\n29 model = AutoModelForCausalLM.from_pretrained(\n30     model_name,\n31     torch_dtype=torch.float16,\n32     device_map=\"auto\",\n33     trust_remote_code=True,\n34     quantization_config=quantization_config,\n35     low_cpu_mem_usage=True\n36 )\n37",
      "test_id": "B615",
      "test_name": "huggingface_unsafe_download",
      "cwe": [],
      "scan_timestamp": "20251010_113628",
      "file_hash": "57e94e65af47a199",
      "_original": {
        "code": "28 print(\"\ud83d\udce6 Loading model with 4-bit quantization...\")\n29 model = AutoModelForCausalLM.from_pretrained(\n30     model_name,\n31     torch_dtype=torch.float16,\n32     device_map=\"auto\",\n33     trust_remote_code=True,\n34     quantization_config=quantization_config,\n35     low_cpu_mem_usage=True\n36 )\n37 \n",
        "col_offset": 8,
        "end_col_offset": 1,
        "filename": "../test_deepseek.py",
        "issue_confidence": "HIGH",
        "issue_cwe": {
          "id": 494,
          "link": "https://cwe.mitre.org/data/definitions/494.html"
        },
        "issue_severity": "MEDIUM",
        "issue_text": "Unsafe Hugging Face Hub download without revision pinning in from_pretrained()",
        "line_number": 29,
        "line_range": [
          29,
          30,
          31,
          32,
          33,
          34,
          35,
          36
        ],
        "more_info": "https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html",
        "test_id": "B615",
        "test_name": "huggingface_unsafe_download"
      }
    },
    {
      "id": "trivy_misconfig_1",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0057",
      "check_type": "Terraform Security Check",
      "title": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
      "severity": "HIGH",
      "file": "iam.tf",
      "line": 185,
      "end_line": 185,
      "message": "IAM policy document uses sensitive action 'kms:Decrypt' on wildcarded resource 'arn:aws:kms:*:*:key/*'",
      "description": "You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.",
      "remediation": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
      "provider": "AWS",
      "service": "iam",
      "references": [
        "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0057"
      ],
      "scan_timestamp": "20251010_115942",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0057",
        "AVDID": "AVD-AWS-0057",
        "Title": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
        "Description": "You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.",
        "Message": "IAM policy document uses sensitive action 'kms:Decrypt' on wildcarded resource 'arn:aws:kms:*:*:key/*'",
        "Query": "data..",
        "Resolution": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0057",
        "References": [
          "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0057"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_iam_role_policy.app_kms",
          "Provider": "AWS",
          "Service": "iam",
          "StartLine": 185,
          "EndLine": 185,
          "Code": {
            "Lines": [
              {
                "Number": 180,
                "Content": "resource \"aws_iam_role_policy\" \"app_kms\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_iam_role_policy\"\u001b[0m \u001b[38;5;37m\"app_kms\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 181,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 185,
                "Content": "    Version = \"2012-10-17\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mVersion\u001b[0m = \u001b[38;5;37m\"2012-10-17\"",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 208,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 209,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "aws_iam_role_policy.app_kms.policy",
              "Filename": "iam.tf",
              "Location": {
                "StartLine": 185,
                "EndLine": 185
              }
            },
            {
              "Resource": "aws_iam_role_policy.app_kms.policy",
              "Filename": "iam.tf",
              "Location": {
                "StartLine": 184,
                "EndLine": 208
              }
            },
            {
              "Resource": "aws_iam_role_policy.app_kms",
              "Filename": "iam.tf",
              "Location": {
                "StartLine": 180,
                "EndLine": 209
              }
            }
          ]
        }
      }
    },
    {
      "id": "trivy_misconfig_2",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0089",
      "check_type": "Terraform Security Check",
      "title": "S3 Bucket Logging",
      "severity": "LOW",
      "file": "s3.tf",
      "line": 88,
      "end_line": 97,
      "message": "Bucket has logging disabled",
      "description": "Ensures S3 bucket logging is enabled for S3 buckets",
      "remediation": "Add a logging block to the resource to enable access logging",
      "provider": "AWS",
      "service": "s3",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0089"
      ],
      "scan_timestamp": "20251010_115942",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0089",
        "AVDID": "AVD-AWS-0089",
        "Title": "S3 Bucket Logging",
        "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
        "Message": "Bucket has logging disabled",
        "Namespace": "builtin.aws.s3.aws0089",
        "Query": "data.builtin.aws.s3.aws0089.deny",
        "Resolution": "Add a logging block to the resource to enable access logging",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0089",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0089"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_s3_bucket.audit_logs",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 88,
          "EndLine": 97,
          "Code": {
            "Lines": [
              {
                "Number": 88,
                "Content": "resource \"aws_s3_bucket\" \"audit_logs\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"audit_logs\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 89,
                "Content": "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-audit-logs\" : \"${var.project_name}-audit-logs-${var.environment}-${data.aws_caller_identity.current.account_id}\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;33mvar\u001b[0m.\u001b[38;5;245mdeployment_target\u001b[0m =\u001b[38;5;245m=\u001b[0m \u001b[38;5;37m\"localstack\"\u001b[0m \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-audit-logs\"\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-audit-logs-\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.environment\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.aws_caller_identity.current.account_id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 90,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 91,
                "Content": "  force_destroy = true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 92,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 93,
                "Content": "  tags = {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 94,
                "Content": "    Name     = \"Audit Logs\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m     = \u001b[38;5;37m\"Audit Logs\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 95,
                "Content": "    Contains = \"PCI Audit Logs\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mContains\u001b[0m = \u001b[38;5;37m\"PCI Audit Logs\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 96,
                "Content": "  }",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  }",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 97,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_3",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0090",
      "check_type": "Terraform Security Check",
      "title": "S3 Data should be versioned",
      "severity": "MEDIUM",
      "file": "s3.tf",
      "line": 88,
      "end_line": 97,
      "message": "Bucket does not have versioning enabled",
      "description": "\nVersioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket. \nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets. \nWith versioning you can recover more easily from both unintended user actions and application failures.\n",
      "remediation": "Enable versioning to protect against accidental/malicious removal or modification",
      "provider": "AWS",
      "service": "s3",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0090"
      ],
      "scan_timestamp": "20251010_115942",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0090",
        "AVDID": "AVD-AWS-0090",
        "Title": "S3 Data should be versioned",
        "Description": "\nVersioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket. \nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets. \nWith versioning you can recover more easily from both unintended user actions and application failures.\n",
        "Message": "Bucket does not have versioning enabled",
        "Query": "data..",
        "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0090"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_s3_bucket.audit_logs",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 88,
          "EndLine": 97,
          "Code": {
            "Lines": [
              {
                "Number": 88,
                "Content": "resource \"aws_s3_bucket\" \"audit_logs\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"audit_logs\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 89,
                "Content": "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-audit-logs\" : \"${var.project_name}-audit-logs-${var.environment}-${data.aws_caller_identity.current.account_id}\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;33mvar\u001b[0m.\u001b[38;5;245mdeployment_target\u001b[0m =\u001b[38;5;245m=\u001b[0m \u001b[38;5;37m\"localstack\"\u001b[0m \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-audit-logs\"\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-audit-logs-\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.environment\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.aws_caller_identity.current.account_id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 90,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 91,
                "Content": "  force_destroy = true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 92,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 93,
                "Content": "  tags = {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 94,
                "Content": "    Name     = \"Audit Logs\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m     = \u001b[38;5;37m\"Audit Logs\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 95,
                "Content": "    Contains = \"PCI Audit Logs\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mContains\u001b[0m = \u001b[38;5;37m\"PCI Audit Logs\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 96,
                "Content": "  }",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  }",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 97,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_4",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0098",
      "check_type": "Terraform Security Check",
      "title": "Secrets Manager should use customer managed keys",
      "severity": "LOW",
      "file": "secrets-manager.tf",
      "line": 9,
      "end_line": 22,
      "message": "Secret explicitly uses the default key.",
      "description": "Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.",
      "remediation": "Use customer managed keys",
      "provider": "AWS",
      "service": "ssm",
      "references": [
        "https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt",
        "https://avd.aquasec.com/misconfig/avd-aws-0098"
      ],
      "scan_timestamp": "20251010_115942",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0098",
        "AVDID": "AVD-AWS-0098",
        "Title": "Secrets Manager should use customer managed keys",
        "Description": "Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.",
        "Message": "Secret explicitly uses the default key.",
        "Query": "data..",
        "Resolution": "Use customer managed keys",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0098",
        "References": [
          "https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt",
          "https://avd.aquasec.com/misconfig/avd-aws-0098"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_secretsmanager_secret.db_password",
          "Provider": "AWS",
          "Service": "ssm",
          "StartLine": 9,
          "EndLine": 22,
          "Code": {
            "Lines": [
              {
                "Number": 9,
                "Content": "resource \"aws_secretsmanager_secret\" \"db_password\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_secretsmanager_secret\"\u001b[0m \u001b[38;5;37m\"db_password\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 10,
                "Content": "  name                    = \"${var.project_name}/db/password\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m                    = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m/db/password\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 11,
                "Content": "  description             = \"Database password for SecureBank\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m             = \u001b[38;5;37m\"Database password for SecureBank\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 12,
                "Content": "  recovery_window_in_days = 0  # \u274c Immediate deletion, no recovery!",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mrecovery_window_in_days\u001b[0m = \u001b[38;5;37m0\u001b[0m\u001b[38;5;239m  # \u274c Immediate deletion, no recovery!",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 13,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 14,
                "Content": "  # \u274c PCI 8.2.4: No automatic rotation",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  # \u274c PCI 8.2.4: No automatic rotation",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 15,
                "Content": "  # rotation_rules {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  # rotation_rules {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 16,
                "Content": "  #   automatically_after_days = 90",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  #   automatically_after_days = 90",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 17,
                "Content": "  # }",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  # }",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 18,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_5",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0098",
      "check_type": "Terraform Security Check",
      "title": "Secrets Manager should use customer managed keys",
      "severity": "LOW",
      "file": "secrets-manager.tf",
      "line": 39,
      "end_line": 46,
      "message": "Secret explicitly uses the default key.",
      "description": "Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.",
      "remediation": "Use customer managed keys",
      "provider": "AWS",
      "service": "ssm",
      "references": [
        "https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt",
        "https://avd.aquasec.com/misconfig/avd-aws-0098"
      ],
      "scan_timestamp": "20251010_115942",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0098",
        "AVDID": "AVD-AWS-0098",
        "Title": "Secrets Manager should use customer managed keys",
        "Description": "Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.",
        "Message": "Secret explicitly uses the default key.",
        "Query": "data..",
        "Resolution": "Use customer managed keys",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0098",
        "References": [
          "https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt",
          "https://avd.aquasec.com/misconfig/avd-aws-0098"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_secretsmanager_secret.jwt_secret",
          "Provider": "AWS",
          "Service": "ssm",
          "StartLine": 39,
          "EndLine": 46,
          "Code": {
            "Lines": [
              {
                "Number": 39,
                "Content": "resource \"aws_secretsmanager_secret\" \"jwt_secret\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_secretsmanager_secret\"\u001b[0m \u001b[38;5;37m\"jwt_secret\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 40,
                "Content": "  name                    = \"${var.project_name}/jwt/secret\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m                    = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m/jwt/secret\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 41,
                "Content": "  recovery_window_in_days = 0",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mrecovery_window_in_days\u001b[0m = \u001b[38;5;37m0",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 42,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 43,
                "Content": "  tags = {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 44,
                "Content": "    Name = \"JWT Secret\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;37m\"JWT Secret\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 45,
                "Content": "  }",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  }",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 46,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_6",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0104",
      "check_type": "Terraform Security Check",
      "title": "An egress security group rule allows traffic to /0.",
      "severity": "CRITICAL",
      "file": "security-groups.tf",
      "line": 87,
      "end_line": 87,
      "message": "Security group rule allows egress to multiple public internet addresses.",
      "description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.",
      "remediation": "Set a more restrictive cidr range",
      "provider": "AWS",
      "service": "ec2",
      "references": [
        "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0104"
      ],
      "scan_timestamp": "20251010_115942",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0104",
        "AVDID": "AVD-AWS-0104",
        "Title": "An egress security group rule allows traffic to /0.",
        "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.",
        "Message": "Security group rule allows egress to multiple public internet addresses.",
        "Query": "data..",
        "Resolution": "Set a more restrictive cidr range",
        "Severity": "CRITICAL",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0104",
        "References": [
          "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_security_group.backend",
          "Provider": "AWS",
          "Service": "ec2",
          "StartLine": 87,
          "EndLine": 87,
          "Code": {
            "Lines": [
              {
                "Number": 49,
                "Content": "resource \"aws_security_group\" \"backend\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"backend\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 50,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 87,
                "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 94,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 95,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "egress",
              "Filename": "security-groups.tf",
              "Location": {
                "StartLine": 82,
                "EndLine": 88
              }
            },
            {
              "Resource": "aws_security_group.backend",
              "Filename": "security-groups.tf",
              "Location": {
                "StartLine": 49,
                "EndLine": 95
              }
            }
          ]
        }
      }
    },
    {
      "id": "trivy_misconfig_7",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0104",
      "check_type": "Terraform Security Check",
      "title": "An egress security group rule allows traffic to /0.",
      "severity": "CRITICAL",
      "file": "security-groups.tf",
      "line": 208,
      "end_line": 208,
      "message": "Security group rule allows egress to multiple public internet addresses.",
      "description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.",
      "remediation": "Set a more restrictive cidr range",
      "provider": "AWS",
      "service": "ec2",
      "references": [
        "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0104"
      ],
      "scan_timestamp": "20251010_115942",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0104",
        "AVDID": "AVD-AWS-0104",
        "Title": "An egress security group rule allows traffic to /0.",
        "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.",
        "Message": "Security group rule allows egress to multiple public internet addresses.",
        "Query": "data..",
        "Resolution": "Set a more restrictive cidr range",
        "Severity": "CRITICAL",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0104",
        "References": [
          "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_security_group.eks_nodes",
          "Provider": "AWS",
          "Service": "ec2",
          "StartLine": 208,
          "EndLine": 208,
          "Code": {
            "Lines": [
              {
                "Number": 170,
                "Content": "resource \"aws_security_group\" \"eks_nodes\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"eks_nodes\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 171,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 208,
                "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 214,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 215,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "egress",
              "Filename": "security-groups.tf",
              "Location": {
                "StartLine": 203,
                "EndLine": 209
              }
            },
            {
              "Resource": "aws_security_group.eks_nodes",
              "Filename": "security-groups.tf",
              "Location": {
                "StartLine": 170,
                "EndLine": 215
              }
            }
          ]
        }
      }
    },
    {
      "id": "trivy_misconfig_8",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0107",
      "check_type": "Terraform Security Check",
      "title": "An ingress security group rule allows traffic from /0.",
      "severity": "CRITICAL",
      "file": "security-groups.tf",
      "line": 29,
      "end_line": 29,
      "message": "Security group rule allows ingress from public internet.",
      "description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
      "remediation": "Set a more restrictive cidr range",
      "provider": "AWS",
      "service": "ec2",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0107"
      ],
      "scan_timestamp": "20251010_115942",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0107",
        "AVDID": "AVD-AWS-0107",
        "Title": "An ingress security group rule allows traffic from /0.",
        "Description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
        "Message": "Security group rule allows ingress from public internet.",
        "Query": "data..",
        "Resolution": "Set a more restrictive cidr range",
        "Severity": "CRITICAL",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
        "References": [
          "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0107"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_security_group.alb",
          "Provider": "AWS",
          "Service": "ec2",
          "StartLine": 29,
          "EndLine": 29,
          "Code": {
            "Lines": [
              {
                "Number": 9,
                "Content": "resource \"aws_security_group\" \"alb\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"alb\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 10,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 45,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 46,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "ingress",
              "Filename": "security-groups.tf",
              "Location": {
                "StartLine": 24,
                "EndLine": 30
              }
            },
            {
              "Resource": "aws_security_group.alb",
              "Filename": "security-groups.tf",
              "Location": {
                "StartLine": 9,
                "EndLine": 46
              }
            }
          ]
        }
      }
    },
    {
      "id": "trivy_misconfig_9",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0107",
      "check_type": "Terraform Security Check",
      "title": "An ingress security group rule allows traffic from /0.",
      "severity": "CRITICAL",
      "file": "security-groups.tf",
      "line": 20,
      "end_line": 20,
      "message": "Security group rule allows ingress from public internet.",
      "description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
      "remediation": "Set a more restrictive cidr range",
      "provider": "AWS",
      "service": "ec2",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0107"
      ],
      "scan_timestamp": "20251010_115942",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0107",
        "AVDID": "AVD-AWS-0107",
        "Title": "An ingress security group rule allows traffic from /0.",
        "Description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
        "Message": "Security group rule allows ingress from public internet.",
        "Query": "data..",
        "Resolution": "Set a more restrictive cidr range",
        "Severity": "CRITICAL",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
        "References": [
          "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0107"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_security_group.alb",
          "Provider": "AWS",
          "Service": "ec2",
          "StartLine": 20,
          "EndLine": 20,
          "Code": {
            "Lines": [
              {
                "Number": 9,
                "Content": "resource \"aws_security_group\" \"alb\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"alb\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 10,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "    cidr_blocks = [\"0.0.0.0/0\"]  # OK: ALB is public-facing",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]\u001b[38;5;239m  # OK: ALB is public-facing",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 45,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 46,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "ingress",
              "Filename": "security-groups.tf",
              "Location": {
                "StartLine": 15,
                "EndLine": 21
              }
            },
            {
              "Resource": "aws_security_group.alb",
              "Filename": "security-groups.tf",
              "Location": {
                "StartLine": 9,
                "EndLine": 46
              }
            }
          ]
        }
      }
    },
    {
      "id": "trivy_misconfig_10",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0164",
      "check_type": "Terraform Security Check",
      "title": "Instances in a subnet should not receive a public IP address by default.",
      "severity": "HIGH",
      "file": "vpc.tf",
      "line": 23,
      "end_line": 23,
      "message": "Subnet associates public IP address.",
      "description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.",
      "remediation": "Set the instance to not be publicly accessible",
      "provider": "AWS",
      "service": "ec2",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
        "https://avd.aquasec.com/misconfig/avd-aws-0164"
      ],
      "scan_timestamp": "20251010_115942",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0164",
        "AVDID": "AVD-AWS-0164",
        "Title": "Instances in a subnet should not receive a public IP address by default.",
        "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.",
        "Message": "Subnet associates public IP address.",
        "Query": "data..",
        "Resolution": "Set the instance to not be publicly accessible",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0164",
        "References": [
          "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
          "https://avd.aquasec.com/misconfig/avd-aws-0164"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_subnet.public_1",
          "Provider": "AWS",
          "Service": "ec2",
          "StartLine": 23,
          "EndLine": 23,
          "Code": {
            "Lines": [
              {
                "Number": 19,
                "Content": "resource \"aws_subnet\" \"public_1\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_subnet\"\u001b[0m \u001b[38;5;37m\"public_1\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "  vpc_id                  = aws_vpc.main.id",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mvpc_id\u001b[0m                  = aws_vpc.main.id",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "  cidr_block              = \"10.0.1.0/24\"",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mcidr_block\u001b[0m              = \u001b[38;5;37m\"10.0.1.0/24\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "  availability_zone       = \"${var.aws_region}a\"",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mavailability_zone\u001b[0m       = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.aws_region\u001b[38;5;37m}\u001b[0m\u001b[38;5;37ma\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "  map_public_ip_on_launch = true  # \u274c Auto-assigns public IPs!",
                "IsCause": true,
                "Annotation": "true",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mmap_public_ip_on_launch\u001b[0m = \u001b[38;5;166mtrue\u001b[0m\u001b[38;5;239m  # \u274c Auto-assigns public IPs!",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 24,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "  tags = {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m = {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "    Name = \"${var.project_name}-public-1\"",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-public-1\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "  }",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  }",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "aws_subnet.public_1",
              "Filename": "vpc.tf",
              "Location": {
                "StartLine": 19,
                "EndLine": 28
              }
            }
          ]
        }
      }
    },
    {
      "id": "trivy_misconfig_11",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0164",
      "check_type": "Terraform Security Check",
      "title": "Instances in a subnet should not receive a public IP address by default.",
      "severity": "HIGH",
      "file": "vpc.tf",
      "line": 34,
      "end_line": 34,
      "message": "Subnet associates public IP address.",
      "description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.",
      "remediation": "Set the instance to not be publicly accessible",
      "provider": "AWS",
      "service": "ec2",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
        "https://avd.aquasec.com/misconfig/avd-aws-0164"
      ],
      "scan_timestamp": "20251010_115942",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0164",
        "AVDID": "AVD-AWS-0164",
        "Title": "Instances in a subnet should not receive a public IP address by default.",
        "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.",
        "Message": "Subnet associates public IP address.",
        "Query": "data..",
        "Resolution": "Set the instance to not be publicly accessible",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0164",
        "References": [
          "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
          "https://avd.aquasec.com/misconfig/avd-aws-0164"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_subnet.public_2",
          "Provider": "AWS",
          "Service": "ec2",
          "StartLine": 34,
          "EndLine": 34,
          "Code": {
            "Lines": [
              {
                "Number": 30,
                "Content": "resource \"aws_subnet\" \"public_2\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_subnet\"\u001b[0m \u001b[38;5;37m\"public_2\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "  vpc_id                  = aws_vpc.main.id",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mvpc_id\u001b[0m                  = aws_vpc.main.id",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "  cidr_block              = \"10.0.2.0/24\"",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mcidr_block\u001b[0m              = \u001b[38;5;37m\"10.0.2.0/24\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "  availability_zone       = \"${var.aws_region}b\"",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mavailability_zone\u001b[0m       = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.aws_region\u001b[38;5;37m}\u001b[0m\u001b[38;5;37mb\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 34,
                "Content": "  map_public_ip_on_launch = true",
                "IsCause": true,
                "Annotation": "true",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mmap_public_ip_on_launch\u001b[0m = \u001b[38;5;166mtrue",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 35,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 36,
                "Content": "  tags = {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 37,
                "Content": "    Name = \"${var.project_name}-public-2\"",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-public-2\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 38,
                "Content": "  }",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  }",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "aws_subnet.public_2",
              "Filename": "vpc.tf",
              "Location": {
                "StartLine": 30,
                "EndLine": 39
              }
            }
          ]
        }
      }
    },
    {
      "id": "trivy_misconfig_12",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0178",
      "check_type": "Terraform Security Check",
      "title": "VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet \"Rejects\" for VPCs.",
      "severity": "MEDIUM",
      "file": "vpc.tf",
      "line": 8,
      "end_line": 16,
      "message": "VPC Flow Logs is not enabled for VPC",
      "description": "VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.",
      "remediation": "Enable flow logs for VPC",
      "provider": "AWS",
      "service": "ec2",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0178"
      ],
      "scan_timestamp": "20251010_115942",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0178",
        "AVDID": "AVD-AWS-0178",
        "Title": "VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet \"Rejects\" for VPCs.",
        "Description": "VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.",
        "Message": "VPC Flow Logs is not enabled for VPC",
        "Query": "data..",
        "Resolution": "Enable flow logs for VPC",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0178",
        "References": [
          "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0178"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_vpc.main",
          "Provider": "AWS",
          "Service": "ec2",
          "StartLine": 8,
          "EndLine": 16,
          "Code": {
            "Lines": [
              {
                "Number": 8,
                "Content": "resource \"aws_vpc\" \"main\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_vpc\"\u001b[0m \u001b[38;5;37m\"main\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 9,
                "Content": "  cidr_block           = \"10.0.0.0/16\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mcidr_block\u001b[0m           = \u001b[38;5;37m\"10.0.0.0/16\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 10,
                "Content": "  enable_dns_hostnames = true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245menable_dns_hostnames\u001b[0m = \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 11,
                "Content": "  enable_dns_support   = true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245menable_dns_support\u001b[0m   = \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 12,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 13,
                "Content": "  tags = {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 14,
                "Content": "    Name = \"${var.project_name}-vpc\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-vpc\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 15,
                "Content": "  }",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  }",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 16,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_1",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0057",
      "check_type": "Terraform Security Check",
      "title": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
      "severity": "HIGH",
      "file": "iam.tf",
      "line": 185,
      "end_line": 185,
      "message": "IAM policy document uses sensitive action 'kms:Decrypt' on wildcarded resource 'arn:aws:kms:*:*:key/*'",
      "description": "You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.",
      "remediation": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
      "provider": "AWS",
      "service": "iam",
      "references": [
        "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0057"
      ],
      "scan_timestamp": "20251010_125451",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0057",
        "AVDID": "AVD-AWS-0057",
        "Title": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
        "Description": "You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.",
        "Message": "IAM policy document uses sensitive action 'kms:Decrypt' on wildcarded resource 'arn:aws:kms:*:*:key/*'",
        "Query": "data..",
        "Resolution": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0057",
        "References": [
          "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0057"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_iam_role_policy.app_kms",
          "Provider": "AWS",
          "Service": "iam",
          "StartLine": 185,
          "EndLine": 185,
          "Code": {
            "Lines": [
              {
                "Number": 180,
                "Content": "resource \"aws_iam_role_policy\" \"app_kms\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_iam_role_policy\"\u001b[0m \u001b[38;5;37m\"app_kms\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 181,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 185,
                "Content": "    Version = \"2012-10-17\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mVersion\u001b[0m = \u001b[38;5;37m\"2012-10-17\"",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 208,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 209,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "aws_iam_role_policy.app_kms.policy",
              "Filename": "iam.tf",
              "Location": {
                "StartLine": 185,
                "EndLine": 185
              }
            },
            {
              "Resource": "aws_iam_role_policy.app_kms.policy",
              "Filename": "iam.tf",
              "Location": {
                "StartLine": 184,
                "EndLine": 208
              }
            },
            {
              "Resource": "aws_iam_role_policy.app_kms",
              "Filename": "iam.tf",
              "Location": {
                "StartLine": 180,
                "EndLine": 209
              }
            }
          ]
        }
      }
    },
    {
      "id": "trivy_misconfig_2",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0089",
      "check_type": "Terraform Security Check",
      "title": "S3 Bucket Logging",
      "severity": "LOW",
      "file": "s3.tf",
      "line": 88,
      "end_line": 97,
      "message": "Bucket has logging disabled",
      "description": "Ensures S3 bucket logging is enabled for S3 buckets",
      "remediation": "Add a logging block to the resource to enable access logging",
      "provider": "AWS",
      "service": "s3",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0089"
      ],
      "scan_timestamp": "20251010_125451",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0089",
        "AVDID": "AVD-AWS-0089",
        "Title": "S3 Bucket Logging",
        "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
        "Message": "Bucket has logging disabled",
        "Namespace": "builtin.aws.s3.aws0089",
        "Query": "data.builtin.aws.s3.aws0089.deny",
        "Resolution": "Add a logging block to the resource to enable access logging",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0089",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0089"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_s3_bucket.audit_logs",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 88,
          "EndLine": 97,
          "Code": {
            "Lines": [
              {
                "Number": 88,
                "Content": "resource \"aws_s3_bucket\" \"audit_logs\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"audit_logs\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 89,
                "Content": "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-audit-logs\" : \"${var.project_name}-audit-logs-${var.environment}-${data.aws_caller_identity.current.account_id}\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;33mvar\u001b[0m.\u001b[38;5;245mdeployment_target\u001b[0m =\u001b[38;5;245m=\u001b[0m \u001b[38;5;37m\"localstack\"\u001b[0m \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-audit-logs\"\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-audit-logs-\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.environment\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.aws_caller_identity.current.account_id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 90,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 91,
                "Content": "  force_destroy = true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 92,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 93,
                "Content": "  tags = {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 94,
                "Content": "    Name     = \"Audit Logs\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m     = \u001b[38;5;37m\"Audit Logs\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 95,
                "Content": "    Contains = \"PCI Audit Logs\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mContains\u001b[0m = \u001b[38;5;37m\"PCI Audit Logs\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 96,
                "Content": "  }",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  }",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 97,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_3",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0090",
      "check_type": "Terraform Security Check",
      "title": "S3 Data should be versioned",
      "severity": "MEDIUM",
      "file": "s3.tf",
      "line": 88,
      "end_line": 97,
      "message": "Bucket does not have versioning enabled",
      "description": "\nVersioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket. \nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets. \nWith versioning you can recover more easily from both unintended user actions and application failures.\n",
      "remediation": "Enable versioning to protect against accidental/malicious removal or modification",
      "provider": "AWS",
      "service": "s3",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0090"
      ],
      "scan_timestamp": "20251010_125451",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0090",
        "AVDID": "AVD-AWS-0090",
        "Title": "S3 Data should be versioned",
        "Description": "\nVersioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket. \nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets. \nWith versioning you can recover more easily from both unintended user actions and application failures.\n",
        "Message": "Bucket does not have versioning enabled",
        "Query": "data..",
        "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
        "References": [
          "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0090"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_s3_bucket.audit_logs",
          "Provider": "AWS",
          "Service": "s3",
          "StartLine": 88,
          "EndLine": 97,
          "Code": {
            "Lines": [
              {
                "Number": 88,
                "Content": "resource \"aws_s3_bucket\" \"audit_logs\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"audit_logs\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 89,
                "Content": "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-audit-logs\" : \"${var.project_name}-audit-logs-${var.environment}-${data.aws_caller_identity.current.account_id}\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;33mvar\u001b[0m.\u001b[38;5;245mdeployment_target\u001b[0m =\u001b[38;5;245m=\u001b[0m \u001b[38;5;37m\"localstack\"\u001b[0m \u001b[38;5;245m?\u001b[0m \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-audit-logs\"\u001b[0m \u001b[38;5;245m:\u001b[0m \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-audit-logs-\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.environment\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mdata\u001b[0m.aws_caller_identity.current.account_id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 90,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 91,
                "Content": "  force_destroy = true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mforce_destroy\u001b[0m = \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 92,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 93,
                "Content": "  tags = {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 94,
                "Content": "    Name     = \"Audit Logs\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m     = \u001b[38;5;37m\"Audit Logs\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 95,
                "Content": "    Contains = \"PCI Audit Logs\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mContains\u001b[0m = \u001b[38;5;37m\"PCI Audit Logs\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 96,
                "Content": "  }",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  }",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 97,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_4",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0098",
      "check_type": "Terraform Security Check",
      "title": "Secrets Manager should use customer managed keys",
      "severity": "LOW",
      "file": "secrets-manager.tf",
      "line": 9,
      "end_line": 22,
      "message": "Secret explicitly uses the default key.",
      "description": "Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.",
      "remediation": "Use customer managed keys",
      "provider": "AWS",
      "service": "ssm",
      "references": [
        "https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt",
        "https://avd.aquasec.com/misconfig/avd-aws-0098"
      ],
      "scan_timestamp": "20251010_125451",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0098",
        "AVDID": "AVD-AWS-0098",
        "Title": "Secrets Manager should use customer managed keys",
        "Description": "Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.",
        "Message": "Secret explicitly uses the default key.",
        "Query": "data..",
        "Resolution": "Use customer managed keys",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0098",
        "References": [
          "https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt",
          "https://avd.aquasec.com/misconfig/avd-aws-0098"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_secretsmanager_secret.db_password",
          "Provider": "AWS",
          "Service": "ssm",
          "StartLine": 9,
          "EndLine": 22,
          "Code": {
            "Lines": [
              {
                "Number": 9,
                "Content": "resource \"aws_secretsmanager_secret\" \"db_password\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_secretsmanager_secret\"\u001b[0m \u001b[38;5;37m\"db_password\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 10,
                "Content": "  name                    = \"${var.project_name}/db/password\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m                    = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m/db/password\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 11,
                "Content": "  description             = \"Database password for SecureBank\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mdescription\u001b[0m             = \u001b[38;5;37m\"Database password for SecureBank\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 12,
                "Content": "  recovery_window_in_days = 0  # \u274c Immediate deletion, no recovery!",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mrecovery_window_in_days\u001b[0m = \u001b[38;5;37m0\u001b[0m\u001b[38;5;239m  # \u274c Immediate deletion, no recovery!",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 13,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 14,
                "Content": "  # \u274c PCI 8.2.4: No automatic rotation",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  # \u274c PCI 8.2.4: No automatic rotation",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 15,
                "Content": "  # rotation_rules {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  # rotation_rules {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 16,
                "Content": "  #   automatically_after_days = 90",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  #   automatically_after_days = 90",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 17,
                "Content": "  # }",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  # }",
                "FirstCause": false,
                "LastCause": true
              },
              {
                "Number": 18,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_5",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0098",
      "check_type": "Terraform Security Check",
      "title": "Secrets Manager should use customer managed keys",
      "severity": "LOW",
      "file": "secrets-manager.tf",
      "line": 39,
      "end_line": 46,
      "message": "Secret explicitly uses the default key.",
      "description": "Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.",
      "remediation": "Use customer managed keys",
      "provider": "AWS",
      "service": "ssm",
      "references": [
        "https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt",
        "https://avd.aquasec.com/misconfig/avd-aws-0098"
      ],
      "scan_timestamp": "20251010_125451",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0098",
        "AVDID": "AVD-AWS-0098",
        "Title": "Secrets Manager should use customer managed keys",
        "Description": "Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.",
        "Message": "Secret explicitly uses the default key.",
        "Query": "data..",
        "Resolution": "Use customer managed keys",
        "Severity": "LOW",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0098",
        "References": [
          "https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt",
          "https://avd.aquasec.com/misconfig/avd-aws-0098"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_secretsmanager_secret.jwt_secret",
          "Provider": "AWS",
          "Service": "ssm",
          "StartLine": 39,
          "EndLine": 46,
          "Code": {
            "Lines": [
              {
                "Number": 39,
                "Content": "resource \"aws_secretsmanager_secret\" \"jwt_secret\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_secretsmanager_secret\"\u001b[0m \u001b[38;5;37m\"jwt_secret\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 40,
                "Content": "  name                    = \"${var.project_name}/jwt/secret\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mname\u001b[0m                    = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m/jwt/secret\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 41,
                "Content": "  recovery_window_in_days = 0",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mrecovery_window_in_days\u001b[0m = \u001b[38;5;37m0",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 42,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 43,
                "Content": "  tags = {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 44,
                "Content": "    Name = \"JWT Secret\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;37m\"JWT Secret\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 45,
                "Content": "  }",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  }",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 46,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "trivy_misconfig_6",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0104",
      "check_type": "Terraform Security Check",
      "title": "An egress security group rule allows traffic to /0.",
      "severity": "CRITICAL",
      "file": "security-groups.tf",
      "line": 87,
      "end_line": 87,
      "message": "Security group rule allows egress to multiple public internet addresses.",
      "description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.",
      "remediation": "Set a more restrictive cidr range",
      "provider": "AWS",
      "service": "ec2",
      "references": [
        "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0104"
      ],
      "scan_timestamp": "20251010_125451",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0104",
        "AVDID": "AVD-AWS-0104",
        "Title": "An egress security group rule allows traffic to /0.",
        "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.",
        "Message": "Security group rule allows egress to multiple public internet addresses.",
        "Query": "data..",
        "Resolution": "Set a more restrictive cidr range",
        "Severity": "CRITICAL",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0104",
        "References": [
          "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_security_group.backend",
          "Provider": "AWS",
          "Service": "ec2",
          "StartLine": 87,
          "EndLine": 87,
          "Code": {
            "Lines": [
              {
                "Number": 49,
                "Content": "resource \"aws_security_group\" \"backend\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"backend\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 50,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 87,
                "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 94,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 95,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "egress",
              "Filename": "security-groups.tf",
              "Location": {
                "StartLine": 82,
                "EndLine": 88
              }
            },
            {
              "Resource": "aws_security_group.backend",
              "Filename": "security-groups.tf",
              "Location": {
                "StartLine": 49,
                "EndLine": 95
              }
            }
          ]
        }
      }
    },
    {
      "id": "trivy_misconfig_7",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0104",
      "check_type": "Terraform Security Check",
      "title": "An egress security group rule allows traffic to /0.",
      "severity": "CRITICAL",
      "file": "security-groups.tf",
      "line": 208,
      "end_line": 208,
      "message": "Security group rule allows egress to multiple public internet addresses.",
      "description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.",
      "remediation": "Set a more restrictive cidr range",
      "provider": "AWS",
      "service": "ec2",
      "references": [
        "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0104"
      ],
      "scan_timestamp": "20251010_125451",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0104",
        "AVDID": "AVD-AWS-0104",
        "Title": "An egress security group rule allows traffic to /0.",
        "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.",
        "Message": "Security group rule allows egress to multiple public internet addresses.",
        "Query": "data..",
        "Resolution": "Set a more restrictive cidr range",
        "Severity": "CRITICAL",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0104",
        "References": [
          "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0104"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_security_group.eks_nodes",
          "Provider": "AWS",
          "Service": "ec2",
          "StartLine": 208,
          "EndLine": 208,
          "Code": {
            "Lines": [
              {
                "Number": 170,
                "Content": "resource \"aws_security_group\" \"eks_nodes\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"eks_nodes\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 171,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 208,
                "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 214,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 215,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "egress",
              "Filename": "security-groups.tf",
              "Location": {
                "StartLine": 203,
                "EndLine": 209
              }
            },
            {
              "Resource": "aws_security_group.eks_nodes",
              "Filename": "security-groups.tf",
              "Location": {
                "StartLine": 170,
                "EndLine": 215
              }
            }
          ]
        }
      }
    },
    {
      "id": "trivy_misconfig_8",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0107",
      "check_type": "Terraform Security Check",
      "title": "An ingress security group rule allows traffic from /0.",
      "severity": "CRITICAL",
      "file": "security-groups.tf",
      "line": 29,
      "end_line": 29,
      "message": "Security group rule allows ingress from public internet.",
      "description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
      "remediation": "Set a more restrictive cidr range",
      "provider": "AWS",
      "service": "ec2",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0107"
      ],
      "scan_timestamp": "20251010_125451",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0107",
        "AVDID": "AVD-AWS-0107",
        "Title": "An ingress security group rule allows traffic from /0.",
        "Description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
        "Message": "Security group rule allows ingress from public internet.",
        "Query": "data..",
        "Resolution": "Set a more restrictive cidr range",
        "Severity": "CRITICAL",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
        "References": [
          "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0107"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_security_group.alb",
          "Provider": "AWS",
          "Service": "ec2",
          "StartLine": 29,
          "EndLine": 29,
          "Code": {
            "Lines": [
              {
                "Number": 9,
                "Content": "resource \"aws_security_group\" \"alb\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"alb\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 10,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 29,
                "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 45,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 46,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "ingress",
              "Filename": "security-groups.tf",
              "Location": {
                "StartLine": 24,
                "EndLine": 30
              }
            },
            {
              "Resource": "aws_security_group.alb",
              "Filename": "security-groups.tf",
              "Location": {
                "StartLine": 9,
                "EndLine": 46
              }
            }
          ]
        }
      }
    },
    {
      "id": "trivy_misconfig_9",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0107",
      "check_type": "Terraform Security Check",
      "title": "An ingress security group rule allows traffic from /0.",
      "severity": "CRITICAL",
      "file": "security-groups.tf",
      "line": 20,
      "end_line": 20,
      "message": "Security group rule allows ingress from public internet.",
      "description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
      "remediation": "Set a more restrictive cidr range",
      "provider": "AWS",
      "service": "ec2",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0107"
      ],
      "scan_timestamp": "20251010_125451",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0107",
        "AVDID": "AVD-AWS-0107",
        "Title": "An ingress security group rule allows traffic from /0.",
        "Description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
        "Message": "Security group rule allows ingress from public internet.",
        "Query": "data..",
        "Resolution": "Set a more restrictive cidr range",
        "Severity": "CRITICAL",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
        "References": [
          "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0107"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_security_group.alb",
          "Provider": "AWS",
          "Service": "ec2",
          "StartLine": 20,
          "EndLine": 20,
          "Code": {
            "Lines": [
              {
                "Number": 9,
                "Content": "resource \"aws_security_group\" \"alb\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"alb\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 10,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "    cidr_blocks = [\"0.0.0.0/0\"]  # OK: ALB is public-facing",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]\u001b[38;5;239m  # OK: ALB is public-facing",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 45,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": true,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 46,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "ingress",
              "Filename": "security-groups.tf",
              "Location": {
                "StartLine": 15,
                "EndLine": 21
              }
            },
            {
              "Resource": "aws_security_group.alb",
              "Filename": "security-groups.tf",
              "Location": {
                "StartLine": 9,
                "EndLine": 46
              }
            }
          ]
        }
      }
    },
    {
      "id": "trivy_misconfig_10",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0164",
      "check_type": "Terraform Security Check",
      "title": "Instances in a subnet should not receive a public IP address by default.",
      "severity": "HIGH",
      "file": "vpc.tf",
      "line": 23,
      "end_line": 23,
      "message": "Subnet associates public IP address.",
      "description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.",
      "remediation": "Set the instance to not be publicly accessible",
      "provider": "AWS",
      "service": "ec2",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
        "https://avd.aquasec.com/misconfig/avd-aws-0164"
      ],
      "scan_timestamp": "20251010_125451",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0164",
        "AVDID": "AVD-AWS-0164",
        "Title": "Instances in a subnet should not receive a public IP address by default.",
        "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.",
        "Message": "Subnet associates public IP address.",
        "Query": "data..",
        "Resolution": "Set the instance to not be publicly accessible",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0164",
        "References": [
          "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
          "https://avd.aquasec.com/misconfig/avd-aws-0164"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_subnet.public_1",
          "Provider": "AWS",
          "Service": "ec2",
          "StartLine": 23,
          "EndLine": 23,
          "Code": {
            "Lines": [
              {
                "Number": 19,
                "Content": "resource \"aws_subnet\" \"public_1\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_subnet\"\u001b[0m \u001b[38;5;37m\"public_1\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 20,
                "Content": "  vpc_id                  = aws_vpc.main.id",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mvpc_id\u001b[0m                  = aws_vpc.main.id",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 21,
                "Content": "  cidr_block              = \"10.0.1.0/24\"",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mcidr_block\u001b[0m              = \u001b[38;5;37m\"10.0.1.0/24\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 22,
                "Content": "  availability_zone       = \"${var.aws_region}a\"",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mavailability_zone\u001b[0m       = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.aws_region\u001b[38;5;37m}\u001b[0m\u001b[38;5;37ma\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 23,
                "Content": "  map_public_ip_on_launch = true  # \u274c Auto-assigns public IPs!",
                "IsCause": true,
                "Annotation": "true",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mmap_public_ip_on_launch\u001b[0m = \u001b[38;5;166mtrue\u001b[0m\u001b[38;5;239m  # \u274c Auto-assigns public IPs!",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 24,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 25,
                "Content": "  tags = {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mtags\u001b[0m = {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 26,
                "Content": "    Name = \"${var.project_name}-public-1\"",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-public-1\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 27,
                "Content": "  }",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  }",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 28,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "aws_subnet.public_1",
              "Filename": "vpc.tf",
              "Location": {
                "StartLine": 19,
                "EndLine": 28
              }
            }
          ]
        }
      }
    },
    {
      "id": "trivy_misconfig_11",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0164",
      "check_type": "Terraform Security Check",
      "title": "Instances in a subnet should not receive a public IP address by default.",
      "severity": "HIGH",
      "file": "vpc.tf",
      "line": 34,
      "end_line": 34,
      "message": "Subnet associates public IP address.",
      "description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.",
      "remediation": "Set the instance to not be publicly accessible",
      "provider": "AWS",
      "service": "ec2",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
        "https://avd.aquasec.com/misconfig/avd-aws-0164"
      ],
      "scan_timestamp": "20251010_125451",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0164",
        "AVDID": "AVD-AWS-0164",
        "Title": "Instances in a subnet should not receive a public IP address by default.",
        "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.",
        "Message": "Subnet associates public IP address.",
        "Query": "data..",
        "Resolution": "Set the instance to not be publicly accessible",
        "Severity": "HIGH",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0164",
        "References": [
          "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
          "https://avd.aquasec.com/misconfig/avd-aws-0164"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_subnet.public_2",
          "Provider": "AWS",
          "Service": "ec2",
          "StartLine": 34,
          "EndLine": 34,
          "Code": {
            "Lines": [
              {
                "Number": 30,
                "Content": "resource \"aws_subnet\" \"public_2\" {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_subnet\"\u001b[0m \u001b[38;5;37m\"public_2\"\u001b[0m {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 31,
                "Content": "  vpc_id                  = aws_vpc.main.id",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mvpc_id\u001b[0m                  = aws_vpc.main.id",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 32,
                "Content": "  cidr_block              = \"10.0.2.0/24\"",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mcidr_block\u001b[0m              = \u001b[38;5;37m\"10.0.2.0/24\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 33,
                "Content": "  availability_zone       = \"${var.aws_region}b\"",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mavailability_zone\u001b[0m       = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.aws_region\u001b[38;5;37m}\u001b[0m\u001b[38;5;37mb\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 34,
                "Content": "  map_public_ip_on_launch = true",
                "IsCause": true,
                "Annotation": "true",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245mmap_public_ip_on_launch\u001b[0m = \u001b[38;5;166mtrue",
                "FirstCause": true,
                "LastCause": true
              },
              {
                "Number": 35,
                "Content": "",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 36,
                "Content": "  tags = {",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 37,
                "Content": "    Name = \"${var.project_name}-public-2\"",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-public-2\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 38,
                "Content": "  }",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  }",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 39,
                "Content": "}",
                "IsCause": false,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": false
              }
            ]
          },
          "Occurrences": [
            {
              "Resource": "aws_subnet.public_2",
              "Filename": "vpc.tf",
              "Location": {
                "StartLine": 30,
                "EndLine": 39
              }
            }
          ]
        }
      }
    },
    {
      "id": "trivy_misconfig_12",
      "type": "misconfiguration",
      "scanner": "trivy-config",
      "check_id": "AVD-AWS-0178",
      "check_type": "Terraform Security Check",
      "title": "VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet \"Rejects\" for VPCs.",
      "severity": "MEDIUM",
      "file": "vpc.tf",
      "line": 8,
      "end_line": 16,
      "message": "VPC Flow Logs is not enabled for VPC",
      "description": "VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.",
      "remediation": "Enable flow logs for VPC",
      "provider": "AWS",
      "service": "ec2",
      "references": [
        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
        "https://avd.aquasec.com/misconfig/avd-aws-0178"
      ],
      "scan_timestamp": "20251010_125451",
      "_original": {
        "Type": "Terraform Security Check",
        "ID": "AVD-AWS-0178",
        "AVDID": "AVD-AWS-0178",
        "Title": "VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet \"Rejects\" for VPCs.",
        "Description": "VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.",
        "Message": "VPC Flow Logs is not enabled for VPC",
        "Query": "data..",
        "Resolution": "Enable flow logs for VPC",
        "Severity": "MEDIUM",
        "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0178",
        "References": [
          "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
          "https://avd.aquasec.com/misconfig/avd-aws-0178"
        ],
        "Status": "FAIL",
        "Layer": {},
        "CauseMetadata": {
          "Resource": "aws_vpc.main",
          "Provider": "AWS",
          "Service": "ec2",
          "StartLine": 8,
          "EndLine": 16,
          "Code": {
            "Lines": [
              {
                "Number": 8,
                "Content": "resource \"aws_vpc\" \"main\" {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_vpc\"\u001b[0m \u001b[38;5;37m\"main\"\u001b[0m {",
                "FirstCause": true,
                "LastCause": false
              },
              {
                "Number": 9,
                "Content": "  cidr_block           = \"10.0.0.0/16\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mcidr_block\u001b[0m           = \u001b[38;5;37m\"10.0.0.0/16\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 10,
                "Content": "  enable_dns_hostnames = true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245menable_dns_hostnames\u001b[0m = \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 11,
                "Content": "  enable_dns_support   = true",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  \u001b[38;5;245menable_dns_support\u001b[0m   = \u001b[38;5;166mtrue",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 12,
                "Content": "",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 13,
                "Content": "  tags = {",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 14,
                "Content": "    Name = \"${var.project_name}-vpc\"",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0m\u001b[38;5;33mvar\u001b[0m.project_name\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m-vpc\"",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 15,
                "Content": "  }",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "\u001b[0m  }",
                "FirstCause": false,
                "LastCause": false
              },
              {
                "Number": 16,
                "Content": "}",
                "IsCause": true,
                "Annotation": "",
                "Truncated": false,
                "Highlighted": "}",
                "FirstCause": false,
                "LastCause": true
              }
            ]
          }
        }
      }
    },
    {
      "id": "checkov_1",
      "scanner": "checkov",
      "check_id": "CKV_AWS_338",
      "check_name": "Ensure CloudWatch log groups retains logs for at least 1 year",
      "title": "Ensure CloudWatch log groups retains logs for at least 1 year",
      "severity": "MEDIUM",
      "file": "/cloudwatch.tf",
      "line": 8,
      "end_line": 18,
      "resource": "aws_cloudwatch_log_group.app_logs",
      "resource_type": "aws_cloudwatch_log_group",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338",
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "category": "Security Configuration",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV_AWS_338",
        "bc_check_id": "BC_AWS_LOGGING_46",
        "check_name": "Ensure CloudWatch log groups retains logs for at least 1 year",
        "check_result": {
          "result": "FAILED",
          "evaluated_keys": [
            "retention_in_days"
          ]
        },
        "code_block": null,
        "file_path": "/cloudwatch.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/cloudwatch.tf",
        "repo_file_path": "/infrastructure/terraform/cloudwatch.tf",
        "file_line_range": [
          8,
          18
        ],
        "resource": "aws_cloudwatch_log_group.app_logs",
        "evaluations": null,
        "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetentionYear",
        "fixed_definition": null,
        "entity_tags": {
          "Name": "SecureBank Application Logs"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/cloudwatch.tf",
        "breadcrumbs": {
          "name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      },
      "iso27001_compliance": {
        "controls": [
          "A.12.4.1",
          "A.18.1.3"
        ],
        "control_name": "Logging and monitoring - Log retention",
        "domain": "A.12 - Operations Security",
        "description": "CloudWatch log groups should retain logs for at least 1 year",
        "audit_evidence": [
          "CloudWatch retention policy",
          "Compliance requirement documentation"
        ],
        "remediation_priority": "MEDIUM",
        "estimated_effort_hours": 1
      },
      "soc2_compliance": {
        "criteria": [
          "CC7.2"
        ],
        "criteria_names": [
          "CC7.2 - System Monitoring - Security Events"
        ],
        "trust_service_category": "Security",
        "description": "CloudWatch log retention for audit compliance",
        "control_objective": "The entity retains logs for at least 1 year",
        "audit_evidence": [
          "Retention policy",
          "Compliance documentation"
        ],
        "remediation_priority": "MEDIUM",
        "estimated_effort_hours": 1
      },
      "total_controls_affected": 3,
      "cross_framework_impact": true
    },
    {
      "id": "checkov_2",
      "scanner": "checkov",
      "check_id": "CKV_AWS_149",
      "check_name": "Ensure that Secrets Manager secret is encrypted using KMS CMK",
      "title": "Ensure that Secrets Manager secret is encrypted using KMS CMK",
      "severity": "MEDIUM",
      "file": "/secrets-manager.tf",
      "line": 9,
      "end_line": 22,
      "resource": "aws_secretsmanager_secret.db_password",
      "resource_type": "aws_secretsmanager_secret",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-secrets-manager-secret-is-encrypted-using-kms",
      "compliance_frameworks": [],
      "category": "Encryption",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV_AWS_149",
        "bc_check_id": "BC_AWS_GENERAL_79",
        "check_name": "Ensure that Secrets Manager secret is encrypted using KMS CMK",
        "check_result": {
          "result": "FAILED",
          "evaluated_keys": [
            "kms_key_id"
          ]
        },
        "code_block": null,
        "file_path": "/secrets-manager.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf",
        "repo_file_path": "/infrastructure/terraform/secrets-manager.tf",
        "file_line_range": [
          9,
          22
        ],
        "resource": "aws_secretsmanager_secret.db_password",
        "evaluations": null,
        "check_class": "checkov.terraform.checks.resource.aws.SecretManagerSecretEncrypted",
        "fixed_definition": null,
        "entity_tags": {
          "Name": "Database Password"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-secrets-manager-secret-is-encrypted-using-kms",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf",
        "breadcrumbs": {
          "name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_3",
      "scanner": "checkov",
      "check_id": "CKV_AWS_149",
      "check_name": "Ensure that Secrets Manager secret is encrypted using KMS CMK",
      "title": "Ensure that Secrets Manager secret is encrypted using KMS CMK",
      "severity": "MEDIUM",
      "file": "/secrets-manager.tf",
      "line": 39,
      "end_line": 46,
      "resource": "aws_secretsmanager_secret.jwt_secret",
      "resource_type": "aws_secretsmanager_secret",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-secrets-manager-secret-is-encrypted-using-kms",
      "compliance_frameworks": [],
      "category": "Encryption",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV_AWS_149",
        "bc_check_id": "BC_AWS_GENERAL_79",
        "check_name": "Ensure that Secrets Manager secret is encrypted using KMS CMK",
        "check_result": {
          "result": "FAILED",
          "evaluated_keys": [
            "kms_key_id"
          ]
        },
        "code_block": null,
        "file_path": "/secrets-manager.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf",
        "repo_file_path": "/infrastructure/terraform/secrets-manager.tf",
        "file_line_range": [
          39,
          46
        ],
        "resource": "aws_secretsmanager_secret.jwt_secret",
        "evaluations": null,
        "check_class": "checkov.terraform.checks.resource.aws.SecretManagerSecretEncrypted",
        "fixed_definition": null,
        "entity_tags": {
          "Name": "JWT Secret"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-secrets-manager-secret-is-encrypted-using-kms",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf",
        "breadcrumbs": {
          "name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_4",
      "scanner": "checkov",
      "check_id": "CKV_AWS_260",
      "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80",
      "title": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80",
      "severity": "MEDIUM",
      "file": "/security-groups.tf",
      "line": 9,
      "end_line": 46,
      "resource": "aws_security_group.alb",
      "resource_type": "aws_security_group",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80",
      "compliance_frameworks": [],
      "category": "Network Security",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV_AWS_260",
        "bc_check_id": "BC_AWS_NETWORKING_67",
        "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80",
        "check_result": {
          "result": "FAILED",
          "evaluated_keys": [
            "ingress/[1]/from_port",
            "ingress/[1]/to_port",
            "ingress/[1]/cidr_blocks",
            "ingress/[1]/ipv6_cidr_blocks"
          ]
        },
        "code_block": null,
        "file_path": "/security-groups.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "repo_file_path": "/infrastructure/terraform/security-groups.tf",
        "file_line_range": [
          9,
          46
        ],
        "resource": "aws_security_group.alb",
        "evaluations": null,
        "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress80",
        "fixed_definition": null,
        "entity_tags": {
          "Description": "Public ALB - HTTPS only",
          "Name": "securebank-alb",
          "PCI_DSS": "1.2.1"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "breadcrumbs": {
          "name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_5",
      "scanner": "checkov",
      "check_id": "CKV_AWS_130",
      "check_name": "Ensure VPC subnets do not assign public IP by default",
      "title": "Ensure VPC subnets do not assign public IP by default",
      "severity": "MEDIUM",
      "file": "/vpc.tf",
      "line": 19,
      "end_line": 28,
      "resource": "aws_subnet.public_1",
      "resource_type": "aws_subnet",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default",
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "category": "Exposure & Access",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV_AWS_130",
        "bc_check_id": "BC_AWS_NETWORKING_53",
        "check_name": "Ensure VPC subnets do not assign public IP by default",
        "check_result": {
          "result": "FAILED",
          "evaluated_keys": [
            "map_public_ip_on_launch"
          ]
        },
        "code_block": null,
        "file_path": "/vpc.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf",
        "repo_file_path": "/infrastructure/terraform/vpc.tf",
        "file_line_range": [
          19,
          28
        ],
        "resource": "aws_subnet.public_1",
        "evaluations": null,
        "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP",
        "fixed_definition": null,
        "entity_tags": {
          "Name": "securebank-public-1"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf",
        "breadcrumbs": {
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "availability_zone": [
            {
              "type": "variable",
              "name": "aws_region",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      },
      "iso27001_compliance": {
        "controls": [
          "A.13.1.3"
        ],
        "control_name": "Network controls - VPC flow logs",
        "domain": "A.13 - Communications Security",
        "description": "VPC should have flow logs enabled",
        "audit_evidence": [
          "VPC console showing flow logs",
          "Network monitoring documentation"
        ],
        "remediation_priority": "MEDIUM",
        "estimated_effort_hours": 2
      },
      "soc2_compliance": {
        "criteria": [
          "CC7.2"
        ],
        "criteria_names": [
          "CC7.2 - System Monitoring - Security Events"
        ],
        "trust_service_category": "Security",
        "description": "VPC flow logs for network monitoring",
        "control_objective": "The entity monitors network traffic",
        "audit_evidence": [
          "Flow logs enabled",
          "Network monitoring"
        ],
        "remediation_priority": "MEDIUM",
        "estimated_effort_hours": 2
      },
      "total_controls_affected": 2,
      "cross_framework_impact": true
    },
    {
      "id": "checkov_6",
      "scanner": "checkov",
      "check_id": "CKV_AWS_130",
      "check_name": "Ensure VPC subnets do not assign public IP by default",
      "title": "Ensure VPC subnets do not assign public IP by default",
      "severity": "MEDIUM",
      "file": "/vpc.tf",
      "line": 30,
      "end_line": 39,
      "resource": "aws_subnet.public_2",
      "resource_type": "aws_subnet",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default",
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "category": "Exposure & Access",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV_AWS_130",
        "bc_check_id": "BC_AWS_NETWORKING_53",
        "check_name": "Ensure VPC subnets do not assign public IP by default",
        "check_result": {
          "result": "FAILED",
          "evaluated_keys": [
            "map_public_ip_on_launch"
          ]
        },
        "code_block": null,
        "file_path": "/vpc.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf",
        "repo_file_path": "/infrastructure/terraform/vpc.tf",
        "file_line_range": [
          30,
          39
        ],
        "resource": "aws_subnet.public_2",
        "evaluations": null,
        "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP",
        "fixed_definition": null,
        "entity_tags": {
          "Name": "securebank-public-2"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf",
        "breadcrumbs": {
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "availability_zone": [
            {
              "type": "variable",
              "name": "aws_region",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      },
      "iso27001_compliance": {
        "controls": [
          "A.13.1.3"
        ],
        "control_name": "Network controls - VPC flow logs",
        "domain": "A.13 - Communications Security",
        "description": "VPC should have flow logs enabled",
        "audit_evidence": [
          "VPC console showing flow logs",
          "Network monitoring documentation"
        ],
        "remediation_priority": "MEDIUM",
        "estimated_effort_hours": 2
      },
      "soc2_compliance": {
        "criteria": [
          "CC7.2"
        ],
        "criteria_names": [
          "CC7.2 - System Monitoring - Security Events"
        ],
        "trust_service_category": "Security",
        "description": "VPC flow logs for network monitoring",
        "control_objective": "The entity monitors network traffic",
        "audit_evidence": [
          "Flow logs enabled",
          "Network monitoring"
        ],
        "remediation_priority": "MEDIUM",
        "estimated_effort_hours": 2
      },
      "total_controls_affected": 2,
      "cross_framework_impact": true
    },
    {
      "id": "checkov_7",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_30",
      "check_name": "Ensure Postgres RDS as aws_db_instance has Query Logging enabled",
      "title": "Ensure Postgres RDS as aws_db_instance has Query Logging enabled",
      "severity": "MEDIUM",
      "file": "/rds.tf",
      "line": 23,
      "end_line": 69,
      "resource": "aws_db_instance.payment_db",
      "resource_type": "aws_db_instance",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-postgres-rds-has-query-logging-enabled",
      "compliance_frameworks": [],
      "category": "Logging & Monitoring",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV2_AWS_30",
        "bc_check_id": "BC_AWS_LOGGING_32",
        "check_name": "Ensure Postgres RDS as aws_db_instance has Query Logging enabled",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_db_instance": {
              "payment_db": {
                "__end_line__": 69,
                "__start_line__": 23,
                "allocated_storage": [
                  20
                ],
                "auto_minor_version_upgrade": [
                  true
                ],
                "backup_retention_period": [
                  90
                ],
                "count": [
                  0
                ],
                "db_name": [
                  "securebank"
                ],
                "db_subnet_group_name": [
                  "aws_db_subnet_group.main[0].name"
                ],
                "deletion_protection": [
                  true
                ],
                "enabled_cloudwatch_logs_exports": [
                  [
                    "postgresql"
                  ]
                ],
                "engine": [
                  "postgres"
                ],
                "engine_version": [
                  "14.10"
                ],
                "identifier": [
                  "securebank-payment-db"
                ],
                "instance_class": [
                  "db.t3.micro"
                ],
                "kms_key_id": [
                  "aws_kms_key.securebank.arn"
                ],
                "max_allocated_storage": [
                  100
                ],
                "password": [
                  "supersecret"
                ],
                "publicly_accessible": [
                  false
                ],
                "skip_final_snapshot": [
                  true
                ],
                "storage_encrypted": [
                  true
                ],
                "storage_type": [
                  "gp3"
                ],
                "tags": [
                  {
                    "Compliance": "PCI-DSS",
                    "Contains": "CVV-PIN-PAN",
                    "Encryption": "NONE",
                    "Name": "securebank-payment-db"
                  }
                ],
                "username": [
                  "admin"
                ],
                "vpc_security_group_ids": [
                  [
                    "aws_security_group.database.id"
                  ]
                ],
                "__address__": "aws_db_instance.payment_db"
              }
            }
          },
          "evaluated_keys": [
            "parameter/*/name",
            "engine",
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/rds.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/rds.tf",
        "repo_file_path": "/infrastructure/terraform/rds.tf",
        "file_line_range": [
          23,
          69
        ],
        "resource": "aws_db_instance.payment_db",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Compliance": "PCI-DSS",
          "Contains": "CVV-PIN-PAN",
          "Encryption": "NONE",
          "Name": "securebank-payment-db"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-postgres-rds-has-query-logging-enabled",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/rds.tf",
        "breadcrumbs": {
          "password": [
            {
              "type": "variable",
              "name": "db_password",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "db_name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "identifier": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "count": [
            {
              "type": "variable",
              "name": "deployment_target",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "username": [
            {
              "type": "variable",
              "name": "db_username",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_8",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_5",
      "check_name": "Ensure that Security Groups are attached to another resource",
      "title": "Ensure that Security Groups are attached to another resource",
      "severity": "MEDIUM",
      "file": "/security-groups.tf",
      "line": 9,
      "end_line": 46,
      "resource": "aws_security_group.alb",
      "resource_type": "aws_security_group",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis",
      "compliance_frameworks": [],
      "category": "Network Security",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV2_AWS_5",
        "bc_check_id": "BC_AWS_NETWORKING_51",
        "check_name": "Ensure that Security Groups are attached to another resource",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_security_group": {
              "alb": {
                "__end_line__": 46,
                "__start_line__": 9,
                "description": [
                  "Allow HTTPS from internet to ALB only"
                ],
                "egress": [
                  {
                    "description": [
                      "To backend app"
                    ],
                    "from_port": [
                      3000
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "security_groups": [
                      [
                        "aws_security_group.backend.id"
                      ]
                    ],
                    "to_port": [
                      3000
                    ]
                  }
                ],
                "ingress": [
                  {
                    "cidr_blocks": [
                      [
                        "0.0.0.0/0"
                      ]
                    ],
                    "description": [
                      "HTTPS from internet"
                    ],
                    "from_port": [
                      443
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "to_port": [
                      443
                    ]
                  },
                  {
                    "cidr_blocks": [
                      [
                        "0.0.0.0/0"
                      ]
                    ],
                    "description": [
                      "HTTP redirect to HTTPS"
                    ],
                    "from_port": [
                      80
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "to_port": [
                      80
                    ]
                  }
                ],
                "name": [
                  "securebank-alb"
                ],
                "tags": [
                  {
                    "Description": "Public ALB - HTTPS only",
                    "Name": "securebank-alb",
                    "PCI_DSS": "1.2.1"
                  }
                ],
                "vpc_id": [
                  "aws_vpc.main.id"
                ],
                "__address__": "aws_security_group.alb"
              }
            }
          },
          "evaluated_keys": [
            "networking",
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/security-groups.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "repo_file_path": "/infrastructure/terraform/security-groups.tf",
        "file_line_range": [
          9,
          46
        ],
        "resource": "aws_security_group.alb",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Description": "Public ALB - HTTPS only",
          "Name": "securebank-alb",
          "PCI_DSS": "1.2.1"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "breadcrumbs": {
          "name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_9",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_5",
      "check_name": "Ensure that Security Groups are attached to another resource",
      "title": "Ensure that Security Groups are attached to another resource",
      "severity": "MEDIUM",
      "file": "/security-groups.tf",
      "line": 49,
      "end_line": 95,
      "resource": "aws_security_group.backend",
      "resource_type": "aws_security_group",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis",
      "compliance_frameworks": [],
      "category": "Network Security",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV2_AWS_5",
        "bc_check_id": "BC_AWS_NETWORKING_51",
        "check_name": "Ensure that Security Groups are attached to another resource",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_security_group": {
              "backend": {
                "__end_line__": 95,
                "__start_line__": 49,
                "description": [
                  "Backend app - only from ALB"
                ],
                "egress": [
                  {
                    "description": [
                      "To database"
                    ],
                    "from_port": [
                      5432
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "security_groups": [
                      [
                        "aws_security_group.database.id"
                      ]
                    ],
                    "to_port": [
                      5432
                    ]
                  },
                  {
                    "description": [
                      "To Redis"
                    ],
                    "from_port": [
                      6379
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "security_groups": [
                      [
                        "aws_security_group.redis.id"
                      ]
                    ],
                    "to_port": [
                      6379
                    ]
                  },
                  {
                    "cidr_blocks": [
                      [
                        "0.0.0.0/0"
                      ]
                    ],
                    "description": [
                      "AWS API calls"
                    ],
                    "from_port": [
                      443
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "to_port": [
                      443
                    ]
                  }
                ],
                "ingress": [
                  {
                    "description": [
                      "From ALB only"
                    ],
                    "from_port": [
                      3000
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "security_groups": [
                      [
                        "aws_security_group.alb.id"
                      ]
                    ],
                    "to_port": [
                      3000
                    ]
                  }
                ],
                "name": [
                  "securebank-backend"
                ],
                "tags": [
                  {
                    "Description": "Backend - ALB to DB only",
                    "Name": "securebank-backend",
                    "PCI_DSS": "1.2.1"
                  }
                ],
                "vpc_id": [
                  "aws_vpc.main.id"
                ],
                "__address__": "aws_security_group.backend"
              }
            }
          },
          "evaluated_keys": [
            "networking",
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/security-groups.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "repo_file_path": "/infrastructure/terraform/security-groups.tf",
        "file_line_range": [
          49,
          95
        ],
        "resource": "aws_security_group.backend",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Description": "Backend - ALB to DB only",
          "Name": "securebank-backend",
          "PCI_DSS": "1.2.1"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "breadcrumbs": {
          "name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_10",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_5",
      "check_name": "Ensure that Security Groups are attached to another resource",
      "title": "Ensure that Security Groups are attached to another resource",
      "severity": "MEDIUM",
      "file": "/security-groups.tf",
      "line": 122,
      "end_line": 139,
      "resource": "aws_security_group.redis",
      "resource_type": "aws_security_group",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis",
      "compliance_frameworks": [],
      "category": "Network Security",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV2_AWS_5",
        "bc_check_id": "BC_AWS_NETWORKING_51",
        "check_name": "Ensure that Security Groups are attached to another resource",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_security_group": {
              "redis": {
                "__end_line__": 139,
                "__start_line__": 122,
                "description": [
                  "Redis - only from backend"
                ],
                "ingress": [
                  {
                    "description": [
                      "Redis from backend only"
                    ],
                    "from_port": [
                      6379
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "security_groups": [
                      [
                        "aws_security_group.backend.id"
                      ]
                    ],
                    "to_port": [
                      6379
                    ]
                  }
                ],
                "name": [
                  "securebank-redis"
                ],
                "tags": [
                  {
                    "Description": "Redis cache",
                    "Name": "securebank-redis"
                  }
                ],
                "vpc_id": [
                  "aws_vpc.main.id"
                ],
                "__address__": "aws_security_group.redis"
              }
            }
          },
          "evaluated_keys": [
            "networking",
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/security-groups.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "repo_file_path": "/infrastructure/terraform/security-groups.tf",
        "file_line_range": [
          122,
          139
        ],
        "resource": "aws_security_group.redis",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Description": "Redis cache",
          "Name": "securebank-redis"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "breadcrumbs": {
          "name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_11",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_5",
      "check_name": "Ensure that Security Groups are attached to another resource",
      "title": "Ensure that Security Groups are attached to another resource",
      "severity": "MEDIUM",
      "file": "/security-groups.tf",
      "line": 142,
      "end_line": 167,
      "resource": "aws_security_group.eks_cluster",
      "resource_type": "aws_security_group",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis",
      "compliance_frameworks": [],
      "category": "Network Security",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV2_AWS_5",
        "bc_check_id": "BC_AWS_NETWORKING_51",
        "check_name": "Ensure that Security Groups are attached to another resource",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_security_group": {
              "eks_cluster": {
                "__end_line__": 167,
                "__start_line__": 142,
                "description": [
                  "EKS cluster control plane"
                ],
                "egress": [
                  {
                    "description": [
                      "To worker nodes"
                    ],
                    "from_port": [
                      1025
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "security_groups": [
                      [
                        "aws_security_group.eks_nodes.id"
                      ]
                    ],
                    "to_port": [
                      65535
                    ]
                  }
                ],
                "ingress": [
                  {
                    "description": [
                      "From worker nodes"
                    ],
                    "from_port": [
                      443
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "security_groups": [
                      [
                        "aws_security_group.eks_nodes.id"
                      ]
                    ],
                    "to_port": [
                      443
                    ]
                  }
                ],
                "name": [
                  "securebank-eks-cluster"
                ],
                "tags": [
                  {
                    "Name": "securebank-eks-cluster"
                  }
                ],
                "vpc_id": [
                  "aws_vpc.main.id"
                ],
                "__address__": "aws_security_group.eks_cluster"
              }
            }
          },
          "evaluated_keys": [
            "networking",
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/security-groups.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "repo_file_path": "/infrastructure/terraform/security-groups.tf",
        "file_line_range": [
          142,
          167
        ],
        "resource": "aws_security_group.eks_cluster",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Name": "securebank-eks-cluster"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "breadcrumbs": {
          "name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_12",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_5",
      "check_name": "Ensure that Security Groups are attached to another resource",
      "title": "Ensure that Security Groups are attached to another resource",
      "severity": "MEDIUM",
      "file": "/security-groups.tf",
      "line": 170,
      "end_line": 215,
      "resource": "aws_security_group.eks_nodes",
      "resource_type": "aws_security_group",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis",
      "compliance_frameworks": [],
      "category": "Network Security",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV2_AWS_5",
        "bc_check_id": "BC_AWS_NETWORKING_51",
        "check_name": "Ensure that Security Groups are attached to another resource",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_security_group": {
              "eks_nodes": {
                "__end_line__": 215,
                "__start_line__": 170,
                "description": [
                  "EKS worker nodes"
                ],
                "egress": [
                  {
                    "description": [
                      "To cluster"
                    ],
                    "from_port": [
                      443
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "security_groups": [
                      [
                        "aws_security_group.eks_cluster.id"
                      ]
                    ],
                    "to_port": [
                      443
                    ]
                  },
                  {
                    "cidr_blocks": [
                      [
                        "0.0.0.0/0"
                      ]
                    ],
                    "description": [
                      "Internet for images/updates"
                    ],
                    "from_port": [
                      443
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "to_port": [
                      443
                    ]
                  }
                ],
                "ingress": [
                  {
                    "description": [
                      "Node to node"
                    ],
                    "from_port": [
                      0
                    ],
                    "protocol": [
                      "-1"
                    ],
                    "self": [
                      true
                    ],
                    "to_port": [
                      65535
                    ]
                  },
                  {
                    "description": [
                      "From cluster"
                    ],
                    "from_port": [
                      1025
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "security_groups": [
                      [
                        "aws_security_group.eks_cluster.id"
                      ]
                    ],
                    "to_port": [
                      65535
                    ]
                  }
                ],
                "name": [
                  "securebank-eks-nodes"
                ],
                "tags": [
                  {
                    "Name": "securebank-eks-nodes",
                    "kubernetes.io/cluster/${var.project_name}": "owned"
                  }
                ],
                "vpc_id": [
                  "aws_vpc.main.id"
                ],
                "__address__": "aws_security_group.eks_nodes"
              }
            }
          },
          "evaluated_keys": [
            "networking",
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/security-groups.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "repo_file_path": "/infrastructure/terraform/security-groups.tf",
        "file_line_range": [
          170,
          215
        ],
        "resource": "aws_security_group.eks_nodes",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Name": "securebank-eks-nodes",
          "kubernetes.io/cluster/${var.project_name}": "owned"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "breadcrumbs": {
          "name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_13",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_62",
      "check_name": "Ensure S3 buckets should have event notifications enabled",
      "title": "Ensure S3 buckets should have event notifications enabled",
      "severity": "MEDIUM",
      "file": "/s3.tf",
      "line": 11,
      "end_line": 23,
      "resource": "aws_s3_bucket.payment_receipts",
      "resource_type": "aws_s3_bucket",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62",
      "compliance_frameworks": [],
      "category": "Security Configuration",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV2_AWS_62",
        "bc_check_id": "BC_AWS_LOGGING_36",
        "check_name": "Ensure S3 buckets should have event notifications enabled",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_s3_bucket": {
              "payment_receipts": {
                "__end_line__": 23,
                "__start_line__": 11,
                "bucket": [
                  "securebank-payment-receipts"
                ],
                "force_destroy": [
                  true
                ],
                "tags": [
                  {
                    "Contains": "Payment Data",
                    "Name": "Payment Receipts",
                    "Public": true
                  }
                ],
                "__address__": "aws_s3_bucket.payment_receipts"
              }
            }
          },
          "evaluated_keys": [
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/s3.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "repo_file_path": "/infrastructure/terraform/s3.tf",
        "file_line_range": [
          11,
          23
        ],
        "resource": "aws_s3_bucket.payment_receipts",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Contains": "Payment Data",
          "Name": "Payment Receipts",
          "Public": true
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "breadcrumbs": {
          "bucket": [
            {
              "type": "variable",
              "name": "environment",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            },
            {
              "type": "resource",
              "name": "aws_s3_bucket.payment_receipts",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_14",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_62",
      "check_name": "Ensure S3 buckets should have event notifications enabled",
      "title": "Ensure S3 buckets should have event notifications enabled",
      "severity": "MEDIUM",
      "file": "/s3.tf",
      "line": 88,
      "end_line": 97,
      "resource": "aws_s3_bucket.audit_logs",
      "resource_type": "aws_s3_bucket",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62",
      "compliance_frameworks": [],
      "category": "Security Configuration",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV2_AWS_62",
        "bc_check_id": "BC_AWS_LOGGING_36",
        "check_name": "Ensure S3 buckets should have event notifications enabled",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_s3_bucket": {
              "audit_logs": {
                "__end_line__": 97,
                "__start_line__": 88,
                "bucket": [
                  "securebank-audit-logs"
                ],
                "force_destroy": [
                  true
                ],
                "tags": [
                  {
                    "Contains": "PCI Audit Logs",
                    "Name": "Audit Logs"
                  }
                ],
                "__address__": "aws_s3_bucket.audit_logs"
              }
            }
          },
          "evaluated_keys": [
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/s3.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "repo_file_path": "/infrastructure/terraform/s3.tf",
        "file_line_range": [
          88,
          97
        ],
        "resource": "aws_s3_bucket.audit_logs",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Contains": "PCI Audit Logs",
          "Name": "Audit Logs"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "breadcrumbs": {
          "bucket": [
            {
              "type": "variable",
              "name": "environment",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            },
            {
              "type": "resource",
              "name": "aws_s3_bucket.audit_logs",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_15",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_57",
      "check_name": "Ensure Secrets Manager secrets should have automatic rotation enabled",
      "title": "Ensure Secrets Manager secrets should have automatic rotation enabled",
      "severity": "MEDIUM",
      "file": "/secrets-manager.tf",
      "line": 9,
      "end_line": 22,
      "resource": "aws_secretsmanager_secret.db_password",
      "resource_type": "aws_secretsmanager_secret",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-57",
      "compliance_frameworks": [],
      "category": "Security Configuration",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV2_AWS_57",
        "bc_check_id": "BC_AWS_GENERAL_192",
        "check_name": "Ensure Secrets Manager secrets should have automatic rotation enabled",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_secretsmanager_secret": {
              "db_password": {
                "__end_line__": 22,
                "__start_line__": 9,
                "description": [
                  "Database password for SecureBank"
                ],
                "name": [
                  "securebank/db/password"
                ],
                "recovery_window_in_days": [
                  0
                ],
                "tags": [
                  {
                    "Name": "Database Password"
                  }
                ],
                "__address__": "aws_secretsmanager_secret.db_password"
              }
            }
          },
          "evaluated_keys": [
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/secrets-manager.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf",
        "repo_file_path": "/infrastructure/terraform/secrets-manager.tf",
        "file_line_range": [
          9,
          22
        ],
        "resource": "aws_secretsmanager_secret.db_password",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Name": "Database Password"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-57",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf",
        "breadcrumbs": {
          "name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_16",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_57",
      "check_name": "Ensure Secrets Manager secrets should have automatic rotation enabled",
      "title": "Ensure Secrets Manager secrets should have automatic rotation enabled",
      "severity": "MEDIUM",
      "file": "/secrets-manager.tf",
      "line": 39,
      "end_line": 46,
      "resource": "aws_secretsmanager_secret.jwt_secret",
      "resource_type": "aws_secretsmanager_secret",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-57",
      "compliance_frameworks": [],
      "category": "Security Configuration",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV2_AWS_57",
        "bc_check_id": "BC_AWS_GENERAL_192",
        "check_name": "Ensure Secrets Manager secrets should have automatic rotation enabled",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_secretsmanager_secret": {
              "jwt_secret": {
                "__end_line__": 46,
                "__start_line__": 39,
                "name": [
                  "securebank/jwt/secret"
                ],
                "recovery_window_in_days": [
                  0
                ],
                "tags": [
                  {
                    "Name": "JWT Secret"
                  }
                ],
                "__address__": "aws_secretsmanager_secret.jwt_secret"
              }
            }
          },
          "evaluated_keys": [
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/secrets-manager.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf",
        "repo_file_path": "/infrastructure/terraform/secrets-manager.tf",
        "file_line_range": [
          39,
          46
        ],
        "resource": "aws_secretsmanager_secret.jwt_secret",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Name": "JWT Secret"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-57",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf",
        "breadcrumbs": {
          "name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_17",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_12",
      "check_name": "Ensure the default security group of every VPC restricts all traffic",
      "title": "Ensure the default security group of every VPC restricts all traffic",
      "severity": "MEDIUM",
      "file": "/vpc.tf",
      "line": 8,
      "end_line": 16,
      "resource": "aws_vpc.main",
      "resource_type": "aws_vpc",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-4",
      "compliance_frameworks": [],
      "category": "Network Security",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV2_AWS_12",
        "bc_check_id": "BC_AWS_NETWORKING_4",
        "check_name": "Ensure the default security group of every VPC restricts all traffic",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_vpc": {
              "main": {
                "__end_line__": 16,
                "__start_line__": 8,
                "cidr_block": [
                  "10.0.0.0/16"
                ],
                "enable_dns_hostnames": [
                  true
                ],
                "enable_dns_support": [
                  true
                ],
                "tags": [
                  {
                    "Name": "securebank-vpc"
                  }
                ],
                "__address__": "aws_vpc.main"
              }
            }
          },
          "evaluated_keys": [
            "ingress/to_port",
            "egress/protocol",
            "ingress/from_port",
            "resource_type",
            "egress/from_port",
            "egress/to_port",
            "ingress/protocol",
            "egress/cidr_blocks",
            "ingress/self"
          ]
        },
        "code_block": null,
        "file_path": "/vpc.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf",
        "repo_file_path": "/infrastructure/terraform/vpc.tf",
        "file_line_range": [
          8,
          16
        ],
        "resource": "aws_vpc.main",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Name": "securebank-vpc"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-4",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf",
        "breadcrumbs": {
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_18",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_60",
      "check_name": "Ensure RDS instance with copy tags to snapshots is enabled",
      "title": "Ensure RDS instance with copy tags to snapshots is enabled",
      "severity": "MEDIUM",
      "file": "/rds.tf",
      "line": 23,
      "end_line": 69,
      "resource": "aws_db_instance.payment_db",
      "resource_type": "aws_db_instance",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-60",
      "compliance_frameworks": [],
      "category": "Backup & Recovery",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV2_AWS_60",
        "bc_check_id": "BC_AWS_GENERAL_195",
        "check_name": "Ensure RDS instance with copy tags to snapshots is enabled",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_db_instance": {
              "payment_db": {
                "__end_line__": 69,
                "__start_line__": 23,
                "allocated_storage": [
                  20
                ],
                "auto_minor_version_upgrade": [
                  true
                ],
                "backup_retention_period": [
                  90
                ],
                "count": [
                  0
                ],
                "db_name": [
                  "securebank"
                ],
                "db_subnet_group_name": [
                  "aws_db_subnet_group.main[0].name"
                ],
                "deletion_protection": [
                  true
                ],
                "enabled_cloudwatch_logs_exports": [
                  [
                    "postgresql"
                  ]
                ],
                "engine": [
                  "postgres"
                ],
                "engine_version": [
                  "14.10"
                ],
                "identifier": [
                  "securebank-payment-db"
                ],
                "instance_class": [
                  "db.t3.micro"
                ],
                "kms_key_id": [
                  "aws_kms_key.securebank.arn"
                ],
                "max_allocated_storage": [
                  100
                ],
                "password": [
                  "supersecret"
                ],
                "publicly_accessible": [
                  false
                ],
                "skip_final_snapshot": [
                  true
                ],
                "storage_encrypted": [
                  true
                ],
                "storage_type": [
                  "gp3"
                ],
                "tags": [
                  {
                    "Compliance": "PCI-DSS",
                    "Contains": "CVV-PIN-PAN",
                    "Encryption": "NONE",
                    "Name": "securebank-payment-db"
                  }
                ],
                "username": [
                  "admin"
                ],
                "vpc_security_group_ids": [
                  [
                    "aws_security_group.database.id"
                  ]
                ],
                "__address__": "aws_db_instance.payment_db"
              }
            }
          },
          "evaluated_keys": [
            "engine",
            "copy_tags_to_snapshot"
          ]
        },
        "code_block": null,
        "file_path": "/rds.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/rds.tf",
        "repo_file_path": "/infrastructure/terraform/rds.tf",
        "file_line_range": [
          23,
          69
        ],
        "resource": "aws_db_instance.payment_db",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Compliance": "PCI-DSS",
          "Contains": "CVV-PIN-PAN",
          "Encryption": "NONE",
          "Name": "securebank-payment-db"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-60",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/rds.tf",
        "breadcrumbs": {
          "password": [
            {
              "type": "variable",
              "name": "db_password",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "db_name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "identifier": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "count": [
            {
              "type": "variable",
              "name": "deployment_target",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "username": [
            {
              "type": "variable",
              "name": "db_username",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_19",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_61",
      "check_name": "Ensure that an S3 bucket has a lifecycle configuration",
      "title": "Ensure that an S3 bucket has a lifecycle configuration",
      "severity": "MEDIUM",
      "file": "/s3.tf",
      "line": 11,
      "end_line": 23,
      "resource": "aws_s3_bucket.payment_receipts",
      "resource_type": "aws_s3_bucket",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61",
      "compliance_frameworks": [],
      "category": "Security Configuration",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV2_AWS_61",
        "bc_check_id": "BC_AWS_LOGGING_35",
        "check_name": "Ensure that an S3 bucket has a lifecycle configuration",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_s3_bucket": {
              "payment_receipts": {
                "__end_line__": 23,
                "__start_line__": 11,
                "bucket": [
                  "securebank-payment-receipts"
                ],
                "force_destroy": [
                  true
                ],
                "tags": [
                  {
                    "Contains": "Payment Data",
                    "Name": "Payment Receipts",
                    "Public": true
                  }
                ],
                "__address__": "aws_s3_bucket.payment_receipts"
              }
            }
          },
          "evaluated_keys": [
            "lifecycle_rule",
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/s3.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "repo_file_path": "/infrastructure/terraform/s3.tf",
        "file_line_range": [
          11,
          23
        ],
        "resource": "aws_s3_bucket.payment_receipts",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Contains": "Payment Data",
          "Name": "Payment Receipts",
          "Public": true
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "breadcrumbs": {
          "bucket": [
            {
              "type": "variable",
              "name": "environment",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            },
            {
              "type": "resource",
              "name": "aws_s3_bucket.payment_receipts",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_20",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_61",
      "check_name": "Ensure that an S3 bucket has a lifecycle configuration",
      "title": "Ensure that an S3 bucket has a lifecycle configuration",
      "severity": "MEDIUM",
      "file": "/s3.tf",
      "line": 88,
      "end_line": 97,
      "resource": "aws_s3_bucket.audit_logs",
      "resource_type": "aws_s3_bucket",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61",
      "compliance_frameworks": [],
      "category": "Security Configuration",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV2_AWS_61",
        "bc_check_id": "BC_AWS_LOGGING_35",
        "check_name": "Ensure that an S3 bucket has a lifecycle configuration",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_s3_bucket": {
              "audit_logs": {
                "__end_line__": 97,
                "__start_line__": 88,
                "bucket": [
                  "securebank-audit-logs"
                ],
                "force_destroy": [
                  true
                ],
                "tags": [
                  {
                    "Contains": "PCI Audit Logs",
                    "Name": "Audit Logs"
                  }
                ],
                "__address__": "aws_s3_bucket.audit_logs"
              }
            }
          },
          "evaluated_keys": [
            "lifecycle_rule",
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/s3.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "repo_file_path": "/infrastructure/terraform/s3.tf",
        "file_line_range": [
          88,
          97
        ],
        "resource": "aws_s3_bucket.audit_logs",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Contains": "PCI Audit Logs",
          "Name": "Audit Logs"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "breadcrumbs": {
          "bucket": [
            {
              "type": "variable",
              "name": "environment",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            },
            {
              "type": "resource",
              "name": "aws_s3_bucket.audit_logs",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_21",
      "scanner": "checkov",
      "check_id": "CKV_AWS_144",
      "check_name": "Ensure that S3 bucket has cross-region replication enabled",
      "title": "Ensure that S3 bucket has cross-region replication enabled",
      "severity": "MEDIUM",
      "file": "/s3.tf",
      "line": 11,
      "end_line": 23,
      "resource": "aws_s3_bucket.payment_receipts",
      "resource_type": "aws_s3_bucket",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled",
      "compliance_frameworks": [],
      "category": "Security Configuration",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV_AWS_144",
        "bc_check_id": "BC_AWS_GENERAL_72",
        "check_name": "Ensure that S3 bucket has cross-region replication enabled",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_s3_bucket": {
              "payment_receipts": {
                "__end_line__": 23,
                "__start_line__": 11,
                "bucket": [
                  "securebank-payment-receipts"
                ],
                "force_destroy": [
                  true
                ],
                "tags": [
                  {
                    "Contains": "Payment Data",
                    "Name": "Payment Receipts",
                    "Public": true
                  }
                ],
                "__address__": "aws_s3_bucket.payment_receipts"
              }
            }
          },
          "evaluated_keys": [
            "resource_type",
            "rule/*/status",
            "replication_configuration/rules/*/status"
          ]
        },
        "code_block": null,
        "file_path": "/s3.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "repo_file_path": "/infrastructure/terraform/s3.tf",
        "file_line_range": [
          11,
          23
        ],
        "resource": "aws_s3_bucket.payment_receipts",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Contains": "Payment Data",
          "Name": "Payment Receipts",
          "Public": true
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "breadcrumbs": {
          "bucket": [
            {
              "type": "variable",
              "name": "environment",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            },
            {
              "type": "resource",
              "name": "aws_s3_bucket.payment_receipts",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_22",
      "scanner": "checkov",
      "check_id": "CKV_AWS_144",
      "check_name": "Ensure that S3 bucket has cross-region replication enabled",
      "title": "Ensure that S3 bucket has cross-region replication enabled",
      "severity": "MEDIUM",
      "file": "/s3.tf",
      "line": 88,
      "end_line": 97,
      "resource": "aws_s3_bucket.audit_logs",
      "resource_type": "aws_s3_bucket",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled",
      "compliance_frameworks": [],
      "category": "Security Configuration",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV_AWS_144",
        "bc_check_id": "BC_AWS_GENERAL_72",
        "check_name": "Ensure that S3 bucket has cross-region replication enabled",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_s3_bucket": {
              "audit_logs": {
                "__end_line__": 97,
                "__start_line__": 88,
                "bucket": [
                  "securebank-audit-logs"
                ],
                "force_destroy": [
                  true
                ],
                "tags": [
                  {
                    "Contains": "PCI Audit Logs",
                    "Name": "Audit Logs"
                  }
                ],
                "__address__": "aws_s3_bucket.audit_logs"
              }
            }
          },
          "evaluated_keys": [
            "resource_type",
            "rule/*/status",
            "replication_configuration/rules/*/status"
          ]
        },
        "code_block": null,
        "file_path": "/s3.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "repo_file_path": "/infrastructure/terraform/s3.tf",
        "file_line_range": [
          88,
          97
        ],
        "resource": "aws_s3_bucket.audit_logs",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Contains": "PCI Audit Logs",
          "Name": "Audit Logs"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "breadcrumbs": {
          "bucket": [
            {
              "type": "variable",
              "name": "environment",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            },
            {
              "type": "resource",
              "name": "aws_s3_bucket.audit_logs",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_23",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_11",
      "check_name": "Ensure VPC flow logging is enabled in all VPCs",
      "title": "Ensure VPC flow logging is enabled in all VPCs",
      "severity": "MEDIUM",
      "file": "/vpc.tf",
      "line": 8,
      "end_line": 16,
      "resource": "aws_vpc.main",
      "resource_type": "aws_vpc",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging",
      "compliance_frameworks": [],
      "category": "Logging & Monitoring",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV2_AWS_11",
        "bc_check_id": "BC_AWS_LOGGING_9",
        "check_name": "Ensure VPC flow logging is enabled in all VPCs",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_vpc": {
              "main": {
                "__end_line__": 16,
                "__start_line__": 8,
                "cidr_block": [
                  "10.0.0.0/16"
                ],
                "enable_dns_hostnames": [
                  true
                ],
                "enable_dns_support": [
                  true
                ],
                "tags": [
                  {
                    "Name": "securebank-vpc"
                  }
                ],
                "__address__": "aws_vpc.main"
              }
            }
          },
          "evaluated_keys": [
            "resource_type",
            "networking"
          ]
        },
        "code_block": null,
        "file_path": "/vpc.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf",
        "repo_file_path": "/infrastructure/terraform/vpc.tf",
        "file_line_range": [
          8,
          16
        ],
        "resource": "aws_vpc.main",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Name": "securebank-vpc"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf",
        "breadcrumbs": {
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_24",
      "scanner": "checkov",
      "check_id": "CKV_AWS_21",
      "check_name": "Ensure all data stored in the S3 bucket have versioning enabled",
      "title": "Ensure all data stored in the S3 bucket have versioning enabled",
      "severity": "MEDIUM",
      "file": "/s3.tf",
      "line": 88,
      "end_line": 97,
      "resource": "aws_s3_bucket.audit_logs",
      "resource_type": "aws_s3_bucket",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning",
      "compliance_frameworks": [],
      "category": "Security Configuration",
      "scan_timestamp": "20251010_125445",
      "_original": {
        "check_id": "CKV_AWS_21",
        "bc_check_id": "BC_AWS_S3_16",
        "check_name": "Ensure all data stored in the S3 bucket have versioning enabled",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_s3_bucket": {
              "audit_logs": {
                "__end_line__": 97,
                "__start_line__": 88,
                "bucket": [
                  "securebank-audit-logs"
                ],
                "force_destroy": [
                  true
                ],
                "tags": [
                  {
                    "Contains": "PCI Audit Logs",
                    "Name": "Audit Logs"
                  }
                ],
                "__address__": "aws_s3_bucket.audit_logs"
              }
            }
          },
          "evaluated_keys": [
            "versioning/enabled",
            "versioning_configuration/status",
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/s3.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "repo_file_path": "/infrastructure/terraform/s3.tf",
        "file_line_range": [
          88,
          97
        ],
        "resource": "aws_s3_bucket.audit_logs",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Contains": "PCI Audit Logs",
          "Name": "Audit Logs"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "breadcrumbs": {
          "bucket": [
            {
              "type": "variable",
              "name": "environment",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            },
            {
              "type": "resource",
              "name": "aws_s3_bucket.audit_logs",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_1",
      "scanner": "checkov",
      "check_id": "CKV_AWS_338",
      "check_name": "Ensure CloudWatch log groups retains logs for at least 1 year",
      "title": "Ensure CloudWatch log groups retains logs for at least 1 year",
      "severity": "MEDIUM",
      "file": "/cloudwatch.tf",
      "line": 8,
      "end_line": 18,
      "resource": "aws_cloudwatch_log_group.app_logs",
      "resource_type": "aws_cloudwatch_log_group",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338",
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "category": "Security Configuration",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV_AWS_338",
        "bc_check_id": "BC_AWS_LOGGING_46",
        "check_name": "Ensure CloudWatch log groups retains logs for at least 1 year",
        "check_result": {
          "result": "FAILED",
          "evaluated_keys": [
            "retention_in_days"
          ]
        },
        "code_block": null,
        "file_path": "/cloudwatch.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/cloudwatch.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/cloudwatch.tf",
        "file_line_range": [
          8,
          18
        ],
        "resource": "aws_cloudwatch_log_group.app_logs",
        "evaluations": null,
        "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetentionYear",
        "fixed_definition": null,
        "entity_tags": {
          "Name": "SecureBank Application Logs"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/cloudwatch.tf",
        "breadcrumbs": {
          "name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      },
      "iso27001_compliance": {
        "controls": [
          "A.12.4.1",
          "A.18.1.3"
        ],
        "control_name": "Logging and monitoring - Log retention",
        "domain": "A.12 - Operations Security",
        "description": "CloudWatch log groups should retain logs for at least 1 year",
        "audit_evidence": [
          "CloudWatch retention policy",
          "Compliance requirement documentation"
        ],
        "remediation_priority": "MEDIUM",
        "estimated_effort_hours": 1
      },
      "soc2_compliance": {
        "criteria": [
          "CC7.2"
        ],
        "criteria_names": [
          "CC7.2 - System Monitoring - Security Events"
        ],
        "trust_service_category": "Security",
        "description": "CloudWatch log retention for audit compliance",
        "control_objective": "The entity retains logs for at least 1 year",
        "audit_evidence": [
          "Retention policy",
          "Compliance documentation"
        ],
        "remediation_priority": "MEDIUM",
        "estimated_effort_hours": 1
      },
      "total_controls_affected": 3,
      "cross_framework_impact": true
    },
    {
      "id": "checkov_2",
      "scanner": "checkov",
      "check_id": "CKV_AWS_149",
      "check_name": "Ensure that Secrets Manager secret is encrypted using KMS CMK",
      "title": "Ensure that Secrets Manager secret is encrypted using KMS CMK",
      "severity": "MEDIUM",
      "file": "/secrets-manager.tf",
      "line": 9,
      "end_line": 22,
      "resource": "aws_secretsmanager_secret.db_password",
      "resource_type": "aws_secretsmanager_secret",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-secrets-manager-secret-is-encrypted-using-kms",
      "compliance_frameworks": [],
      "category": "Encryption",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV_AWS_149",
        "bc_check_id": "BC_AWS_GENERAL_79",
        "check_name": "Ensure that Secrets Manager secret is encrypted using KMS CMK",
        "check_result": {
          "result": "FAILED",
          "evaluated_keys": [
            "kms_key_id"
          ]
        },
        "code_block": null,
        "file_path": "/secrets-manager.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf",
        "file_line_range": [
          9,
          22
        ],
        "resource": "aws_secretsmanager_secret.db_password",
        "evaluations": null,
        "check_class": "checkov.terraform.checks.resource.aws.SecretManagerSecretEncrypted",
        "fixed_definition": null,
        "entity_tags": {
          "Name": "Database Password"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-secrets-manager-secret-is-encrypted-using-kms",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf",
        "breadcrumbs": {
          "name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_3",
      "scanner": "checkov",
      "check_id": "CKV_AWS_149",
      "check_name": "Ensure that Secrets Manager secret is encrypted using KMS CMK",
      "title": "Ensure that Secrets Manager secret is encrypted using KMS CMK",
      "severity": "MEDIUM",
      "file": "/secrets-manager.tf",
      "line": 39,
      "end_line": 46,
      "resource": "aws_secretsmanager_secret.jwt_secret",
      "resource_type": "aws_secretsmanager_secret",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-secrets-manager-secret-is-encrypted-using-kms",
      "compliance_frameworks": [],
      "category": "Encryption",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV_AWS_149",
        "bc_check_id": "BC_AWS_GENERAL_79",
        "check_name": "Ensure that Secrets Manager secret is encrypted using KMS CMK",
        "check_result": {
          "result": "FAILED",
          "evaluated_keys": [
            "kms_key_id"
          ]
        },
        "code_block": null,
        "file_path": "/secrets-manager.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf",
        "file_line_range": [
          39,
          46
        ],
        "resource": "aws_secretsmanager_secret.jwt_secret",
        "evaluations": null,
        "check_class": "checkov.terraform.checks.resource.aws.SecretManagerSecretEncrypted",
        "fixed_definition": null,
        "entity_tags": {
          "Name": "JWT Secret"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-secrets-manager-secret-is-encrypted-using-kms",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf",
        "breadcrumbs": {
          "name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_4",
      "scanner": "checkov",
      "check_id": "CKV_AWS_260",
      "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80",
      "title": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80",
      "severity": "MEDIUM",
      "file": "/security-groups.tf",
      "line": 9,
      "end_line": 46,
      "resource": "aws_security_group.alb",
      "resource_type": "aws_security_group",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80",
      "compliance_frameworks": [],
      "category": "Network Security",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV_AWS_260",
        "bc_check_id": "BC_AWS_NETWORKING_67",
        "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80",
        "check_result": {
          "result": "FAILED",
          "evaluated_keys": [
            "ingress/[1]/from_port",
            "ingress/[1]/to_port",
            "ingress/[1]/cidr_blocks",
            "ingress/[1]/ipv6_cidr_blocks"
          ]
        },
        "code_block": null,
        "file_path": "/security-groups.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "file_line_range": [
          9,
          46
        ],
        "resource": "aws_security_group.alb",
        "evaluations": null,
        "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress80",
        "fixed_definition": null,
        "entity_tags": {
          "Description": "Public ALB - HTTPS only",
          "Name": "securebank-alb",
          "PCI_DSS": "1.2.1"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "breadcrumbs": {
          "name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_5",
      "scanner": "checkov",
      "check_id": "CKV_AWS_130",
      "check_name": "Ensure VPC subnets do not assign public IP by default",
      "title": "Ensure VPC subnets do not assign public IP by default",
      "severity": "MEDIUM",
      "file": "/vpc.tf",
      "line": 19,
      "end_line": 28,
      "resource": "aws_subnet.public_1",
      "resource_type": "aws_subnet",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default",
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "category": "Exposure & Access",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV_AWS_130",
        "bc_check_id": "BC_AWS_NETWORKING_53",
        "check_name": "Ensure VPC subnets do not assign public IP by default",
        "check_result": {
          "result": "FAILED",
          "evaluated_keys": [
            "map_public_ip_on_launch"
          ]
        },
        "code_block": null,
        "file_path": "/vpc.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf",
        "file_line_range": [
          19,
          28
        ],
        "resource": "aws_subnet.public_1",
        "evaluations": null,
        "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP",
        "fixed_definition": null,
        "entity_tags": {
          "Name": "securebank-public-1"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf",
        "breadcrumbs": {
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "availability_zone": [
            {
              "type": "variable",
              "name": "aws_region",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      },
      "iso27001_compliance": {
        "controls": [
          "A.13.1.3"
        ],
        "control_name": "Network controls - VPC flow logs",
        "domain": "A.13 - Communications Security",
        "description": "VPC should have flow logs enabled",
        "audit_evidence": [
          "VPC console showing flow logs",
          "Network monitoring documentation"
        ],
        "remediation_priority": "MEDIUM",
        "estimated_effort_hours": 2
      },
      "soc2_compliance": {
        "criteria": [
          "CC7.2"
        ],
        "criteria_names": [
          "CC7.2 - System Monitoring - Security Events"
        ],
        "trust_service_category": "Security",
        "description": "VPC flow logs for network monitoring",
        "control_objective": "The entity monitors network traffic",
        "audit_evidence": [
          "Flow logs enabled",
          "Network monitoring"
        ],
        "remediation_priority": "MEDIUM",
        "estimated_effort_hours": 2
      },
      "total_controls_affected": 2,
      "cross_framework_impact": true
    },
    {
      "id": "checkov_6",
      "scanner": "checkov",
      "check_id": "CKV_AWS_130",
      "check_name": "Ensure VPC subnets do not assign public IP by default",
      "title": "Ensure VPC subnets do not assign public IP by default",
      "severity": "MEDIUM",
      "file": "/vpc.tf",
      "line": 30,
      "end_line": 39,
      "resource": "aws_subnet.public_2",
      "resource_type": "aws_subnet",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default",
      "compliance_frameworks": [
        "ISO_27001",
        "SOC2"
      ],
      "category": "Exposure & Access",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV_AWS_130",
        "bc_check_id": "BC_AWS_NETWORKING_53",
        "check_name": "Ensure VPC subnets do not assign public IP by default",
        "check_result": {
          "result": "FAILED",
          "evaluated_keys": [
            "map_public_ip_on_launch"
          ]
        },
        "code_block": null,
        "file_path": "/vpc.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf",
        "file_line_range": [
          30,
          39
        ],
        "resource": "aws_subnet.public_2",
        "evaluations": null,
        "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP",
        "fixed_definition": null,
        "entity_tags": {
          "Name": "securebank-public-2"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf",
        "breadcrumbs": {
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "availability_zone": [
            {
              "type": "variable",
              "name": "aws_region",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      },
      "iso27001_compliance": {
        "controls": [
          "A.13.1.3"
        ],
        "control_name": "Network controls - VPC flow logs",
        "domain": "A.13 - Communications Security",
        "description": "VPC should have flow logs enabled",
        "audit_evidence": [
          "VPC console showing flow logs",
          "Network monitoring documentation"
        ],
        "remediation_priority": "MEDIUM",
        "estimated_effort_hours": 2
      },
      "soc2_compliance": {
        "criteria": [
          "CC7.2"
        ],
        "criteria_names": [
          "CC7.2 - System Monitoring - Security Events"
        ],
        "trust_service_category": "Security",
        "description": "VPC flow logs for network monitoring",
        "control_objective": "The entity monitors network traffic",
        "audit_evidence": [
          "Flow logs enabled",
          "Network monitoring"
        ],
        "remediation_priority": "MEDIUM",
        "estimated_effort_hours": 2
      },
      "total_controls_affected": 2,
      "cross_framework_impact": true
    },
    {
      "id": "checkov_7",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_30",
      "check_name": "Ensure Postgres RDS as aws_db_instance has Query Logging enabled",
      "title": "Ensure Postgres RDS as aws_db_instance has Query Logging enabled",
      "severity": "MEDIUM",
      "file": "/rds.tf",
      "line": 23,
      "end_line": 69,
      "resource": "aws_db_instance.payment_db",
      "resource_type": "aws_db_instance",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-postgres-rds-has-query-logging-enabled",
      "compliance_frameworks": [],
      "category": "Logging & Monitoring",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV2_AWS_30",
        "bc_check_id": "BC_AWS_LOGGING_32",
        "check_name": "Ensure Postgres RDS as aws_db_instance has Query Logging enabled",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_db_instance": {
              "payment_db": {
                "__end_line__": 69,
                "__start_line__": 23,
                "allocated_storage": [
                  20
                ],
                "auto_minor_version_upgrade": [
                  true
                ],
                "backup_retention_period": [
                  90
                ],
                "count": [
                  0
                ],
                "db_name": [
                  "securebank"
                ],
                "db_subnet_group_name": [
                  "aws_db_subnet_group.main[0].name"
                ],
                "deletion_protection": [
                  true
                ],
                "enabled_cloudwatch_logs_exports": [
                  [
                    "postgresql"
                  ]
                ],
                "engine": [
                  "postgres"
                ],
                "engine_version": [
                  "14.10"
                ],
                "identifier": [
                  "securebank-payment-db"
                ],
                "instance_class": [
                  "db.t3.micro"
                ],
                "kms_key_id": [
                  "aws_kms_key.securebank.arn"
                ],
                "max_allocated_storage": [
                  100
                ],
                "password": [
                  "supersecret"
                ],
                "publicly_accessible": [
                  false
                ],
                "skip_final_snapshot": [
                  true
                ],
                "storage_encrypted": [
                  true
                ],
                "storage_type": [
                  "gp3"
                ],
                "tags": [
                  {
                    "Compliance": "PCI-DSS",
                    "Contains": "CVV-PIN-PAN",
                    "Encryption": "NONE",
                    "Name": "securebank-payment-db"
                  }
                ],
                "username": [
                  "admin"
                ],
                "vpc_security_group_ids": [
                  [
                    "aws_security_group.database.id"
                  ]
                ],
                "__address__": "aws_db_instance.payment_db"
              }
            }
          },
          "evaluated_keys": [
            "parameter/*/name",
            "engine",
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/rds.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/rds.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/rds.tf",
        "file_line_range": [
          23,
          69
        ],
        "resource": "aws_db_instance.payment_db",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Compliance": "PCI-DSS",
          "Contains": "CVV-PIN-PAN",
          "Encryption": "NONE",
          "Name": "securebank-payment-db"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-postgres-rds-has-query-logging-enabled",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/rds.tf",
        "breadcrumbs": {
          "password": [
            {
              "type": "variable",
              "name": "db_password",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "db_name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "identifier": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "count": [
            {
              "type": "variable",
              "name": "deployment_target",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "username": [
            {
              "type": "variable",
              "name": "db_username",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_8",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_5",
      "check_name": "Ensure that Security Groups are attached to another resource",
      "title": "Ensure that Security Groups are attached to another resource",
      "severity": "MEDIUM",
      "file": "/security-groups.tf",
      "line": 9,
      "end_line": 46,
      "resource": "aws_security_group.alb",
      "resource_type": "aws_security_group",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis",
      "compliance_frameworks": [],
      "category": "Network Security",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV2_AWS_5",
        "bc_check_id": "BC_AWS_NETWORKING_51",
        "check_name": "Ensure that Security Groups are attached to another resource",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_security_group": {
              "alb": {
                "__end_line__": 46,
                "__start_line__": 9,
                "description": [
                  "Allow HTTPS from internet to ALB only"
                ],
                "egress": [
                  {
                    "description": [
                      "To backend app"
                    ],
                    "from_port": [
                      3000
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "security_groups": [
                      [
                        "aws_security_group.backend.id"
                      ]
                    ],
                    "to_port": [
                      3000
                    ]
                  }
                ],
                "ingress": [
                  {
                    "cidr_blocks": [
                      [
                        "0.0.0.0/0"
                      ]
                    ],
                    "description": [
                      "HTTPS from internet"
                    ],
                    "from_port": [
                      443
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "to_port": [
                      443
                    ]
                  },
                  {
                    "cidr_blocks": [
                      [
                        "0.0.0.0/0"
                      ]
                    ],
                    "description": [
                      "HTTP redirect to HTTPS"
                    ],
                    "from_port": [
                      80
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "to_port": [
                      80
                    ]
                  }
                ],
                "name": [
                  "securebank-alb"
                ],
                "tags": [
                  {
                    "Description": "Public ALB - HTTPS only",
                    "Name": "securebank-alb",
                    "PCI_DSS": "1.2.1"
                  }
                ],
                "vpc_id": [
                  "aws_vpc.main.id"
                ],
                "__address__": "aws_security_group.alb"
              }
            }
          },
          "evaluated_keys": [
            "networking",
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/security-groups.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "file_line_range": [
          9,
          46
        ],
        "resource": "aws_security_group.alb",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Description": "Public ALB - HTTPS only",
          "Name": "securebank-alb",
          "PCI_DSS": "1.2.1"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "breadcrumbs": {
          "name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_9",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_5",
      "check_name": "Ensure that Security Groups are attached to another resource",
      "title": "Ensure that Security Groups are attached to another resource",
      "severity": "MEDIUM",
      "file": "/security-groups.tf",
      "line": 49,
      "end_line": 95,
      "resource": "aws_security_group.backend",
      "resource_type": "aws_security_group",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis",
      "compliance_frameworks": [],
      "category": "Network Security",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV2_AWS_5",
        "bc_check_id": "BC_AWS_NETWORKING_51",
        "check_name": "Ensure that Security Groups are attached to another resource",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_security_group": {
              "backend": {
                "__end_line__": 95,
                "__start_line__": 49,
                "description": [
                  "Backend app - only from ALB"
                ],
                "egress": [
                  {
                    "description": [
                      "To database"
                    ],
                    "from_port": [
                      5432
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "security_groups": [
                      [
                        "aws_security_group.database.id"
                      ]
                    ],
                    "to_port": [
                      5432
                    ]
                  },
                  {
                    "description": [
                      "To Redis"
                    ],
                    "from_port": [
                      6379
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "security_groups": [
                      [
                        "aws_security_group.redis.id"
                      ]
                    ],
                    "to_port": [
                      6379
                    ]
                  },
                  {
                    "cidr_blocks": [
                      [
                        "0.0.0.0/0"
                      ]
                    ],
                    "description": [
                      "AWS API calls"
                    ],
                    "from_port": [
                      443
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "to_port": [
                      443
                    ]
                  }
                ],
                "ingress": [
                  {
                    "description": [
                      "From ALB only"
                    ],
                    "from_port": [
                      3000
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "security_groups": [
                      [
                        "aws_security_group.alb.id"
                      ]
                    ],
                    "to_port": [
                      3000
                    ]
                  }
                ],
                "name": [
                  "securebank-backend"
                ],
                "tags": [
                  {
                    "Description": "Backend - ALB to DB only",
                    "Name": "securebank-backend",
                    "PCI_DSS": "1.2.1"
                  }
                ],
                "vpc_id": [
                  "aws_vpc.main.id"
                ],
                "__address__": "aws_security_group.backend"
              }
            }
          },
          "evaluated_keys": [
            "networking",
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/security-groups.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "file_line_range": [
          49,
          95
        ],
        "resource": "aws_security_group.backend",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Description": "Backend - ALB to DB only",
          "Name": "securebank-backend",
          "PCI_DSS": "1.2.1"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "breadcrumbs": {
          "name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_10",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_5",
      "check_name": "Ensure that Security Groups are attached to another resource",
      "title": "Ensure that Security Groups are attached to another resource",
      "severity": "MEDIUM",
      "file": "/security-groups.tf",
      "line": 122,
      "end_line": 139,
      "resource": "aws_security_group.redis",
      "resource_type": "aws_security_group",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis",
      "compliance_frameworks": [],
      "category": "Network Security",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV2_AWS_5",
        "bc_check_id": "BC_AWS_NETWORKING_51",
        "check_name": "Ensure that Security Groups are attached to another resource",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_security_group": {
              "redis": {
                "__end_line__": 139,
                "__start_line__": 122,
                "description": [
                  "Redis - only from backend"
                ],
                "ingress": [
                  {
                    "description": [
                      "Redis from backend only"
                    ],
                    "from_port": [
                      6379
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "security_groups": [
                      [
                        "aws_security_group.backend.id"
                      ]
                    ],
                    "to_port": [
                      6379
                    ]
                  }
                ],
                "name": [
                  "securebank-redis"
                ],
                "tags": [
                  {
                    "Description": "Redis cache",
                    "Name": "securebank-redis"
                  }
                ],
                "vpc_id": [
                  "aws_vpc.main.id"
                ],
                "__address__": "aws_security_group.redis"
              }
            }
          },
          "evaluated_keys": [
            "networking",
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/security-groups.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "file_line_range": [
          122,
          139
        ],
        "resource": "aws_security_group.redis",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Description": "Redis cache",
          "Name": "securebank-redis"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "breadcrumbs": {
          "name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_11",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_5",
      "check_name": "Ensure that Security Groups are attached to another resource",
      "title": "Ensure that Security Groups are attached to another resource",
      "severity": "MEDIUM",
      "file": "/security-groups.tf",
      "line": 142,
      "end_line": 167,
      "resource": "aws_security_group.eks_cluster",
      "resource_type": "aws_security_group",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis",
      "compliance_frameworks": [],
      "category": "Network Security",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV2_AWS_5",
        "bc_check_id": "BC_AWS_NETWORKING_51",
        "check_name": "Ensure that Security Groups are attached to another resource",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_security_group": {
              "eks_cluster": {
                "__end_line__": 167,
                "__start_line__": 142,
                "description": [
                  "EKS cluster control plane"
                ],
                "egress": [
                  {
                    "description": [
                      "To worker nodes"
                    ],
                    "from_port": [
                      1025
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "security_groups": [
                      [
                        "aws_security_group.eks_nodes.id"
                      ]
                    ],
                    "to_port": [
                      65535
                    ]
                  }
                ],
                "ingress": [
                  {
                    "description": [
                      "From worker nodes"
                    ],
                    "from_port": [
                      443
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "security_groups": [
                      [
                        "aws_security_group.eks_nodes.id"
                      ]
                    ],
                    "to_port": [
                      443
                    ]
                  }
                ],
                "name": [
                  "securebank-eks-cluster"
                ],
                "tags": [
                  {
                    "Name": "securebank-eks-cluster"
                  }
                ],
                "vpc_id": [
                  "aws_vpc.main.id"
                ],
                "__address__": "aws_security_group.eks_cluster"
              }
            }
          },
          "evaluated_keys": [
            "networking",
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/security-groups.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "file_line_range": [
          142,
          167
        ],
        "resource": "aws_security_group.eks_cluster",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Name": "securebank-eks-cluster"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "breadcrumbs": {
          "name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_12",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_5",
      "check_name": "Ensure that Security Groups are attached to another resource",
      "title": "Ensure that Security Groups are attached to another resource",
      "severity": "MEDIUM",
      "file": "/security-groups.tf",
      "line": 170,
      "end_line": 215,
      "resource": "aws_security_group.eks_nodes",
      "resource_type": "aws_security_group",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis",
      "compliance_frameworks": [],
      "category": "Network Security",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV2_AWS_5",
        "bc_check_id": "BC_AWS_NETWORKING_51",
        "check_name": "Ensure that Security Groups are attached to another resource",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_security_group": {
              "eks_nodes": {
                "__end_line__": 215,
                "__start_line__": 170,
                "description": [
                  "EKS worker nodes"
                ],
                "egress": [
                  {
                    "description": [
                      "To cluster"
                    ],
                    "from_port": [
                      443
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "security_groups": [
                      [
                        "aws_security_group.eks_cluster.id"
                      ]
                    ],
                    "to_port": [
                      443
                    ]
                  },
                  {
                    "cidr_blocks": [
                      [
                        "0.0.0.0/0"
                      ]
                    ],
                    "description": [
                      "Internet for images/updates"
                    ],
                    "from_port": [
                      443
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "to_port": [
                      443
                    ]
                  }
                ],
                "ingress": [
                  {
                    "description": [
                      "Node to node"
                    ],
                    "from_port": [
                      0
                    ],
                    "protocol": [
                      "-1"
                    ],
                    "self": [
                      true
                    ],
                    "to_port": [
                      65535
                    ]
                  },
                  {
                    "description": [
                      "From cluster"
                    ],
                    "from_port": [
                      1025
                    ],
                    "protocol": [
                      "tcp"
                    ],
                    "security_groups": [
                      [
                        "aws_security_group.eks_cluster.id"
                      ]
                    ],
                    "to_port": [
                      65535
                    ]
                  }
                ],
                "name": [
                  "securebank-eks-nodes"
                ],
                "tags": [
                  {
                    "Name": "securebank-eks-nodes",
                    "kubernetes.io/cluster/${var.project_name}": "owned"
                  }
                ],
                "vpc_id": [
                  "aws_vpc.main.id"
                ],
                "__address__": "aws_security_group.eks_nodes"
              }
            }
          },
          "evaluated_keys": [
            "networking",
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/security-groups.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "file_line_range": [
          170,
          215
        ],
        "resource": "aws_security_group.eks_nodes",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Name": "securebank-eks-nodes",
          "kubernetes.io/cluster/${var.project_name}": "owned"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf",
        "breadcrumbs": {
          "name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_13",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_62",
      "check_name": "Ensure S3 buckets should have event notifications enabled",
      "title": "Ensure S3 buckets should have event notifications enabled",
      "severity": "MEDIUM",
      "file": "/s3.tf",
      "line": 11,
      "end_line": 23,
      "resource": "aws_s3_bucket.payment_receipts",
      "resource_type": "aws_s3_bucket",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62",
      "compliance_frameworks": [],
      "category": "Security Configuration",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV2_AWS_62",
        "bc_check_id": "BC_AWS_LOGGING_36",
        "check_name": "Ensure S3 buckets should have event notifications enabled",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_s3_bucket": {
              "payment_receipts": {
                "__end_line__": 23,
                "__start_line__": 11,
                "bucket": [
                  "securebank-payment-receipts"
                ],
                "force_destroy": [
                  true
                ],
                "tags": [
                  {
                    "Contains": "Payment Data",
                    "Name": "Payment Receipts",
                    "Public": true
                  }
                ],
                "__address__": "aws_s3_bucket.payment_receipts"
              }
            }
          },
          "evaluated_keys": [
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/s3.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "file_line_range": [
          11,
          23
        ],
        "resource": "aws_s3_bucket.payment_receipts",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Contains": "Payment Data",
          "Name": "Payment Receipts",
          "Public": true
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "breadcrumbs": {
          "bucket": [
            {
              "type": "variable",
              "name": "environment",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            },
            {
              "type": "resource",
              "name": "aws_s3_bucket.payment_receipts",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_14",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_62",
      "check_name": "Ensure S3 buckets should have event notifications enabled",
      "title": "Ensure S3 buckets should have event notifications enabled",
      "severity": "MEDIUM",
      "file": "/s3.tf",
      "line": 88,
      "end_line": 97,
      "resource": "aws_s3_bucket.audit_logs",
      "resource_type": "aws_s3_bucket",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62",
      "compliance_frameworks": [],
      "category": "Security Configuration",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV2_AWS_62",
        "bc_check_id": "BC_AWS_LOGGING_36",
        "check_name": "Ensure S3 buckets should have event notifications enabled",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_s3_bucket": {
              "audit_logs": {
                "__end_line__": 97,
                "__start_line__": 88,
                "bucket": [
                  "securebank-audit-logs"
                ],
                "force_destroy": [
                  true
                ],
                "tags": [
                  {
                    "Contains": "PCI Audit Logs",
                    "Name": "Audit Logs"
                  }
                ],
                "__address__": "aws_s3_bucket.audit_logs"
              }
            }
          },
          "evaluated_keys": [
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/s3.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "file_line_range": [
          88,
          97
        ],
        "resource": "aws_s3_bucket.audit_logs",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Contains": "PCI Audit Logs",
          "Name": "Audit Logs"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "breadcrumbs": {
          "bucket": [
            {
              "type": "variable",
              "name": "environment",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            },
            {
              "type": "resource",
              "name": "aws_s3_bucket.audit_logs",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_15",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_57",
      "check_name": "Ensure Secrets Manager secrets should have automatic rotation enabled",
      "title": "Ensure Secrets Manager secrets should have automatic rotation enabled",
      "severity": "MEDIUM",
      "file": "/secrets-manager.tf",
      "line": 9,
      "end_line": 22,
      "resource": "aws_secretsmanager_secret.db_password",
      "resource_type": "aws_secretsmanager_secret",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-57",
      "compliance_frameworks": [],
      "category": "Security Configuration",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV2_AWS_57",
        "bc_check_id": "BC_AWS_GENERAL_192",
        "check_name": "Ensure Secrets Manager secrets should have automatic rotation enabled",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_secretsmanager_secret": {
              "db_password": {
                "__end_line__": 22,
                "__start_line__": 9,
                "description": [
                  "Database password for SecureBank"
                ],
                "name": [
                  "securebank/db/password"
                ],
                "recovery_window_in_days": [
                  0
                ],
                "tags": [
                  {
                    "Name": "Database Password"
                  }
                ],
                "__address__": "aws_secretsmanager_secret.db_password"
              }
            }
          },
          "evaluated_keys": [
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/secrets-manager.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf",
        "file_line_range": [
          9,
          22
        ],
        "resource": "aws_secretsmanager_secret.db_password",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Name": "Database Password"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-57",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf",
        "breadcrumbs": {
          "name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_16",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_57",
      "check_name": "Ensure Secrets Manager secrets should have automatic rotation enabled",
      "title": "Ensure Secrets Manager secrets should have automatic rotation enabled",
      "severity": "MEDIUM",
      "file": "/secrets-manager.tf",
      "line": 39,
      "end_line": 46,
      "resource": "aws_secretsmanager_secret.jwt_secret",
      "resource_type": "aws_secretsmanager_secret",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-57",
      "compliance_frameworks": [],
      "category": "Security Configuration",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV2_AWS_57",
        "bc_check_id": "BC_AWS_GENERAL_192",
        "check_name": "Ensure Secrets Manager secrets should have automatic rotation enabled",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_secretsmanager_secret": {
              "jwt_secret": {
                "__end_line__": 46,
                "__start_line__": 39,
                "name": [
                  "securebank/jwt/secret"
                ],
                "recovery_window_in_days": [
                  0
                ],
                "tags": [
                  {
                    "Name": "JWT Secret"
                  }
                ],
                "__address__": "aws_secretsmanager_secret.jwt_secret"
              }
            }
          },
          "evaluated_keys": [
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/secrets-manager.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf",
        "file_line_range": [
          39,
          46
        ],
        "resource": "aws_secretsmanager_secret.jwt_secret",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Name": "JWT Secret"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-57",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf",
        "breadcrumbs": {
          "name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_17",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_12",
      "check_name": "Ensure the default security group of every VPC restricts all traffic",
      "title": "Ensure the default security group of every VPC restricts all traffic",
      "severity": "MEDIUM",
      "file": "/vpc.tf",
      "line": 8,
      "end_line": 16,
      "resource": "aws_vpc.main",
      "resource_type": "aws_vpc",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-4",
      "compliance_frameworks": [],
      "category": "Network Security",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV2_AWS_12",
        "bc_check_id": "BC_AWS_NETWORKING_4",
        "check_name": "Ensure the default security group of every VPC restricts all traffic",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_vpc": {
              "main": {
                "__end_line__": 16,
                "__start_line__": 8,
                "cidr_block": [
                  "10.0.0.0/16"
                ],
                "enable_dns_hostnames": [
                  true
                ],
                "enable_dns_support": [
                  true
                ],
                "tags": [
                  {
                    "Name": "securebank-vpc"
                  }
                ],
                "__address__": "aws_vpc.main"
              }
            }
          },
          "evaluated_keys": [
            "resource_type",
            "egress/from_port",
            "ingress/to_port",
            "egress/cidr_blocks",
            "egress/to_port",
            "ingress/from_port",
            "ingress/self",
            "egress/protocol",
            "ingress/protocol"
          ]
        },
        "code_block": null,
        "file_path": "/vpc.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf",
        "file_line_range": [
          8,
          16
        ],
        "resource": "aws_vpc.main",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Name": "securebank-vpc"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-4",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf",
        "breadcrumbs": {
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_18",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_60",
      "check_name": "Ensure RDS instance with copy tags to snapshots is enabled",
      "title": "Ensure RDS instance with copy tags to snapshots is enabled",
      "severity": "MEDIUM",
      "file": "/rds.tf",
      "line": 23,
      "end_line": 69,
      "resource": "aws_db_instance.payment_db",
      "resource_type": "aws_db_instance",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-60",
      "compliance_frameworks": [],
      "category": "Backup & Recovery",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV2_AWS_60",
        "bc_check_id": "BC_AWS_GENERAL_195",
        "check_name": "Ensure RDS instance with copy tags to snapshots is enabled",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_db_instance": {
              "payment_db": {
                "__end_line__": 69,
                "__start_line__": 23,
                "allocated_storage": [
                  20
                ],
                "auto_minor_version_upgrade": [
                  true
                ],
                "backup_retention_period": [
                  90
                ],
                "count": [
                  0
                ],
                "db_name": [
                  "securebank"
                ],
                "db_subnet_group_name": [
                  "aws_db_subnet_group.main[0].name"
                ],
                "deletion_protection": [
                  true
                ],
                "enabled_cloudwatch_logs_exports": [
                  [
                    "postgresql"
                  ]
                ],
                "engine": [
                  "postgres"
                ],
                "engine_version": [
                  "14.10"
                ],
                "identifier": [
                  "securebank-payment-db"
                ],
                "instance_class": [
                  "db.t3.micro"
                ],
                "kms_key_id": [
                  "aws_kms_key.securebank.arn"
                ],
                "max_allocated_storage": [
                  100
                ],
                "password": [
                  "supersecret"
                ],
                "publicly_accessible": [
                  false
                ],
                "skip_final_snapshot": [
                  true
                ],
                "storage_encrypted": [
                  true
                ],
                "storage_type": [
                  "gp3"
                ],
                "tags": [
                  {
                    "Compliance": "PCI-DSS",
                    "Contains": "CVV-PIN-PAN",
                    "Encryption": "NONE",
                    "Name": "securebank-payment-db"
                  }
                ],
                "username": [
                  "admin"
                ],
                "vpc_security_group_ids": [
                  [
                    "aws_security_group.database.id"
                  ]
                ],
                "__address__": "aws_db_instance.payment_db"
              }
            }
          },
          "evaluated_keys": [
            "copy_tags_to_snapshot",
            "engine"
          ]
        },
        "code_block": null,
        "file_path": "/rds.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/rds.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/rds.tf",
        "file_line_range": [
          23,
          69
        ],
        "resource": "aws_db_instance.payment_db",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Compliance": "PCI-DSS",
          "Contains": "CVV-PIN-PAN",
          "Encryption": "NONE",
          "Name": "securebank-payment-db"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-60",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/rds.tf",
        "breadcrumbs": {
          "password": [
            {
              "type": "variable",
              "name": "db_password",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "db_name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "identifier": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "count": [
            {
              "type": "variable",
              "name": "deployment_target",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ],
          "username": [
            {
              "type": "variable",
              "name": "db_username",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_19",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_61",
      "check_name": "Ensure that an S3 bucket has a lifecycle configuration",
      "title": "Ensure that an S3 bucket has a lifecycle configuration",
      "severity": "MEDIUM",
      "file": "/s3.tf",
      "line": 11,
      "end_line": 23,
      "resource": "aws_s3_bucket.payment_receipts",
      "resource_type": "aws_s3_bucket",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61",
      "compliance_frameworks": [],
      "category": "Security Configuration",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV2_AWS_61",
        "bc_check_id": "BC_AWS_LOGGING_35",
        "check_name": "Ensure that an S3 bucket has a lifecycle configuration",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_s3_bucket": {
              "payment_receipts": {
                "__end_line__": 23,
                "__start_line__": 11,
                "bucket": [
                  "securebank-payment-receipts"
                ],
                "force_destroy": [
                  true
                ],
                "tags": [
                  {
                    "Contains": "Payment Data",
                    "Name": "Payment Receipts",
                    "Public": true
                  }
                ],
                "__address__": "aws_s3_bucket.payment_receipts"
              }
            }
          },
          "evaluated_keys": [
            "lifecycle_rule",
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/s3.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "file_line_range": [
          11,
          23
        ],
        "resource": "aws_s3_bucket.payment_receipts",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Contains": "Payment Data",
          "Name": "Payment Receipts",
          "Public": true
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "breadcrumbs": {
          "bucket": [
            {
              "type": "variable",
              "name": "environment",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            },
            {
              "type": "resource",
              "name": "aws_s3_bucket.payment_receipts",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_20",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_61",
      "check_name": "Ensure that an S3 bucket has a lifecycle configuration",
      "title": "Ensure that an S3 bucket has a lifecycle configuration",
      "severity": "MEDIUM",
      "file": "/s3.tf",
      "line": 88,
      "end_line": 97,
      "resource": "aws_s3_bucket.audit_logs",
      "resource_type": "aws_s3_bucket",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61",
      "compliance_frameworks": [],
      "category": "Security Configuration",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV2_AWS_61",
        "bc_check_id": "BC_AWS_LOGGING_35",
        "check_name": "Ensure that an S3 bucket has a lifecycle configuration",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_s3_bucket": {
              "audit_logs": {
                "__end_line__": 97,
                "__start_line__": 88,
                "bucket": [
                  "securebank-audit-logs"
                ],
                "force_destroy": [
                  true
                ],
                "tags": [
                  {
                    "Contains": "PCI Audit Logs",
                    "Name": "Audit Logs"
                  }
                ],
                "__address__": "aws_s3_bucket.audit_logs"
              }
            }
          },
          "evaluated_keys": [
            "lifecycle_rule",
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/s3.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "file_line_range": [
          88,
          97
        ],
        "resource": "aws_s3_bucket.audit_logs",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Contains": "PCI Audit Logs",
          "Name": "Audit Logs"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "breadcrumbs": {
          "bucket": [
            {
              "type": "variable",
              "name": "environment",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            },
            {
              "type": "resource",
              "name": "aws_s3_bucket.audit_logs",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_21",
      "scanner": "checkov",
      "check_id": "CKV2_AWS_11",
      "check_name": "Ensure VPC flow logging is enabled in all VPCs",
      "title": "Ensure VPC flow logging is enabled in all VPCs",
      "severity": "MEDIUM",
      "file": "/vpc.tf",
      "line": 8,
      "end_line": 16,
      "resource": "aws_vpc.main",
      "resource_type": "aws_vpc",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging",
      "compliance_frameworks": [],
      "category": "Logging & Monitoring",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV2_AWS_11",
        "bc_check_id": "BC_AWS_LOGGING_9",
        "check_name": "Ensure VPC flow logging is enabled in all VPCs",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_vpc": {
              "main": {
                "__end_line__": 16,
                "__start_line__": 8,
                "cidr_block": [
                  "10.0.0.0/16"
                ],
                "enable_dns_hostnames": [
                  true
                ],
                "enable_dns_support": [
                  true
                ],
                "tags": [
                  {
                    "Name": "securebank-vpc"
                  }
                ],
                "__address__": "aws_vpc.main"
              }
            }
          },
          "evaluated_keys": [
            "networking",
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/vpc.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf",
        "file_line_range": [
          8,
          16
        ],
        "resource": "aws_vpc.main",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Name": "securebank-vpc"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf",
        "breadcrumbs": {
          "tags.Name": [
            {
              "type": "variable",
              "name": "project_name",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_22",
      "scanner": "checkov",
      "check_id": "CKV_AWS_144",
      "check_name": "Ensure that S3 bucket has cross-region replication enabled",
      "title": "Ensure that S3 bucket has cross-region replication enabled",
      "severity": "MEDIUM",
      "file": "/s3.tf",
      "line": 11,
      "end_line": 23,
      "resource": "aws_s3_bucket.payment_receipts",
      "resource_type": "aws_s3_bucket",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled",
      "compliance_frameworks": [],
      "category": "Security Configuration",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV_AWS_144",
        "bc_check_id": "BC_AWS_GENERAL_72",
        "check_name": "Ensure that S3 bucket has cross-region replication enabled",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_s3_bucket": {
              "payment_receipts": {
                "__end_line__": 23,
                "__start_line__": 11,
                "bucket": [
                  "securebank-payment-receipts"
                ],
                "force_destroy": [
                  true
                ],
                "tags": [
                  {
                    "Contains": "Payment Data",
                    "Name": "Payment Receipts",
                    "Public": true
                  }
                ],
                "__address__": "aws_s3_bucket.payment_receipts"
              }
            }
          },
          "evaluated_keys": [
            "replication_configuration/rules/*/status",
            "resource_type",
            "rule/*/status"
          ]
        },
        "code_block": null,
        "file_path": "/s3.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "file_line_range": [
          11,
          23
        ],
        "resource": "aws_s3_bucket.payment_receipts",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Contains": "Payment Data",
          "Name": "Payment Receipts",
          "Public": true
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "breadcrumbs": {
          "bucket": [
            {
              "type": "variable",
              "name": "environment",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            },
            {
              "type": "resource",
              "name": "aws_s3_bucket.payment_receipts",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_23",
      "scanner": "checkov",
      "check_id": "CKV_AWS_144",
      "check_name": "Ensure that S3 bucket has cross-region replication enabled",
      "title": "Ensure that S3 bucket has cross-region replication enabled",
      "severity": "MEDIUM",
      "file": "/s3.tf",
      "line": 88,
      "end_line": 97,
      "resource": "aws_s3_bucket.audit_logs",
      "resource_type": "aws_s3_bucket",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled",
      "compliance_frameworks": [],
      "category": "Security Configuration",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV_AWS_144",
        "bc_check_id": "BC_AWS_GENERAL_72",
        "check_name": "Ensure that S3 bucket has cross-region replication enabled",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_s3_bucket": {
              "audit_logs": {
                "__end_line__": 97,
                "__start_line__": 88,
                "bucket": [
                  "securebank-audit-logs"
                ],
                "force_destroy": [
                  true
                ],
                "tags": [
                  {
                    "Contains": "PCI Audit Logs",
                    "Name": "Audit Logs"
                  }
                ],
                "__address__": "aws_s3_bucket.audit_logs"
              }
            }
          },
          "evaluated_keys": [
            "replication_configuration/rules/*/status",
            "resource_type",
            "rule/*/status"
          ]
        },
        "code_block": null,
        "file_path": "/s3.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "file_line_range": [
          88,
          97
        ],
        "resource": "aws_s3_bucket.audit_logs",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Contains": "PCI Audit Logs",
          "Name": "Audit Logs"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "breadcrumbs": {
          "bucket": [
            {
              "type": "variable",
              "name": "environment",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            },
            {
              "type": "resource",
              "name": "aws_s3_bucket.audit_logs",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
              "module_connection": false
            }
          ]
        }
      }
    },
    {
      "id": "checkov_24",
      "scanner": "checkov",
      "check_id": "CKV_AWS_21",
      "check_name": "Ensure all data stored in the S3 bucket have versioning enabled",
      "title": "Ensure all data stored in the S3 bucket have versioning enabled",
      "severity": "MEDIUM",
      "file": "/s3.tf",
      "line": 88,
      "end_line": 97,
      "resource": "aws_s3_bucket.audit_logs",
      "resource_type": "aws_s3_bucket",
      "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning",
      "compliance_frameworks": [],
      "category": "Security Configuration",
      "scan_timestamp": "20251010_122102",
      "_original": {
        "check_id": "CKV_AWS_21",
        "bc_check_id": "BC_AWS_S3_16",
        "check_name": "Ensure all data stored in the S3 bucket have versioning enabled",
        "check_result": {
          "result": "FAILED",
          "entity": {
            "aws_s3_bucket": {
              "audit_logs": {
                "__end_line__": 97,
                "__start_line__": 88,
                "bucket": [
                  "securebank-audit-logs"
                ],
                "force_destroy": [
                  true
                ],
                "tags": [
                  {
                    "Contains": "PCI Audit Logs",
                    "Name": "Audit Logs"
                  }
                ],
                "__address__": "aws_s3_bucket.audit_logs"
              }
            }
          },
          "evaluated_keys": [
            "versioning/enabled",
            "versioning_configuration/status",
            "resource_type"
          ]
        },
        "code_block": null,
        "file_path": "/s3.tf",
        "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "repo_file_path": "/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "file_line_range": [
          88,
          97
        ],
        "resource": "aws_s3_bucket.audit_logs",
        "evaluations": null,
        "check_class": "checkov.common.graph.checks_infra.base_check",
        "fixed_definition": null,
        "entity_tags": {
          "Contains": "PCI Audit Logs",
          "Name": "Audit Logs"
        },
        "caller_file_path": null,
        "caller_file_line_range": null,
        "resource_address": null,
        "severity": null,
        "bc_category": null,
        "benchmarks": null,
        "description": null,
        "short_description": null,
        "vulnerability_details": null,
        "connected_node": null,
        "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning",
        "details": [],
        "check_len": null,
        "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
        "breadcrumbs": {
          "bucket": [
            {
              "type": "variable",
              "name": "environment",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf",
              "module_connection": false
            },
            {
              "type": "resource",
              "name": "aws_s3_bucket.audit_logs",
              "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf",
              "module_connection": false
            }
          ]
        }
      }
    }
  ]
}