{"check_type": "terraform", "results": {"passed_checks": [{"check_id": "CKV_AWS_66", "bc_check_id": "BC_AWS_LOGGING_13", "check_name": "Ensure that CloudWatch Log Group specifies retention days", "check_result": {"result": "PASSED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[8, "resource \"aws_cloudwatch_log_group\" \"app_logs\" {\n"], [9, "  name              = \"/aws/${var.project_name}/application\"\n"], [10, "  retention_in_days = 1  # \u274c Should be 90+ days\n"], [11, "\n"], [12, "  # \u274c PCI 3.4: No encryption\n"], [13, "  # kms_key_id = aws_kms_key.logs.arn\n"], [14, "\n"], [15, "  tags = {\n"], [16, "    Name = \"SecureBank Application Logs\"\n"], [17, "  }\n"], [18, "}"]], "file_path": "/cloudwatch.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/cloudwatch.tf", "repo_file_path": "/infrastructure/terraform/cloudwatch.tf", "file_line_range": [8, 18], "resource": "aws_cloudwatch_log_group.app_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetention", "fixed_definition": null, "entity_tags": {"Name": "SecureBank Application Logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-13", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/cloudwatch.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[75, "resource \"aws_iam_role\" \"app_role\" {\n"], [76, "  name = \"${var.project_name}-app-role\"\n"], [77, "\n"], [78, "  assume_role_policy = jsonencode({\n"], [79, "    Version = \"2012-10-17\"\n"], [80, "    Statement = [{\n"], [81, "      Action = \"sts:AssumeRole\"\n"], [82, "      Effect = \"Allow\"\n"], [83, "      Principal = {\n"], [84, "        Service = \"ec2.amazonaws.com\"\n"], [85, "      }\n"], [86, "    }]\n"], [87, "  })\n"], [88, "\n"], [89, "  tags = {\n"], [90, "    Name = \"${var.project_name}-app-role\"\n"], [91, "  }\n"], [92, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "repo_file_path": "/infrastructure/terraform/iam.tf", "file_line_range": [75, 92], "resource": "aws_iam_role.app_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"Name": "securebank-app-role"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[75, "resource \"aws_iam_role\" \"app_role\" {\n"], [76, "  name = \"${var.project_name}-app-role\"\n"], [77, "\n"], [78, "  assume_role_policy = jsonencode({\n"], [79, "    Version = \"2012-10-17\"\n"], [80, "    Statement = [{\n"], [81, "      Action = \"sts:AssumeRole\"\n"], [82, "      Effect = \"Allow\"\n"], [83, "      Principal = {\n"], [84, "        Service = \"ec2.amazonaws.com\"\n"], [85, "      }\n"], [86, "    }]\n"], [87, "  })\n"], [88, "\n"], [89, "  tags = {\n"], [90, "    Name = \"${var.project_name}-app-role\"\n"], [91, "  }\n"], [92, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "repo_file_path": "/infrastructure/terraform/iam.tf", "file_line_range": [75, 92], "resource": "aws_iam_role.app_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"Name": "securebank-app-role"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[75, "resource \"aws_iam_role\" \"app_role\" {\n"], [76, "  name = \"${var.project_name}-app-role\"\n"], [77, "\n"], [78, "  assume_role_policy = jsonencode({\n"], [79, "    Version = \"2012-10-17\"\n"], [80, "    Statement = [{\n"], [81, "      Action = \"sts:AssumeRole\"\n"], [82, "      Effect = \"Allow\"\n"], [83, "      Principal = {\n"], [84, "        Service = \"ec2.amazonaws.com\"\n"], [85, "      }\n"], [86, "    }]\n"], [87, "  })\n"], [88, "\n"], [89, "  tags = {\n"], [90, "    Name = \"${var.project_name}-app-role\"\n"], [91, "  }\n"], [92, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "repo_file_path": "/infrastructure/terraform/iam.tf", "file_line_range": [75, 92], "resource": "aws_iam_role.app_role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"Name": "securebank-app-role"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_41", "bc_check_id": "BC_AWS_SECRETS_5", "check_name": "Ensure no hard coded AWS access key and secret key exists in provider", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[5, "provider \"aws\" {\n"], [6, "  region = var.aws_region\n"], [7, "\n"], [8, "  # \u274c PCI 7.1: Using root account credentials\n"], [9, "  # PROPER: Use IAM roles with least privilege\n"], [10, "\n"], [11, "  # LocalStack endpoint overrides\n"], [12, "  dynamic \"endpoints\" {\n"], [13, "    for_each = var.deployment_target == \"localstack\" ? [1] : []\n"], [14, "    content {\n"], [15, "      s3             = var.localstack_endpoint\n"], [16, "      secretsmanager = var.localstack_endpoint\n"], [17, "      rds            = var.localstack_endpoint\n"], [18, "      cloudwatch     = var.localstack_endpoint\n"], [19, "      cloudwatchlogs = var.localstack_endpoint\n"], [20, "      iam            = var.localstack_endpoint\n"], [21, "      ec2            = var.localstack_endpoint\n"], [22, "      eks            = var.localstack_endpoint\n"], [23, "      ecr            = var.localstack_endpoint\n"], [24, "      sts            = var.localstack_endpoint\n"], [25, "    }\n"], [26, "  }\n"], [27, "\n"], [28, "  # LocalStack doesn't validate credentials\n"], [29, "  skip_credentials_validation = var.deployment_target == \"localstack\"\n"], [30, "  skip_metadata_api_check     = var.deployment_target == \"localstack\"\n"], [31, "  skip_requesting_account_id  = var.deployment_target == \"localstack\"\n"], [32, "\n"], [33, "  # LocalStack uses fake credentials\n"], [34, "  access_key = var.deployment_target == \"localstack\" ? \"test\" : null\n"], [35, "  secret_key = var.deployment_target == \"localstack\" ? \"test\" : null\n"], [36, "\n"], [37, "  default_tags {\n"], [38, "    tags = {\n"], [39, "      Project          = \"SecureBank\"\n"], [40, "      Environment      = var.environment\n"], [41, "      ManagedBy        = \"Terraform\"\n"], [42, "      DeploymentTarget = var.deployment_target\n"], [43, "      # \u274c PCI 12.3: No data classification tag\n"], [44, "    }\n"], [45, "  }\n"], [46, "}"]], "file_path": "/provider.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/provider.tf", "repo_file_path": "/infrastructure/terraform/provider.tf", "file_line_range": [5, 46], "resource": "aws.default", "evaluations": null, "check_class": "checkov.terraform.checks.provider.aws.credentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/provider.tf", "breadcrumbs": {"access_key": [{"type": "variable", "name": "deployment_target", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "secret_key": [{"type": "variable", "name": "deployment_target", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "skip_credentials_validation": [{"type": "variable", "name": "deployment_target", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "skip_metadata_api_check": [{"type": "variable", "name": "deployment_target", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "skip_requesting_account_id": [{"type": "variable", "name": "deployment_target", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "default_tags.tags.DeploymentTarget": [{"type": "variable", "name": "deployment_target", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "default_tags.tags": [{"type": "variable", "name": "environment", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "dynamic.endpoints.for_each": [{"type": "variable", "name": "deployment_target", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "dynamic.endpoints": [{"type": "variable", "name": "localstack_endpoint", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "region": [{"type": "variable", "name": "aws_region", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "dynamic.endpoints.content.cloudwatch": [{"type": "variable", "name": "localstack_endpoint", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "dynamic.endpoints.content": [{"type": "variable", "name": "localstack_endpoint", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "dynamic.endpoints.content.cloudwatchlogs": [{"type": "variable", "name": "localstack_endpoint", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "dynamic.endpoints.content.ec2": [{"type": "variable", "name": "localstack_endpoint", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "dynamic.endpoints.content.ecr": [{"type": "variable", "name": "localstack_endpoint", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "dynamic.endpoints.content.eks": [{"type": "variable", "name": "localstack_endpoint", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "dynamic.endpoints.content.iam": [{"type": "variable", "name": "localstack_endpoint", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "dynamic.endpoints.content.rds": [{"type": "variable", "name": "localstack_endpoint", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "dynamic.endpoints.content.s3": [{"type": "variable", "name": "localstack_endpoint", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "dynamic.endpoints.content.secretsmanager": [{"type": "variable", "name": "localstack_endpoint", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "dynamic.endpoints.content.sts": [{"type": "variable", "name": "localstack_endpoint", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "default_tags.tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[11, "resource \"aws_s3_bucket\" \"payment_receipts\" {\n"], [12, "  # LocalStack doesn't require globally unique names\n"], [13, "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-payment-receipts\" : \"${var.project_name}-payment-receipts-${var.environment}-${data.aws_caller_identity.current.account_id}\"\n"], [14, "\n"], [15, "  # \u274c PCI 3.4: Force destroy allows data loss\n"], [16, "  force_destroy = true\n"], [17, "\n"], [18, "  tags = {\n"], [19, "    Name     = \"Payment Receipts\"\n"], [20, "    Contains = \"Payment Data\"  # \u274c Contains PII/PCI data!\n"], [21, "    Public   = \"true\"\n"], [22, "  }\n"], [23, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [11, 23], "resource": "aws_s3_bucket.payment_receipts", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Contains": "Payment Data", "Name": "Payment Receipts", "Public": true}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.payment_receipts", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[38, "resource \"aws_s3_bucket_policy\" \"payment_receipts_public\" {\n"], [39, "  bucket = aws_s3_bucket.payment_receipts.id\n"], [40, "\n"], [41, "  # \u274c PCI 7.1: Public read access to payment data\n"], [42, "  policy = jsonencode({\n"], [43, "    Version = \"2012-10-17\"\n"], [44, "    Statement = [\n"], [45, "      {\n"], [46, "        Sid       = \"PublicReadGetObject\"\n"], [47, "        Effect    = \"Allow\"\n"], [48, "        Principal = \"*\"  # \u274c CRITICAL: Anyone can read!\n"], [49, "        Action    = \"s3:GetObject\"\n"], [50, "        Resource  = \"${aws_s3_bucket.payment_receipts.arn}/*\"\n"], [51, "      }\n"], [52, "    ]\n"], [53, "  })\n"], [54, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [38, 54], "resource": "aws_s3_bucket_policy.payment_receipts_public", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf"}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[72, "resource \"aws_s3_bucket\" \"audit_logs\" {\n"], [73, "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-audit-logs\" : \"${var.project_name}-audit-logs-${var.environment}-${data.aws_caller_identity.current.account_id}\"\n"], [74, "\n"], [75, "  force_destroy = true\n"], [76, "\n"], [77, "  tags = {\n"], [78, "    Name     = \"Audit Logs\"\n"], [79, "    Contains = \"PCI Audit Logs\"\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [72, 81], "resource": "aws_s3_bucket.audit_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Contains": "PCI Audit Logs", "Name": "Audit Logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.audit_logs", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_277", "bc_check_id": "BC_AWS_NETWORKING_78", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[8, "resource \"aws_security_group\" \"allow_all\" {\n"], [9, "  name        = \"${var.project_name}-allow-all\"\n"], [10, "  description = \"Allow all inbound traffic\"  # \u274c CRITICAL!\n"], [11, "  vpc_id      = aws_vpc.main.id\n"], [12, "\n"], [13, "  # \u274c PCI 1.3.1: Allows 0.0.0.0/0 to database\n"], [14, "  ingress {\n"], [15, "    description = \"Allow all inbound\"\n"], [16, "    from_port   = 0\n"], [17, "    to_port     = 65535\n"], [18, "    protocol    = \"tcp\"\n"], [19, "    cidr_blocks = [\"0.0.0.0/0\"]  # \u274c CRITICAL: Open to internet!\n"], [20, "  }\n"], [21, "\n"], [22, "  egress {\n"], [23, "    description = \"Allow all outbound\"\n"], [24, "    from_port   = 0\n"], [25, "    to_port     = 0\n"], [26, "    protocol    = \"-1\"\n"], [27, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [28, "  }\n"], [29, "\n"], [30, "  tags = {\n"], [31, "    Name = \"${var.project_name}-allow-all\"\n"], [32, "  }\n"], [33, "}"]], "file_path": "/security-groups.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf", "repo_file_path": "/infrastructure/terraform/security-groups.tf", "file_line_range": [8, 33], "resource": "aws_security_group.allow_all", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngressAny", "fixed_definition": null, "entity_tags": {"Name": "securebank-allow-all"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security group and rule has a description", "check_result": {"result": "PASSED", "evaluated_keys": ["description"]}, "code_block": [[8, "resource \"aws_security_group\" \"allow_all\" {\n"], [9, "  name        = \"${var.project_name}-allow-all\"\n"], [10, "  description = \"Allow all inbound traffic\"  # \u274c CRITICAL!\n"], [11, "  vpc_id      = aws_vpc.main.id\n"], [12, "\n"], [13, "  # \u274c PCI 1.3.1: Allows 0.0.0.0/0 to database\n"], [14, "  ingress {\n"], [15, "    description = \"Allow all inbound\"\n"], [16, "    from_port   = 0\n"], [17, "    to_port     = 65535\n"], [18, "    protocol    = \"tcp\"\n"], [19, "    cidr_blocks = [\"0.0.0.0/0\"]  # \u274c CRITICAL: Open to internet!\n"], [20, "  }\n"], [21, "\n"], [22, "  egress {\n"], [23, "    description = \"Allow all outbound\"\n"], [24, "    from_port   = 0\n"], [25, "    to_port     = 0\n"], [26, "    protocol    = \"-1\"\n"], [27, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [28, "  }\n"], [29, "\n"], [30, "  tags = {\n"], [31, "    Name = \"${var.project_name}-allow-all\"\n"], [32, "  }\n"], [33, "}"]], "file_path": "/security-groups.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf", "repo_file_path": "/infrastructure/terraform/security-groups.tf", "file_line_range": [8, 33], "resource": "aws_security_group.allow_all", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": {"Name": "securebank-allow-all"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_44", "bc_check_id": "BC_AWS_NETWORKING_80", "check_name": "Ensure AWS route table with VPC peering does not contain routes overly permissive to all traffic", "check_result": {"result": "PASSED", "entity": {"aws_route_table": {"public": {"__end_line__": 63, "__start_line__": 52, "route": [{"cidr_block": ["0.0.0.0/0"], "gateway_id": ["aws_internet_gateway.main.id"]}], "tags": [{"Name": "securebank-public-rt"}], "vpc_id": ["aws_vpc.main.id"], "__address__": "aws_route_table.public"}}}, "evaluated_keys": ["destination_cidr_block", "vpc_peering_connection_id", "route/*/vpc_peering_connection_id", "route/*/ipv6_cidr_block", "destination_ipv6_cidr_block", "route/*/cidr_block"]}, "code_block": [[52, "resource \"aws_route_table\" \"public\" {\n"], [53, "  vpc_id = aws_vpc.main.id\n"], [54, "\n"], [55, "  route {\n"], [56, "    cidr_block = \"0.0.0.0/0\"\n"], [57, "    gateway_id = aws_internet_gateway.main.id\n"], [58, "  }\n"], [59, "\n"], [60, "  tags = {\n"], [61, "    Name = \"${var.project_name}-public-rt\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/vpc.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf", "repo_file_path": "/infrastructure/terraform/vpc.tf", "file_line_range": [52, 63], "resource": "aws_route_table.public", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "securebank-public-rt"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-route-table-with-vpc-peering-does-not-contain-routes-overly-permissive-to-all-traffic", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf", "breadcrumbs": {"tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "PASSED", "entity": {"aws_security_group": {"allow_all": {"__end_line__": 33, "__start_line__": 8, "description": ["Allow all inbound traffic"], "egress": [{"cidr_blocks": [["0.0.0.0/0"]], "description": ["Allow all outbound"], "from_port": [0], "protocol": ["-1"], "to_port": [0]}], "ingress": [{"cidr_blocks": [["0.0.0.0/0"]], "description": ["Allow all inbound"], "from_port": [0], "protocol": ["tcp"], "to_port": [65535]}], "name": ["securebank-allow-all"], "tags": [{"Name": "securebank-allow-all"}], "vpc_id": ["aws_vpc.main.id"], "__address__": "aws_security_group.allow_all"}}}, "evaluated_keys": ["networking", "resource_type"]}, "code_block": [[8, "resource \"aws_security_group\" \"allow_all\" {\n"], [9, "  name        = \"${var.project_name}-allow-all\"\n"], [10, "  description = \"Allow all inbound traffic\"  # \u274c CRITICAL!\n"], [11, "  vpc_id      = aws_vpc.main.id\n"], [12, "\n"], [13, "  # \u274c PCI 1.3.1: Allows 0.0.0.0/0 to database\n"], [14, "  ingress {\n"], [15, "    description = \"Allow all inbound\"\n"], [16, "    from_port   = 0\n"], [17, "    to_port     = 65535\n"], [18, "    protocol    = \"tcp\"\n"], [19, "    cidr_blocks = [\"0.0.0.0/0\"]  # \u274c CRITICAL: Open to internet!\n"], [20, "  }\n"], [21, "\n"], [22, "  egress {\n"], [23, "    description = \"Allow all outbound\"\n"], [24, "    from_port   = 0\n"], [25, "    to_port     = 0\n"], [26, "    protocol    = \"-1\"\n"], [27, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [28, "  }\n"], [29, "\n"], [30, "  tags = {\n"], [31, "    Name = \"${var.project_name}-allow-all\"\n"], [32, "  }\n"], [33, "}"]], "file_path": "/security-groups.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf", "repo_file_path": "/infrastructure/terraform/security-groups.tf", "file_line_range": [8, 33], "resource": "aws_security_group.allow_all", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "securebank-allow-all"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"eks_cluster": {"__end_line__": 27, "__start_line__": 9, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "eks.amazonaws.com"}}]}], "count": [0], "name": ["securebank-eks-cluster-role"], "tags": [{"Name": "securebank-eks-cluster-role"}], "__address__": "aws_iam_role.eks_cluster"}}}, "evaluated_keys": ["arn", "managed_policy_arns/*", "policy_arn", "name", "managed_policy_arn"]}, "code_block": [[9, "resource \"aws_iam_role\" \"eks_cluster\" {\n"], [10, "  count = var.deployment_target == \"aws\" ? 1 : 0\n"], [11, "  name  = \"${var.project_name}-eks-cluster-role\"\n"], [12, "\n"], [13, "  assume_role_policy = jsonencode({\n"], [14, "    Version = \"2012-10-17\"\n"], [15, "    Statement = [{\n"], [16, "      Action = \"sts:AssumeRole\"\n"], [17, "      Effect = \"Allow\"\n"], [18, "      Principal = {\n"], [19, "        Service = \"eks.amazonaws.com\"\n"], [20, "      }\n"], [21, "    }]\n"], [22, "  })\n"], [23, "\n"], [24, "  tags = {\n"], [25, "    Name = \"${var.project_name}-eks-cluster-role\"\n"], [26, "  }\n"], [27, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "repo_file_path": "/infrastructure/terraform/iam.tf", "file_line_range": [9, 27], "resource": "aws_iam_role.eks_cluster", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "securebank-eks-cluster-role"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "breadcrumbs": {"count": [{"type": "variable", "name": "deployment_target", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"eks_cluster_policy": {"__end_line__": 33, "__start_line__": 29, "count": [0], "policy_arn": ["arn:aws:iam::aws:policy/AmazonEKSClusterPolicy"], "role": ["aws_iam_role.eks_cluster[0].name"], "__address__": "aws_iam_role_policy_attachment.eks_cluster_policy"}}}, "evaluated_keys": ["arn", "managed_policy_arns/*", "policy_arn", "name", "managed_policy_arn"]}, "code_block": [[29, "resource \"aws_iam_role_policy_attachment\" \"eks_cluster_policy\" {\n"], [30, "  count      = var.deployment_target == \"aws\" ? 1 : 0\n"], [31, "  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKSClusterPolicy\"\n"], [32, "  role       = aws_iam_role.eks_cluster[0].name\n"], [33, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "repo_file_path": "/infrastructure/terraform/iam.tf", "file_line_range": [29, 33], "resource": "aws_iam_role_policy_attachment.eks_cluster_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "breadcrumbs": {"count": [{"type": "variable", "name": "deployment_target", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"eks_node": {"__end_line__": 54, "__start_line__": 36, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "ec2.amazonaws.com"}}]}], "count": [0], "name": ["securebank-eks-node-role"], "tags": [{"Name": "securebank-eks-node-role"}], "__address__": "aws_iam_role.eks_node"}}}, "evaluated_keys": ["arn", "managed_policy_arns/*", "policy_arn", "name", "managed_policy_arn"]}, "code_block": [[36, "resource \"aws_iam_role\" \"eks_node\" {\n"], [37, "  count = var.deployment_target == \"aws\" ? 1 : 0\n"], [38, "  name  = \"${var.project_name}-eks-node-role\"\n"], [39, "\n"], [40, "  assume_role_policy = jsonencode({\n"], [41, "    Version = \"2012-10-17\"\n"], [42, "    Statement = [{\n"], [43, "      Action = \"sts:AssumeRole\"\n"], [44, "      Effect = \"Allow\"\n"], [45, "      Principal = {\n"], [46, "        Service = \"ec2.amazonaws.com\"\n"], [47, "      }\n"], [48, "    }]\n"], [49, "  })\n"], [50, "\n"], [51, "  tags = {\n"], [52, "    Name = \"${var.project_name}-eks-node-role\"\n"], [53, "  }\n"], [54, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "repo_file_path": "/infrastructure/terraform/iam.tf", "file_line_range": [36, 54], "resource": "aws_iam_role.eks_node", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "securebank-eks-node-role"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "breadcrumbs": {"count": [{"type": "variable", "name": "deployment_target", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"eks_node_policy": {"__end_line__": 60, "__start_line__": 56, "count": [0], "policy_arn": ["arn:aws:iam::aws:policy/AmazonEKSWorkerNodePolicy"], "role": ["aws_iam_role.eks_node[0].name"], "__address__": "aws_iam_role_policy_attachment.eks_node_policy"}}}, "evaluated_keys": ["arn", "managed_policy_arns/*", "policy_arn", "name", "managed_policy_arn"]}, "code_block": [[56, "resource \"aws_iam_role_policy_attachment\" \"eks_node_policy\" {\n"], [57, "  count      = var.deployment_target == \"aws\" ? 1 : 0\n"], [58, "  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKSWorkerNodePolicy\"\n"], [59, "  role       = aws_iam_role.eks_node[0].name\n"], [60, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "repo_file_path": "/infrastructure/terraform/iam.tf", "file_line_range": [56, 60], "resource": "aws_iam_role_policy_attachment.eks_node_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "breadcrumbs": {"count": [{"type": "variable", "name": "deployment_target", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"eks_cni_policy": {"__end_line__": 66, "__start_line__": 62, "count": [0], "policy_arn": ["arn:aws:iam::aws:policy/AmazonEKS_CNI_Policy"], "role": ["aws_iam_role.eks_node[0].name"], "__address__": "aws_iam_role_policy_attachment.eks_cni_policy"}}}, "evaluated_keys": ["arn", "managed_policy_arns/*", "policy_arn", "name", "managed_policy_arn"]}, "code_block": [[62, "resource \"aws_iam_role_policy_attachment\" \"eks_cni_policy\" {\n"], [63, "  count      = var.deployment_target == \"aws\" ? 1 : 0\n"], [64, "  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKS_CNI_Policy\"\n"], [65, "  role       = aws_iam_role.eks_node[0].name\n"], [66, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "repo_file_path": "/infrastructure/terraform/iam.tf", "file_line_range": [62, 66], "resource": "aws_iam_role_policy_attachment.eks_cni_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "breadcrumbs": {"count": [{"type": "variable", "name": "deployment_target", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"eks_registry_policy": {"__end_line__": 72, "__start_line__": 68, "count": [0], "policy_arn": ["arn:aws:iam::aws:policy/AmazonEC2ContainerRegistryReadOnly"], "role": ["aws_iam_role.eks_node[0].name"], "__address__": "aws_iam_role_policy_attachment.eks_registry_policy"}}}, "evaluated_keys": ["arn", "managed_policy_arns/*", "policy_arn", "name", "managed_policy_arn"]}, "code_block": [[68, "resource \"aws_iam_role_policy_attachment\" \"eks_registry_policy\" {\n"], [69, "  count      = var.deployment_target == \"aws\" ? 1 : 0\n"], [70, "  policy_arn = \"arn:aws:iam::aws:policy/AmazonEC2ContainerRegistryReadOnly\"\n"], [71, "  role       = aws_iam_role.eks_node[0].name\n"], [72, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "repo_file_path": "/infrastructure/terraform/iam.tf", "file_line_range": [68, 72], "resource": "aws_iam_role_policy_attachment.eks_registry_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "breadcrumbs": {"count": [{"type": "variable", "name": "deployment_target", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"app_role": {"__end_line__": 92, "__start_line__": 75, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "ec2.amazonaws.com"}}]}], "name": ["securebank-app-role"], "tags": [{"Name": "securebank-app-role"}], "__address__": "aws_iam_role.app_role"}}}, "evaluated_keys": ["arn", "managed_policy_arns/*", "policy_arn", "name", "managed_policy_arn"]}, "code_block": [[75, "resource \"aws_iam_role\" \"app_role\" {\n"], [76, "  name = \"${var.project_name}-app-role\"\n"], [77, "\n"], [78, "  assume_role_policy = jsonencode({\n"], [79, "    Version = \"2012-10-17\"\n"], [80, "    Statement = [{\n"], [81, "      Action = \"sts:AssumeRole\"\n"], [82, "      Effect = \"Allow\"\n"], [83, "      Principal = {\n"], [84, "        Service = \"ec2.amazonaws.com\"\n"], [85, "      }\n"], [86, "    }]\n"], [87, "  })\n"], [88, "\n"], [89, "  tags = {\n"], [90, "    Name = \"${var.project_name}-app-role\"\n"], [91, "  }\n"], [92, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "repo_file_path": "/infrastructure/terraform/iam.tf", "file_line_range": [75, 92], "resource": "aws_iam_role.app_role", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "securebank-app-role"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_35", "bc_check_id": "BC_AWS_NETWORKING_77", "check_name": "AWS NAT Gateways should be utilized for the default route", "check_result": {"result": "PASSED", "entity": {"aws_route_table": {"public": {"__end_line__": 63, "__start_line__": 52, "route": [{"cidr_block": ["0.0.0.0/0"], "gateway_id": ["aws_internet_gateway.main.id"]}], "tags": [{"Name": "securebank-public-rt"}], "vpc_id": ["aws_vpc.main.id"], "__address__": "aws_route_table.public"}}}, "evaluated_keys": ["destination_cidr_block", "route/*/instance_id", "instance_id", "route/*/cidr_block"]}, "code_block": [[52, "resource \"aws_route_table\" \"public\" {\n"], [53, "  vpc_id = aws_vpc.main.id\n"], [54, "\n"], [55, "  route {\n"], [56, "    cidr_block = \"0.0.0.0/0\"\n"], [57, "    gateway_id = aws_internet_gateway.main.id\n"], [58, "  }\n"], [59, "\n"], [60, "  tags = {\n"], [61, "    Name = \"${var.project_name}-public-rt\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/vpc.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf", "repo_file_path": "/infrastructure/terraform/vpc.tf", "file_line_range": [52, 63], "resource": "aws_route_table.public", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "securebank-public-rt"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-nat-gateways-are-utilized-for-the-default-route", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf", "breadcrumbs": {"tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_69", "bc_check_id": "BC_AWS_NETWORKING_93", "check_name": "Ensure AWS RDS database instance configured with encryption in transit", "check_result": {"result": "PASSED", "entity": {"aws_db_instance": {"payment_db": {"__end_line__": 69, "__start_line__": 23, "allocated_storage": [20], "auto_minor_version_upgrade": [false], "backup_retention_period": [1], "count": [0], "db_name": ["securebank"], "db_subnet_group_name": ["aws_db_subnet_group.main[0].name"], "deletion_protection": [false], "enabled_cloudwatch_logs_exports": [[]], "engine": ["postgres"], "engine_version": ["14.10"], "identifier": ["securebank-payment-db"], "instance_class": ["db.t3.micro"], "max_allocated_storage": [100], "password": ["supersecret"], "publicly_accessible": [true], "skip_final_snapshot": [true], "storage_encrypted": [false], "storage_type": ["gp3"], "tags": [{"Compliance": "PCI-DSS", "Contains": "CVV-PIN-PAN", "Encryption": "NONE", "Name": "securebank-payment-db"}], "username": ["admin"], "vpc_security_group_ids": [["aws_security_group.allow_all.id"]], "__address__": "aws_db_instance.payment_db"}}}, "evaluated_keys": ["resource_type", "family", "parameter[?(@/name=='require_secure_transport')]/value", "parameter[?(@/name=='db2comm')]/value", "parameter[?(@/name=='rds/force_ssl')]/value"]}, "code_block": [[23, "resource \"aws_db_instance\" \"payment_db\" {\n"], [24, "  # LocalStack has limited RDS support\n"], [25, "  count = var.deployment_target == \"aws\" ? 1 : 0\n"], [26, "\n"], [27, "  identifier     = \"${var.project_name}-payment-db\"\n"], [28, "  engine         = \"postgres\"\n"], [29, "  engine_version = \"14.10\"\n"], [30, "  instance_class = \"db.t3.micro\"\n"], [31, "\n"], [32, "  allocated_storage     = 20\n"], [33, "  max_allocated_storage = 100\n"], [34, "  storage_type          = \"gp3\"\n"], [35, "\n"], [36, "  # \u274c PCI 3.4: No storage encryption\n"], [37, "  storage_encrypted = false  # \u274c CRITICAL!\n"], [38, "  # kms_key_id = aws_kms_key.rds.arn\n"], [39, "\n"], [40, "  db_name  = var.project_name\n"], [41, "  username = var.db_username  # \u274c \"admin\"\n"], [42, "  password = var.db_password  # \u274c \"supersecret\"\n"], [43, "\n"], [44, "  # \u274c PCI 2.3: Publicly accessible database!\n"], [45, "  publicly_accessible = true  # \u274c CRITICAL!\n"], [46, "\n"], [47, "  vpc_security_group_ids = [aws_security_group.allow_all.id]\n"], [48, "  db_subnet_group_name   = aws_db_subnet_group.main[0].name\n"], [49, "\n"], [50, "  # \u274c PCI 10.7: Backup retention too short\n"], [51, "  backup_retention_period = 1  # \u274c Should be 90+ days\n"], [52, "\n"], [53, "  # \u274c PCI 2.4: No automated patching\n"], [54, "  auto_minor_version_upgrade = false\n"], [55, "\n"], [56, "  # \u274c PCI 10.1: No enhanced monitoring\n"], [57, "  enabled_cloudwatch_logs_exports = []  # \u274c Should log all queries\n"], [58, "\n"], [59, "  # \u274c Deletion protection disabled\n"], [60, "  deletion_protection = false\n"], [61, "  skip_final_snapshot = true\n"], [62, "\n"], [63, "  tags = {\n"], [64, "    Name        = \"${var.project_name}-payment-db\"\n"], [65, "    Contains    = \"CVV-PIN-PAN\"  # \u274c Advertising sensitive data!\n"], [66, "    Compliance  = \"PCI-DSS\"\n"], [67, "    Encryption  = \"NONE\"  # \u274c Red flag!\n"], [68, "  }\n"], [69, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/rds.tf", "repo_file_path": "/infrastructure/terraform/rds.tf", "file_line_range": [23, 69], "resource": "aws_db_instance.payment_db", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Compliance": "PCI-DSS", "Contains": "CVV-PIN-PAN", "Encryption": "NONE", "Name": "securebank-payment-db"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-69", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/rds.tf", "breadcrumbs": {"count": [{"type": "variable", "name": "deployment_target", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "username": [{"type": "variable", "name": "db_username", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "password": [{"type": "variable", "name": "db_password", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "db_name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "identifier": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"payment_receipts": {"__end_line__": 23, "__start_line__": 11, "bucket": ["securebank-payment-receipts"], "force_destroy": [true], "tags": [{"Contains": "Payment Data", "Name": "Payment Receipts", "Public": true}], "__address__": "aws_s3_bucket.payment_receipts"}}}, "evaluated_keys": ["access_control_policy/grant/*/permission", "access_control_policy/grant", "resource_type", "access_control_policy/grant/*/grantee/uri", "access_control_policy", "acl"]}, "code_block": [[11, "resource \"aws_s3_bucket\" \"payment_receipts\" {\n"], [12, "  # LocalStack doesn't require globally unique names\n"], [13, "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-payment-receipts\" : \"${var.project_name}-payment-receipts-${var.environment}-${data.aws_caller_identity.current.account_id}\"\n"], [14, "\n"], [15, "  # \u274c PCI 3.4: Force destroy allows data loss\n"], [16, "  force_destroy = true\n"], [17, "\n"], [18, "  tags = {\n"], [19, "    Name     = \"Payment Receipts\"\n"], [20, "    Contains = \"Payment Data\"  # \u274c Contains PII/PCI data!\n"], [21, "    Public   = \"true\"\n"], [22, "  }\n"], [23, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [11, 23], "resource": "aws_s3_bucket.payment_receipts", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Contains": "Payment Data", "Name": "Payment Receipts", "Public": true}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.payment_receipts", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"audit_logs": {"__end_line__": 81, "__start_line__": 72, "bucket": ["securebank-audit-logs"], "force_destroy": [true], "tags": [{"Contains": "PCI Audit Logs", "Name": "Audit Logs"}], "__address__": "aws_s3_bucket.audit_logs"}}}, "evaluated_keys": ["access_control_policy/grant/*/permission", "access_control_policy/grant", "resource_type", "access_control_policy/grant/*/grantee/uri", "access_control_policy", "acl"]}, "code_block": [[72, "resource \"aws_s3_bucket\" \"audit_logs\" {\n"], [73, "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-audit-logs\" : \"${var.project_name}-audit-logs-${var.environment}-${data.aws_caller_identity.current.account_id}\"\n"], [74, "\n"], [75, "  force_destroy = true\n"], [76, "\n"], [77, "  tags = {\n"], [78, "    Name     = \"Audit Logs\"\n"], [79, "    Contains = \"PCI Audit Logs\"\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [72, 81], "resource": "aws_s3_bucket.audit_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Contains": "PCI Audit Logs", "Name": "Audit Logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.audit_logs", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"payment_receipts": {"__end_line__": 23, "__start_line__": 11, "bucket": ["securebank-payment-receipts"], "force_destroy": [true], "tags": [{"Contains": "Payment Data", "Name": "Payment Receipts", "Public": true}], "__address__": "aws_s3_bucket.payment_receipts"}}}, "evaluated_keys": ["access_control_policy/grant", "resource_type", "access_control_policy", "access_control_policy/grant/*/grantee/uri", "acl"]}, "code_block": [[11, "resource \"aws_s3_bucket\" \"payment_receipts\" {\n"], [12, "  # LocalStack doesn't require globally unique names\n"], [13, "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-payment-receipts\" : \"${var.project_name}-payment-receipts-${var.environment}-${data.aws_caller_identity.current.account_id}\"\n"], [14, "\n"], [15, "  # \u274c PCI 3.4: Force destroy allows data loss\n"], [16, "  force_destroy = true\n"], [17, "\n"], [18, "  tags = {\n"], [19, "    Name     = \"Payment Receipts\"\n"], [20, "    Contains = \"Payment Data\"  # \u274c Contains PII/PCI data!\n"], [21, "    Public   = \"true\"\n"], [22, "  }\n"], [23, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [11, 23], "resource": "aws_s3_bucket.payment_receipts", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Contains": "Payment Data", "Name": "Payment Receipts", "Public": true}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.payment_receipts", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"audit_logs": {"__end_line__": 81, "__start_line__": 72, "bucket": ["securebank-audit-logs"], "force_destroy": [true], "tags": [{"Contains": "PCI Audit Logs", "Name": "Audit Logs"}], "__address__": "aws_s3_bucket.audit_logs"}}}, "evaluated_keys": ["access_control_policy/grant", "resource_type", "access_control_policy", "access_control_policy/grant/*/grantee/uri", "acl"]}, "code_block": [[72, "resource \"aws_s3_bucket\" \"audit_logs\" {\n"], [73, "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-audit-logs\" : \"${var.project_name}-audit-logs-${var.environment}-${data.aws_caller_identity.current.account_id}\"\n"], [74, "\n"], [75, "  force_destroy = true\n"], [76, "\n"], [77, "  tags = {\n"], [78, "    Name     = \"Audit Logs\"\n"], [79, "    Contains = \"PCI Audit Logs\"\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [72, 81], "resource": "aws_s3_bucket.audit_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Contains": "PCI Audit Logs", "Name": "Audit Logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.audit_logs", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"payment_receipts": {"__end_line__": 23, "__start_line__": 11, "bucket": ["securebank-payment-receipts"], "force_destroy": [true], "tags": [{"Contains": "Payment Data", "Name": "Payment Receipts", "Public": true}], "__address__": "aws_s3_bucket.payment_receipts"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type"]}, "code_block": [[11, "resource \"aws_s3_bucket\" \"payment_receipts\" {\n"], [12, "  # LocalStack doesn't require globally unique names\n"], [13, "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-payment-receipts\" : \"${var.project_name}-payment-receipts-${var.environment}-${data.aws_caller_identity.current.account_id}\"\n"], [14, "\n"], [15, "  # \u274c PCI 3.4: Force destroy allows data loss\n"], [16, "  force_destroy = true\n"], [17, "\n"], [18, "  tags = {\n"], [19, "    Name     = \"Payment Receipts\"\n"], [20, "    Contains = \"Payment Data\"  # \u274c Contains PII/PCI data!\n"], [21, "    Public   = \"true\"\n"], [22, "  }\n"], [23, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [11, 23], "resource": "aws_s3_bucket.payment_receipts", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Contains": "Payment Data", "Name": "Payment Receipts", "Public": true}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.payment_receipts", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"audit_logs": {"__end_line__": 81, "__start_line__": 72, "bucket": ["securebank-audit-logs"], "force_destroy": [true], "tags": [{"Contains": "PCI Audit Logs", "Name": "Audit Logs"}], "__address__": "aws_s3_bucket.audit_logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type"]}, "code_block": [[72, "resource \"aws_s3_bucket\" \"audit_logs\" {\n"], [73, "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-audit-logs\" : \"${var.project_name}-audit-logs-${var.environment}-${data.aws_caller_identity.current.account_id}\"\n"], [74, "\n"], [75, "  force_destroy = true\n"], [76, "\n"], [77, "  tags = {\n"], [78, "    Name     = \"Audit Logs\"\n"], [79, "    Contains = \"PCI Audit Logs\"\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [72, 81], "resource": "aws_s3_bucket.audit_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Contains": "PCI Audit Logs", "Name": "Audit Logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.audit_logs", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}]}}], "failed_checks": [{"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[8, "resource \"aws_cloudwatch_log_group\" \"app_logs\" {\n"], [9, "  name              = \"/aws/${var.project_name}/application\"\n"], [10, "  retention_in_days = 1  # \u274c Should be 90+ days\n"], [11, "\n"], [12, "  # \u274c PCI 3.4: No encryption\n"], [13, "  # kms_key_id = aws_kms_key.logs.arn\n"], [14, "\n"], [15, "  tags = {\n"], [16, "    Name = \"SecureBank Application Logs\"\n"], [17, "  }\n"], [18, "}"]], "file_path": "/cloudwatch.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/cloudwatch.tf", "repo_file_path": "/infrastructure/terraform/cloudwatch.tf", "file_line_range": [8, 18], "resource": "aws_cloudwatch_log_group.app_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Name": "SecureBank Application Logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/cloudwatch.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_338", "bc_check_id": "BC_AWS_LOGGING_46", "check_name": "Ensure CloudWatch log groups retains logs for at least 1 year", "check_result": {"result": "FAILED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[8, "resource \"aws_cloudwatch_log_group\" \"app_logs\" {\n"], [9, "  name              = \"/aws/${var.project_name}/application\"\n"], [10, "  retention_in_days = 1  # \u274c Should be 90+ days\n"], [11, "\n"], [12, "  # \u274c PCI 3.4: No encryption\n"], [13, "  # kms_key_id = aws_kms_key.logs.arn\n"], [14, "\n"], [15, "  tags = {\n"], [16, "    Name = \"SecureBank Application Logs\"\n"], [17, "  }\n"], [18, "}"]], "file_path": "/cloudwatch.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/cloudwatch.tf", "repo_file_path": "/infrastructure/terraform/cloudwatch.tf", "file_line_range": [8, 18], "resource": "aws_cloudwatch_log_group.app_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetentionYear", "fixed_definition": null, "entity_tags": {"Name": "SecureBank Application Logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/cloudwatch.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_289", "bc_check_id": "BC_AWS_IAM_84", "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "FAILED", "evaluated_keys": ["policy/Statement/[0]/Action"]}, "code_block": [[95, "resource \"aws_iam_role_policy\" \"app_admin\" {\n"], [96, "  name = \"admin-access\"\n"], [97, "  role = aws_iam_role.app_role.id\n"], [98, "\n"], [99, "  policy = jsonencode({\n"], [100, "    Version = \"2012-10-17\"\n"], [101, "    Statement = [{\n"], [102, "      Effect   = \"Allow\"\n"], [103, "      Action   = \"*\"  # \u274c CRITICAL: Full admin access!\n"], [104, "      Resource = \"*\"\n"], [105, "    }]\n"], [106, "  })\n"], [107, "}"]], "file_path": "/iam.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "repo_file_path": "/infrastructure/terraform/iam.tf", "file_line_range": [95, 107], "resource": "aws_iam_role_policy.app_admin", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-289", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf"}, {"check_id": "CKV_AWS_288", "bc_check_id": "BC_AWS_IAM_83", "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "FAILED", "evaluated_keys": ["policy/Statement/[0]/Action"]}, "code_block": [[95, "resource \"aws_iam_role_policy\" \"app_admin\" {\n"], [96, "  name = \"admin-access\"\n"], [97, "  role = aws_iam_role.app_role.id\n"], [98, "\n"], [99, "  policy = jsonencode({\n"], [100, "    Version = \"2012-10-17\"\n"], [101, "    Statement = [{\n"], [102, "      Effect   = \"Allow\"\n"], [103, "      Action   = \"*\"  # \u274c CRITICAL: Full admin access!\n"], [104, "      Resource = \"*\"\n"], [105, "    }]\n"], [106, "  })\n"], [107, "}"]], "file_path": "/iam.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "repo_file_path": "/infrastructure/terraform/iam.tf", "file_line_range": [95, 107], "resource": "aws_iam_role_policy.app_admin", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-288", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf"}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "FAILED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[95, "resource \"aws_iam_role_policy\" \"app_admin\" {\n"], [96, "  name = \"admin-access\"\n"], [97, "  role = aws_iam_role.app_role.id\n"], [98, "\n"], [99, "  policy = jsonencode({\n"], [100, "    Version = \"2012-10-17\"\n"], [101, "    Statement = [{\n"], [102, "      Effect   = \"Allow\"\n"], [103, "      Action   = \"*\"  # \u274c CRITICAL: Full admin access!\n"], [104, "      Resource = \"*\"\n"], [105, "    }]\n"], [106, "  })\n"], [107, "}"]], "file_path": "/iam.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "repo_file_path": "/infrastructure/terraform/iam.tf", "file_line_range": [95, 107], "resource": "aws_iam_role_policy.app_admin", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf"}, {"check_id": "CKV_AWS_286", "bc_check_id": "BC_AWS_IAM_81", "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "FAILED", "evaluated_keys": ["policy/Statement/[0]/Action"]}, "code_block": [[95, "resource \"aws_iam_role_policy\" \"app_admin\" {\n"], [96, "  name = \"admin-access\"\n"], [97, "  role = aws_iam_role.app_role.id\n"], [98, "\n"], [99, "  policy = jsonencode({\n"], [100, "    Version = \"2012-10-17\"\n"], [101, "    Statement = [{\n"], [102, "      Effect   = \"Allow\"\n"], [103, "      Action   = \"*\"  # \u274c CRITICAL: Full admin access!\n"], [104, "      Resource = \"*\"\n"], [105, "    }]\n"], [106, "  })\n"], [107, "}"]], "file_path": "/iam.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "repo_file_path": "/infrastructure/terraform/iam.tf", "file_line_range": [95, 107], "resource": "aws_iam_role_policy.app_admin", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-286", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf"}, {"check_id": "CKV_AWS_290", "bc_check_id": "BC_AWS_IAM_85", "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "FAILED", "evaluated_keys": ["policy/Statement/[0]/Action"]}, "code_block": [[95, "resource \"aws_iam_role_policy\" \"app_admin\" {\n"], [96, "  name = \"admin-access\"\n"], [97, "  role = aws_iam_role.app_role.id\n"], [98, "\n"], [99, "  policy = jsonencode({\n"], [100, "    Version = \"2012-10-17\"\n"], [101, "    Statement = [{\n"], [102, "      Effect   = \"Allow\"\n"], [103, "      Action   = \"*\"  # \u274c CRITICAL: Full admin access!\n"], [104, "      Resource = \"*\"\n"], [105, "    }]\n"], [106, "  })\n"], [107, "}"]], "file_path": "/iam.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "repo_file_path": "/infrastructure/terraform/iam.tf", "file_line_range": [95, 107], "resource": "aws_iam_role_policy.app_admin", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-290", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf"}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "FAILED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[95, "resource \"aws_iam_role_policy\" \"app_admin\" {\n"], [96, "  name = \"admin-access\"\n"], [97, "  role = aws_iam_role.app_role.id\n"], [98, "\n"], [99, "  policy = jsonencode({\n"], [100, "    Version = \"2012-10-17\"\n"], [101, "    Statement = [{\n"], [102, "      Effect   = \"Allow\"\n"], [103, "      Action   = \"*\"  # \u274c CRITICAL: Full admin access!\n"], [104, "      Resource = \"*\"\n"], [105, "    }]\n"], [106, "  })\n"], [107, "}"]], "file_path": "/iam.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "repo_file_path": "/infrastructure/terraform/iam.tf", "file_line_range": [95, 107], "resource": "aws_iam_role_policy.app_admin", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf"}, {"check_id": "CKV_AWS_287", "bc_check_id": "BC_AWS_IAM_82", "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "FAILED", "evaluated_keys": ["policy/Statement/[0]/Action"]}, "code_block": [[95, "resource \"aws_iam_role_policy\" \"app_admin\" {\n"], [96, "  name = \"admin-access\"\n"], [97, "  role = aws_iam_role.app_role.id\n"], [98, "\n"], [99, "  policy = jsonencode({\n"], [100, "    Version = \"2012-10-17\"\n"], [101, "    Statement = [{\n"], [102, "      Effect   = \"Allow\"\n"], [103, "      Action   = \"*\"  # \u274c CRITICAL: Full admin access!\n"], [104, "      Resource = \"*\"\n"], [105, "    }]\n"], [106, "  })\n"], [107, "}"]], "file_path": "/iam.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "repo_file_path": "/infrastructure/terraform/iam.tf", "file_line_range": [95, 107], "resource": "aws_iam_role_policy.app_admin", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-287", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf"}, {"check_id": "CKV_AWS_355", "bc_check_id": "BC_AWS_IAM_88", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "check_result": {"result": "FAILED", "evaluated_keys": ["policy/Statement/[0]/Action"]}, "code_block": [[95, "resource \"aws_iam_role_policy\" \"app_admin\" {\n"], [96, "  name = \"admin-access\"\n"], [97, "  role = aws_iam_role.app_role.id\n"], [98, "\n"], [99, "  policy = jsonencode({\n"], [100, "    Version = \"2012-10-17\"\n"], [101, "    Statement = [{\n"], [102, "      Effect   = \"Allow\"\n"], [103, "      Action   = \"*\"  # \u274c CRITICAL: Full admin access!\n"], [104, "      Resource = \"*\"\n"], [105, "    }]\n"], [106, "  })\n"], [107, "}"]], "file_path": "/iam.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "repo_file_path": "/infrastructure/terraform/iam.tf", "file_line_range": [95, 107], "resource": "aws_iam_role_policy.app_admin", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarResourcePolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-355", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf"}, {"check_id": "CKV_AWS_55", "bc_check_id": "BC_AWS_S3_21", "check_name": "Ensure S3 bucket has ignore public ACLs enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["ignore_public_acls"]}, "code_block": [[29, "resource \"aws_s3_bucket_public_access_block\" \"payment_receipts\" {\n"], [30, "  bucket = aws_s3_bucket.payment_receipts.id\n"], [31, "\n"], [32, "  block_public_acls       = false  # \u274c CRITICAL!\n"], [33, "  block_public_policy     = false  # \u274c CRITICAL!\n"], [34, "  ignore_public_acls      = false\n"], [35, "  restrict_public_buckets = false\n"], [36, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [29, 36], "resource": "aws_s3_bucket_public_access_block.payment_receipts", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3IgnorePublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-21", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf"}, {"check_id": "CKV_AWS_53", "bc_check_id": "BC_AWS_S3_19", "check_name": "Ensure S3 bucket has block public ACLS enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["block_public_acls"]}, "code_block": [[29, "resource \"aws_s3_bucket_public_access_block\" \"payment_receipts\" {\n"], [30, "  bucket = aws_s3_bucket.payment_receipts.id\n"], [31, "\n"], [32, "  block_public_acls       = false  # \u274c CRITICAL!\n"], [33, "  block_public_policy     = false  # \u274c CRITICAL!\n"], [34, "  ignore_public_acls      = false\n"], [35, "  restrict_public_buckets = false\n"], [36, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [29, 36], "resource": "aws_s3_bucket_public_access_block.payment_receipts", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-19", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf"}, {"check_id": "CKV_AWS_54", "bc_check_id": "BC_AWS_S3_20", "check_name": "Ensure S3 bucket has block public policy enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["block_public_policy"]}, "code_block": [[29, "resource \"aws_s3_bucket_public_access_block\" \"payment_receipts\" {\n"], [30, "  bucket = aws_s3_bucket.payment_receipts.id\n"], [31, "\n"], [32, "  block_public_acls       = false  # \u274c CRITICAL!\n"], [33, "  block_public_policy     = false  # \u274c CRITICAL!\n"], [34, "  ignore_public_acls      = false\n"], [35, "  restrict_public_buckets = false\n"], [36, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [29, 36], "resource": "aws_s3_bucket_public_access_block.payment_receipts", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-20", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf"}, {"check_id": "CKV_AWS_56", "bc_check_id": "BC_AWS_S3_22", "check_name": "Ensure S3 bucket has 'restrict_public_buckets' enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["restrict_public_buckets"]}, "code_block": [[29, "resource \"aws_s3_bucket_public_access_block\" \"payment_receipts\" {\n"], [30, "  bucket = aws_s3_bucket.payment_receipts.id\n"], [31, "\n"], [32, "  block_public_acls       = false  # \u274c CRITICAL!\n"], [33, "  block_public_policy     = false  # \u274c CRITICAL!\n"], [34, "  ignore_public_acls      = false\n"], [35, "  restrict_public_buckets = false\n"], [36, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [29, 36], "resource": "aws_s3_bucket_public_access_block.payment_receipts", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3RestrictPublicBuckets", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-22", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf"}, {"check_id": "CKV_AWS_70", "bc_check_id": "BC_AWS_S3_23", "check_name": "Ensure S3 bucket does not allow an action with any Principal", "check_result": {"result": "FAILED", "evaluated_keys": ["policy"]}, "code_block": [[38, "resource \"aws_s3_bucket_policy\" \"payment_receipts_public\" {\n"], [39, "  bucket = aws_s3_bucket.payment_receipts.id\n"], [40, "\n"], [41, "  # \u274c PCI 7.1: Public read access to payment data\n"], [42, "  policy = jsonencode({\n"], [43, "    Version = \"2012-10-17\"\n"], [44, "    Statement = [\n"], [45, "      {\n"], [46, "        Sid       = \"PublicReadGetObject\"\n"], [47, "        Effect    = \"Allow\"\n"], [48, "        Principal = \"*\"  # \u274c CRITICAL: Anyone can read!\n"], [49, "        Action    = \"s3:GetObject\"\n"], [50, "        Resource  = \"${aws_s3_bucket.payment_receipts.arn}/*\"\n"], [51, "      }\n"], [52, "    ]\n"], [53, "  })\n"], [54, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [38, 54], "resource": "aws_s3_bucket_policy.payment_receipts_public", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3AllowsAnyPrincipal", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-23", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf"}, {"check_id": "CKV_AWS_55", "bc_check_id": "BC_AWS_S3_21", "check_name": "Ensure S3 bucket has ignore public ACLs enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["ignore_public_acls"]}, "code_block": [[84, "resource \"aws_s3_bucket_public_access_block\" \"audit_logs\" {\n"], [85, "  bucket = aws_s3_bucket.audit_logs.id\n"], [86, "\n"], [87, "  block_public_acls       = false\n"], [88, "  block_public_policy     = false\n"], [89, "  ignore_public_acls      = false\n"], [90, "  restrict_public_buckets = false\n"], [91, "}"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [84, 91], "resource": "aws_s3_bucket_public_access_block.audit_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3IgnorePublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-21", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf"}, {"check_id": "CKV_AWS_53", "bc_check_id": "BC_AWS_S3_19", "check_name": "Ensure S3 bucket has block public ACLS enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["block_public_acls"]}, "code_block": [[84, "resource \"aws_s3_bucket_public_access_block\" \"audit_logs\" {\n"], [85, "  bucket = aws_s3_bucket.audit_logs.id\n"], [86, "\n"], [87, "  block_public_acls       = false\n"], [88, "  block_public_policy     = false\n"], [89, "  ignore_public_acls      = false\n"], [90, "  restrict_public_buckets = false\n"], [91, "}"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [84, 91], "resource": "aws_s3_bucket_public_access_block.audit_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-19", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf"}, {"check_id": "CKV_AWS_54", "bc_check_id": "BC_AWS_S3_20", "check_name": "Ensure S3 bucket has block public policy enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["block_public_policy"]}, "code_block": [[84, "resource \"aws_s3_bucket_public_access_block\" \"audit_logs\" {\n"], [85, "  bucket = aws_s3_bucket.audit_logs.id\n"], [86, "\n"], [87, "  block_public_acls       = false\n"], [88, "  block_public_policy     = false\n"], [89, "  ignore_public_acls      = false\n"], [90, "  restrict_public_buckets = false\n"], [91, "}"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [84, 91], "resource": "aws_s3_bucket_public_access_block.audit_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-20", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf"}, {"check_id": "CKV_AWS_56", "bc_check_id": "BC_AWS_S3_22", "check_name": "Ensure S3 bucket has 'restrict_public_buckets' enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["restrict_public_buckets"]}, "code_block": [[84, "resource \"aws_s3_bucket_public_access_block\" \"audit_logs\" {\n"], [85, "  bucket = aws_s3_bucket.audit_logs.id\n"], [86, "\n"], [87, "  block_public_acls       = false\n"], [88, "  block_public_policy     = false\n"], [89, "  ignore_public_acls      = false\n"], [90, "  restrict_public_buckets = false\n"], [91, "}"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [84, 91], "resource": "aws_s3_bucket_public_access_block.audit_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3RestrictPublicBuckets", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-22", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf"}, {"check_id": "CKV_AWS_149", "bc_check_id": "BC_AWS_GENERAL_79", "check_name": "Ensure that Secrets Manager secret is encrypted using KMS CMK", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[9, "resource \"aws_secretsmanager_secret\" \"db_password\" {\n"], [10, "  name                    = \"${var.project_name}/db/password\"\n"], [11, "  description             = \"Database password for SecureBank\"\n"], [12, "  recovery_window_in_days = 0  # \u274c Immediate deletion, no recovery!\n"], [13, "\n"], [14, "  # \u274c PCI 8.2.4: No automatic rotation\n"], [15, "  # rotation_rules {\n"], [16, "  #   automatically_after_days = 90\n"], [17, "  # }\n"], [18, "\n"], [19, "  tags = {\n"], [20, "    Name = \"Database Password\"\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/secrets-manager.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf", "repo_file_path": "/infrastructure/terraform/secrets-manager.tf", "file_line_range": [9, 22], "resource": "aws_secretsmanager_secret.db_password", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecretManagerSecretEncrypted", "fixed_definition": null, "entity_tags": {"Name": "Database Password"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-secrets-manager-secret-is-encrypted-using-kms", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_149", "bc_check_id": "BC_AWS_GENERAL_79", "check_name": "Ensure that Secrets Manager secret is encrypted using KMS CMK", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[39, "resource \"aws_secretsmanager_secret\" \"jwt_secret\" {\n"], [40, "  name                    = \"${var.project_name}/jwt/secret\"\n"], [41, "  recovery_window_in_days = 0\n"], [42, "\n"], [43, "  tags = {\n"], [44, "    Name = \"JWT Secret\"\n"], [45, "  }\n"], [46, "}\n"]], "file_path": "/secrets-manager.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf", "repo_file_path": "/infrastructure/terraform/secrets-manager.tf", "file_line_range": [39, 46], "resource": "aws_secretsmanager_secret.jwt_secret", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecretManagerSecretEncrypted", "fixed_definition": null, "entity_tags": {"Name": "JWT Secret"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-secrets-manager-secret-is-encrypted-using-kms", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "FAILED", "evaluated_keys": ["egress/[0]/from_port", "egress/[0]/to_port", "egress/[0]/cidr_blocks", "egress/[0]/ipv6_cidr_blocks"]}, "code_block": [[8, "resource \"aws_security_group\" \"allow_all\" {\n"], [9, "  name        = \"${var.project_name}-allow-all\"\n"], [10, "  description = \"Allow all inbound traffic\"  # \u274c CRITICAL!\n"], [11, "  vpc_id      = aws_vpc.main.id\n"], [12, "\n"], [13, "  # \u274c PCI 1.3.1: Allows 0.0.0.0/0 to database\n"], [14, "  ingress {\n"], [15, "    description = \"Allow all inbound\"\n"], [16, "    from_port   = 0\n"], [17, "    to_port     = 65535\n"], [18, "    protocol    = \"tcp\"\n"], [19, "    cidr_blocks = [\"0.0.0.0/0\"]  # \u274c CRITICAL: Open to internet!\n"], [20, "  }\n"], [21, "\n"], [22, "  egress {\n"], [23, "    description = \"Allow all outbound\"\n"], [24, "    from_port   = 0\n"], [25, "    to_port     = 0\n"], [26, "    protocol    = \"-1\"\n"], [27, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [28, "  }\n"], [29, "\n"], [30, "  tags = {\n"], [31, "    Name = \"${var.project_name}-allow-all\"\n"], [32, "  }\n"], [33, "}"]], "file_path": "/security-groups.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf", "repo_file_path": "/infrastructure/terraform/security-groups.tf", "file_line_range": [8, 33], "resource": "aws_security_group.allow_all", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": {"Name": "securebank-allow-all"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "FAILED", "evaluated_keys": ["ingress/[0]/from_port", "ingress/[0]/to_port", "ingress/[0]/cidr_blocks", "ingress/[0]/ipv6_cidr_blocks"]}, "code_block": [[8, "resource \"aws_security_group\" \"allow_all\" {\n"], [9, "  name        = \"${var.project_name}-allow-all\"\n"], [10, "  description = \"Allow all inbound traffic\"  # \u274c CRITICAL!\n"], [11, "  vpc_id      = aws_vpc.main.id\n"], [12, "\n"], [13, "  # \u274c PCI 1.3.1: Allows 0.0.0.0/0 to database\n"], [14, "  ingress {\n"], [15, "    description = \"Allow all inbound\"\n"], [16, "    from_port   = 0\n"], [17, "    to_port     = 65535\n"], [18, "    protocol    = \"tcp\"\n"], [19, "    cidr_blocks = [\"0.0.0.0/0\"]  # \u274c CRITICAL: Open to internet!\n"], [20, "  }\n"], [21, "\n"], [22, "  egress {\n"], [23, "    description = \"Allow all outbound\"\n"], [24, "    from_port   = 0\n"], [25, "    to_port     = 0\n"], [26, "    protocol    = \"-1\"\n"], [27, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [28, "  }\n"], [29, "\n"], [30, "  tags = {\n"], [31, "    Name = \"${var.project_name}-allow-all\"\n"], [32, "  }\n"], [33, "}"]], "file_path": "/security-groups.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf", "repo_file_path": "/infrastructure/terraform/security-groups.tf", "file_line_range": [8, 33], "resource": "aws_security_group.allow_all", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Name": "securebank-allow-all"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "FAILED", "evaluated_keys": ["ingress/[0]/from_port", "ingress/[0]/to_port", "ingress/[0]/cidr_blocks", "ingress/[0]/ipv6_cidr_blocks"]}, "code_block": [[8, "resource \"aws_security_group\" \"allow_all\" {\n"], [9, "  name        = \"${var.project_name}-allow-all\"\n"], [10, "  description = \"Allow all inbound traffic\"  # \u274c CRITICAL!\n"], [11, "  vpc_id      = aws_vpc.main.id\n"], [12, "\n"], [13, "  # \u274c PCI 1.3.1: Allows 0.0.0.0/0 to database\n"], [14, "  ingress {\n"], [15, "    description = \"Allow all inbound\"\n"], [16, "    from_port   = 0\n"], [17, "    to_port     = 65535\n"], [18, "    protocol    = \"tcp\"\n"], [19, "    cidr_blocks = [\"0.0.0.0/0\"]  # \u274c CRITICAL: Open to internet!\n"], [20, "  }\n"], [21, "\n"], [22, "  egress {\n"], [23, "    description = \"Allow all outbound\"\n"], [24, "    from_port   = 0\n"], [25, "    to_port     = 0\n"], [26, "    protocol    = \"-1\"\n"], [27, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [28, "  }\n"], [29, "\n"], [30, "  tags = {\n"], [31, "    Name = \"${var.project_name}-allow-all\"\n"], [32, "  }\n"], [33, "}"]], "file_path": "/security-groups.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf", "repo_file_path": "/infrastructure/terraform/security-groups.tf", "file_line_range": [8, 33], "resource": "aws_security_group.allow_all", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": {"Name": "securebank-allow-all"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_24", "bc_check_id": "BC_AWS_NETWORKING_1", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "check_result": {"result": "FAILED", "evaluated_keys": ["ingress/[0]/from_port", "ingress/[0]/to_port", "ingress/[0]/cidr_blocks", "ingress/[0]/ipv6_cidr_blocks"]}, "code_block": [[8, "resource \"aws_security_group\" \"allow_all\" {\n"], [9, "  name        = \"${var.project_name}-allow-all\"\n"], [10, "  description = \"Allow all inbound traffic\"  # \u274c CRITICAL!\n"], [11, "  vpc_id      = aws_vpc.main.id\n"], [12, "\n"], [13, "  # \u274c PCI 1.3.1: Allows 0.0.0.0/0 to database\n"], [14, "  ingress {\n"], [15, "    description = \"Allow all inbound\"\n"], [16, "    from_port   = 0\n"], [17, "    to_port     = 65535\n"], [18, "    protocol    = \"tcp\"\n"], [19, "    cidr_blocks = [\"0.0.0.0/0\"]  # \u274c CRITICAL: Open to internet!\n"], [20, "  }\n"], [21, "\n"], [22, "  egress {\n"], [23, "    description = \"Allow all outbound\"\n"], [24, "    from_port   = 0\n"], [25, "    to_port     = 0\n"], [26, "    protocol    = \"-1\"\n"], [27, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [28, "  }\n"], [29, "\n"], [30, "  tags = {\n"], [31, "    Name = \"${var.project_name}-allow-all\"\n"], [32, "  }\n"], [33, "}"]], "file_path": "/security-groups.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf", "repo_file_path": "/infrastructure/terraform/security-groups.tf", "file_line_range": [8, 33], "resource": "aws_security_group.allow_all", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress22", "fixed_definition": null, "entity_tags": {"Name": "securebank-allow-all"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/security-groups.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "FAILED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[19, "resource \"aws_subnet\" \"public_1\" {\n"], [20, "  vpc_id                  = aws_vpc.main.id\n"], [21, "  cidr_block              = \"10.0.1.0/24\"\n"], [22, "  availability_zone       = \"${var.aws_region}a\"\n"], [23, "  map_public_ip_on_launch = true  # \u274c Auto-assigns public IPs!\n"], [24, "\n"], [25, "  tags = {\n"], [26, "    Name = \"${var.project_name}-public-1\"\n"], [27, "  }\n"], [28, "}\n"]], "file_path": "/vpc.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf", "repo_file_path": "/infrastructure/terraform/vpc.tf", "file_line_range": [19, 28], "resource": "aws_subnet.public_1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "securebank-public-1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf", "breadcrumbs": {"availability_zone": [{"type": "variable", "name": "aws_region", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "FAILED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[30, "resource \"aws_subnet\" \"public_2\" {\n"], [31, "  vpc_id                  = aws_vpc.main.id\n"], [32, "  cidr_block              = \"10.0.2.0/24\"\n"], [33, "  availability_zone       = \"${var.aws_region}b\"\n"], [34, "  map_public_ip_on_launch = true\n"], [35, "\n"], [36, "  tags = {\n"], [37, "    Name = \"${var.project_name}-public-2\"\n"], [38, "  }\n"], [39, "}\n"]], "file_path": "/vpc.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf", "repo_file_path": "/infrastructure/terraform/vpc.tf", "file_line_range": [30, 39], "resource": "aws_subnet.public_2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "securebank-public-2"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf", "breadcrumbs": {"availability_zone": [{"type": "variable", "name": "aws_region", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"payment_receipts": {"__end_line__": 23, "__start_line__": 11, "bucket": ["securebank-payment-receipts"], "force_destroy": [true], "tags": [{"Contains": "Payment Data", "Name": "Payment Receipts", "Public": true}], "__address__": "aws_s3_bucket.payment_receipts"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type"]}, "code_block": [[11, "resource \"aws_s3_bucket\" \"payment_receipts\" {\n"], [12, "  # LocalStack doesn't require globally unique names\n"], [13, "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-payment-receipts\" : \"${var.project_name}-payment-receipts-${var.environment}-${data.aws_caller_identity.current.account_id}\"\n"], [14, "\n"], [15, "  # \u274c PCI 3.4: Force destroy allows data loss\n"], [16, "  force_destroy = true\n"], [17, "\n"], [18, "  tags = {\n"], [19, "    Name     = \"Payment Receipts\"\n"], [20, "    Contains = \"Payment Data\"  # \u274c Contains PII/PCI data!\n"], [21, "    Public   = \"true\"\n"], [22, "  }\n"], [23, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [11, 23], "resource": "aws_s3_bucket.payment_receipts", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Contains": "Payment Data", "Name": "Payment Receipts", "Public": true}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.payment_receipts", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"audit_logs": {"__end_line__": 81, "__start_line__": 72, "bucket": ["securebank-audit-logs"], "force_destroy": [true], "tags": [{"Contains": "PCI Audit Logs", "Name": "Audit Logs"}], "__address__": "aws_s3_bucket.audit_logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type"]}, "code_block": [[72, "resource \"aws_s3_bucket\" \"audit_logs\" {\n"], [73, "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-audit-logs\" : \"${var.project_name}-audit-logs-${var.environment}-${data.aws_caller_identity.current.account_id}\"\n"], [74, "\n"], [75, "  force_destroy = true\n"], [76, "\n"], [77, "  tags = {\n"], [78, "    Name     = \"Audit Logs\"\n"], [79, "    Contains = \"PCI Audit Logs\"\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [72, 81], "resource": "aws_s3_bucket.audit_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Contains": "PCI Audit Logs", "Name": "Audit Logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.audit_logs", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_30", "bc_check_id": "BC_AWS_LOGGING_32", "check_name": "Ensure Postgres RDS as aws_db_instance has Query Logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_db_instance": {"payment_db": {"__end_line__": 69, "__start_line__": 23, "allocated_storage": [20], "auto_minor_version_upgrade": [false], "backup_retention_period": [1], "count": [0], "db_name": ["securebank"], "db_subnet_group_name": ["aws_db_subnet_group.main[0].name"], "deletion_protection": [false], "enabled_cloudwatch_logs_exports": [[]], "engine": ["postgres"], "engine_version": ["14.10"], "identifier": ["securebank-payment-db"], "instance_class": ["db.t3.micro"], "max_allocated_storage": [100], "password": ["supersecret"], "publicly_accessible": [true], "skip_final_snapshot": [true], "storage_encrypted": [false], "storage_type": ["gp3"], "tags": [{"Compliance": "PCI-DSS", "Contains": "CVV-PIN-PAN", "Encryption": "NONE", "Name": "securebank-payment-db"}], "username": ["admin"], "vpc_security_group_ids": [["aws_security_group.allow_all.id"]], "__address__": "aws_db_instance.payment_db"}}}, "evaluated_keys": ["engine", "parameter/*/name", "resource_type"]}, "code_block": [[23, "resource \"aws_db_instance\" \"payment_db\" {\n"], [24, "  # LocalStack has limited RDS support\n"], [25, "  count = var.deployment_target == \"aws\" ? 1 : 0\n"], [26, "\n"], [27, "  identifier     = \"${var.project_name}-payment-db\"\n"], [28, "  engine         = \"postgres\"\n"], [29, "  engine_version = \"14.10\"\n"], [30, "  instance_class = \"db.t3.micro\"\n"], [31, "\n"], [32, "  allocated_storage     = 20\n"], [33, "  max_allocated_storage = 100\n"], [34, "  storage_type          = \"gp3\"\n"], [35, "\n"], [36, "  # \u274c PCI 3.4: No storage encryption\n"], [37, "  storage_encrypted = false  # \u274c CRITICAL!\n"], [38, "  # kms_key_id = aws_kms_key.rds.arn\n"], [39, "\n"], [40, "  db_name  = var.project_name\n"], [41, "  username = var.db_username  # \u274c \"admin\"\n"], [42, "  password = var.db_password  # \u274c \"supersecret\"\n"], [43, "\n"], [44, "  # \u274c PCI 2.3: Publicly accessible database!\n"], [45, "  publicly_accessible = true  # \u274c CRITICAL!\n"], [46, "\n"], [47, "  vpc_security_group_ids = [aws_security_group.allow_all.id]\n"], [48, "  db_subnet_group_name   = aws_db_subnet_group.main[0].name\n"], [49, "\n"], [50, "  # \u274c PCI 10.7: Backup retention too short\n"], [51, "  backup_retention_period = 1  # \u274c Should be 90+ days\n"], [52, "\n"], [53, "  # \u274c PCI 2.4: No automated patching\n"], [54, "  auto_minor_version_upgrade = false\n"], [55, "\n"], [56, "  # \u274c PCI 10.1: No enhanced monitoring\n"], [57, "  enabled_cloudwatch_logs_exports = []  # \u274c Should log all queries\n"], [58, "\n"], [59, "  # \u274c Deletion protection disabled\n"], [60, "  deletion_protection = false\n"], [61, "  skip_final_snapshot = true\n"], [62, "\n"], [63, "  tags = {\n"], [64, "    Name        = \"${var.project_name}-payment-db\"\n"], [65, "    Contains    = \"CVV-PIN-PAN\"  # \u274c Advertising sensitive data!\n"], [66, "    Compliance  = \"PCI-DSS\"\n"], [67, "    Encryption  = \"NONE\"  # \u274c Red flag!\n"], [68, "  }\n"], [69, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/rds.tf", "repo_file_path": "/infrastructure/terraform/rds.tf", "file_line_range": [23, 69], "resource": "aws_db_instance.payment_db", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Compliance": "PCI-DSS", "Contains": "CVV-PIN-PAN", "Encryption": "NONE", "Name": "securebank-payment-db"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-postgres-rds-has-query-logging-enabled", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/rds.tf", "breadcrumbs": {"count": [{"type": "variable", "name": "deployment_target", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "username": [{"type": "variable", "name": "db_username", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "password": [{"type": "variable", "name": "db_password", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "db_name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "identifier": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_62", "bc_check_id": "BC_AWS_LOGGING_36", "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"payment_receipts": {"__end_line__": 23, "__start_line__": 11, "bucket": ["securebank-payment-receipts"], "force_destroy": [true], "tags": [{"Contains": "Payment Data", "Name": "Payment Receipts", "Public": true}], "__address__": "aws_s3_bucket.payment_receipts"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[11, "resource \"aws_s3_bucket\" \"payment_receipts\" {\n"], [12, "  # LocalStack doesn't require globally unique names\n"], [13, "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-payment-receipts\" : \"${var.project_name}-payment-receipts-${var.environment}-${data.aws_caller_identity.current.account_id}\"\n"], [14, "\n"], [15, "  # \u274c PCI 3.4: Force destroy allows data loss\n"], [16, "  force_destroy = true\n"], [17, "\n"], [18, "  tags = {\n"], [19, "    Name     = \"Payment Receipts\"\n"], [20, "    Contains = \"Payment Data\"  # \u274c Contains PII/PCI data!\n"], [21, "    Public   = \"true\"\n"], [22, "  }\n"], [23, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [11, 23], "resource": "aws_s3_bucket.payment_receipts", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Contains": "Payment Data", "Name": "Payment Receipts", "Public": true}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.payment_receipts", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_62", "bc_check_id": "BC_AWS_LOGGING_36", "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"audit_logs": {"__end_line__": 81, "__start_line__": 72, "bucket": ["securebank-audit-logs"], "force_destroy": [true], "tags": [{"Contains": "PCI Audit Logs", "Name": "Audit Logs"}], "__address__": "aws_s3_bucket.audit_logs"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[72, "resource \"aws_s3_bucket\" \"audit_logs\" {\n"], [73, "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-audit-logs\" : \"${var.project_name}-audit-logs-${var.environment}-${data.aws_caller_identity.current.account_id}\"\n"], [74, "\n"], [75, "  force_destroy = true\n"], [76, "\n"], [77, "  tags = {\n"], [78, "    Name     = \"Audit Logs\"\n"], [79, "    Contains = \"PCI Audit Logs\"\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [72, 81], "resource": "aws_s3_bucket.audit_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Contains": "PCI Audit Logs", "Name": "Audit Logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.audit_logs", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_57", "bc_check_id": "BC_AWS_GENERAL_192", "check_name": "Ensure Secrets Manager secrets should have automatic rotation enabled", "check_result": {"result": "FAILED", "entity": {"aws_secretsmanager_secret": {"db_password": {"__end_line__": 22, "__start_line__": 9, "description": ["Database password for SecureBank"], "name": ["securebank/db/password"], "recovery_window_in_days": [0], "tags": [{"Name": "Database Password"}], "__address__": "aws_secretsmanager_secret.db_password"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[9, "resource \"aws_secretsmanager_secret\" \"db_password\" {\n"], [10, "  name                    = \"${var.project_name}/db/password\"\n"], [11, "  description             = \"Database password for SecureBank\"\n"], [12, "  recovery_window_in_days = 0  # \u274c Immediate deletion, no recovery!\n"], [13, "\n"], [14, "  # \u274c PCI 8.2.4: No automatic rotation\n"], [15, "  # rotation_rules {\n"], [16, "  #   automatically_after_days = 90\n"], [17, "  # }\n"], [18, "\n"], [19, "  tags = {\n"], [20, "    Name = \"Database Password\"\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/secrets-manager.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf", "repo_file_path": "/infrastructure/terraform/secrets-manager.tf", "file_line_range": [9, 22], "resource": "aws_secretsmanager_secret.db_password", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "Database Password"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-57", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_57", "bc_check_id": "BC_AWS_GENERAL_192", "check_name": "Ensure Secrets Manager secrets should have automatic rotation enabled", "check_result": {"result": "FAILED", "entity": {"aws_secretsmanager_secret": {"jwt_secret": {"__end_line__": 46, "__start_line__": 39, "name": ["securebank/jwt/secret"], "recovery_window_in_days": [0], "tags": [{"Name": "JWT Secret"}], "__address__": "aws_secretsmanager_secret.jwt_secret"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[39, "resource \"aws_secretsmanager_secret\" \"jwt_secret\" {\n"], [40, "  name                    = \"${var.project_name}/jwt/secret\"\n"], [41, "  recovery_window_in_days = 0\n"], [42, "\n"], [43, "  tags = {\n"], [44, "    Name = \"JWT Secret\"\n"], [45, "  }\n"], [46, "}\n"]], "file_path": "/secrets-manager.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf", "repo_file_path": "/infrastructure/terraform/secrets-manager.tf", "file_line_range": [39, 46], "resource": "aws_secretsmanager_secret.jwt_secret", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "JWT Secret"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-57", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/secrets-manager.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_12", "bc_check_id": "BC_AWS_NETWORKING_4", "check_name": "Ensure the default security group of every VPC restricts all traffic", "check_result": {"result": "FAILED", "entity": {"aws_vpc": {"main": {"__end_line__": 16, "__start_line__": 8, "cidr_block": ["10.0.0.0/16"], "enable_dns_hostnames": [true], "enable_dns_support": [true], "tags": [{"Name": "securebank-vpc"}], "__address__": "aws_vpc.main"}}}, "evaluated_keys": ["egress/to_port", "resource_type", "ingress/to_port", "ingress/self", "egress/from_port", "ingress/from_port", "egress/protocol", "ingress/protocol", "egress/cidr_blocks"]}, "code_block": [[8, "resource \"aws_vpc\" \"main\" {\n"], [9, "  cidr_block           = \"10.0.0.0/16\"\n"], [10, "  enable_dns_hostnames = true\n"], [11, "  enable_dns_support   = true\n"], [12, "\n"], [13, "  tags = {\n"], [14, "    Name = \"${var.project_name}-vpc\"\n"], [15, "  }\n"], [16, "}\n"]], "file_path": "/vpc.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf", "repo_file_path": "/infrastructure/terraform/vpc.tf", "file_line_range": [8, 16], "resource": "aws_vpc.main", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "securebank-vpc"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-4", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf", "breadcrumbs": {"tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_60", "bc_check_id": "BC_AWS_GENERAL_195", "check_name": "Ensure RDS instance with copy tags to snapshots is enabled", "check_result": {"result": "FAILED", "entity": {"aws_db_instance": {"payment_db": {"__end_line__": 69, "__start_line__": 23, "allocated_storage": [20], "auto_minor_version_upgrade": [false], "backup_retention_period": [1], "count": [0], "db_name": ["securebank"], "db_subnet_group_name": ["aws_db_subnet_group.main[0].name"], "deletion_protection": [false], "enabled_cloudwatch_logs_exports": [[]], "engine": ["postgres"], "engine_version": ["14.10"], "identifier": ["securebank-payment-db"], "instance_class": ["db.t3.micro"], "max_allocated_storage": [100], "password": ["supersecret"], "publicly_accessible": [true], "skip_final_snapshot": [true], "storage_encrypted": [false], "storage_type": ["gp3"], "tags": [{"Compliance": "PCI-DSS", "Contains": "CVV-PIN-PAN", "Encryption": "NONE", "Name": "securebank-payment-db"}], "username": ["admin"], "vpc_security_group_ids": [["aws_security_group.allow_all.id"]], "__address__": "aws_db_instance.payment_db"}}}, "evaluated_keys": ["engine", "copy_tags_to_snapshot"]}, "code_block": [[23, "resource \"aws_db_instance\" \"payment_db\" {\n"], [24, "  # LocalStack has limited RDS support\n"], [25, "  count = var.deployment_target == \"aws\" ? 1 : 0\n"], [26, "\n"], [27, "  identifier     = \"${var.project_name}-payment-db\"\n"], [28, "  engine         = \"postgres\"\n"], [29, "  engine_version = \"14.10\"\n"], [30, "  instance_class = \"db.t3.micro\"\n"], [31, "\n"], [32, "  allocated_storage     = 20\n"], [33, "  max_allocated_storage = 100\n"], [34, "  storage_type          = \"gp3\"\n"], [35, "\n"], [36, "  # \u274c PCI 3.4: No storage encryption\n"], [37, "  storage_encrypted = false  # \u274c CRITICAL!\n"], [38, "  # kms_key_id = aws_kms_key.rds.arn\n"], [39, "\n"], [40, "  db_name  = var.project_name\n"], [41, "  username = var.db_username  # \u274c \"admin\"\n"], [42, "  password = var.db_password  # \u274c \"supersecret\"\n"], [43, "\n"], [44, "  # \u274c PCI 2.3: Publicly accessible database!\n"], [45, "  publicly_accessible = true  # \u274c CRITICAL!\n"], [46, "\n"], [47, "  vpc_security_group_ids = [aws_security_group.allow_all.id]\n"], [48, "  db_subnet_group_name   = aws_db_subnet_group.main[0].name\n"], [49, "\n"], [50, "  # \u274c PCI 10.7: Backup retention too short\n"], [51, "  backup_retention_period = 1  # \u274c Should be 90+ days\n"], [52, "\n"], [53, "  # \u274c PCI 2.4: No automated patching\n"], [54, "  auto_minor_version_upgrade = false\n"], [55, "\n"], [56, "  # \u274c PCI 10.1: No enhanced monitoring\n"], [57, "  enabled_cloudwatch_logs_exports = []  # \u274c Should log all queries\n"], [58, "\n"], [59, "  # \u274c Deletion protection disabled\n"], [60, "  deletion_protection = false\n"], [61, "  skip_final_snapshot = true\n"], [62, "\n"], [63, "  tags = {\n"], [64, "    Name        = \"${var.project_name}-payment-db\"\n"], [65, "    Contains    = \"CVV-PIN-PAN\"  # \u274c Advertising sensitive data!\n"], [66, "    Compliance  = \"PCI-DSS\"\n"], [67, "    Encryption  = \"NONE\"  # \u274c Red flag!\n"], [68, "  }\n"], [69, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/rds.tf", "repo_file_path": "/infrastructure/terraform/rds.tf", "file_line_range": [23, 69], "resource": "aws_db_instance.payment_db", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Compliance": "PCI-DSS", "Contains": "CVV-PIN-PAN", "Encryption": "NONE", "Name": "securebank-payment-db"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-60", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/rds.tf", "breadcrumbs": {"count": [{"type": "variable", "name": "deployment_target", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "username": [{"type": "variable", "name": "db_username", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "password": [{"type": "variable", "name": "db_password", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "db_name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "identifier": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"payment_receipts": {"__end_line__": 23, "__start_line__": 11, "bucket": ["securebank-payment-receipts"], "force_destroy": [true], "tags": [{"Contains": "Payment Data", "Name": "Payment Receipts", "Public": true}], "__address__": "aws_s3_bucket.payment_receipts"}}}, "evaluated_keys": ["logging", "resource_type"]}, "code_block": [[11, "resource \"aws_s3_bucket\" \"payment_receipts\" {\n"], [12, "  # LocalStack doesn't require globally unique names\n"], [13, "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-payment-receipts\" : \"${var.project_name}-payment-receipts-${var.environment}-${data.aws_caller_identity.current.account_id}\"\n"], [14, "\n"], [15, "  # \u274c PCI 3.4: Force destroy allows data loss\n"], [16, "  force_destroy = true\n"], [17, "\n"], [18, "  tags = {\n"], [19, "    Name     = \"Payment Receipts\"\n"], [20, "    Contains = \"Payment Data\"  # \u274c Contains PII/PCI data!\n"], [21, "    Public   = \"true\"\n"], [22, "  }\n"], [23, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [11, 23], "resource": "aws_s3_bucket.payment_receipts", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Contains": "Payment Data", "Name": "Payment Receipts", "Public": true}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.payment_receipts", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"audit_logs": {"__end_line__": 81, "__start_line__": 72, "bucket": ["securebank-audit-logs"], "force_destroy": [true], "tags": [{"Contains": "PCI Audit Logs", "Name": "Audit Logs"}], "__address__": "aws_s3_bucket.audit_logs"}}}, "evaluated_keys": ["logging", "resource_type"]}, "code_block": [[72, "resource \"aws_s3_bucket\" \"audit_logs\" {\n"], [73, "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-audit-logs\" : \"${var.project_name}-audit-logs-${var.environment}-${data.aws_caller_identity.current.account_id}\"\n"], [74, "\n"], [75, "  force_destroy = true\n"], [76, "\n"], [77, "  tags = {\n"], [78, "    Name     = \"Audit Logs\"\n"], [79, "    Contains = \"PCI Audit Logs\"\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [72, 81], "resource": "aws_s3_bucket.audit_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Contains": "PCI Audit Logs", "Name": "Audit Logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.audit_logs", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"payment_receipts": {"__end_line__": 23, "__start_line__": 11, "bucket": ["securebank-payment-receipts"], "force_destroy": [true], "tags": [{"Contains": "Payment Data", "Name": "Payment Receipts", "Public": true}], "__address__": "aws_s3_bucket.payment_receipts"}}}, "evaluated_keys": ["rule/*/status", "replication_configuration/rules/*/status", "resource_type"]}, "code_block": [[11, "resource \"aws_s3_bucket\" \"payment_receipts\" {\n"], [12, "  # LocalStack doesn't require globally unique names\n"], [13, "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-payment-receipts\" : \"${var.project_name}-payment-receipts-${var.environment}-${data.aws_caller_identity.current.account_id}\"\n"], [14, "\n"], [15, "  # \u274c PCI 3.4: Force destroy allows data loss\n"], [16, "  force_destroy = true\n"], [17, "\n"], [18, "  tags = {\n"], [19, "    Name     = \"Payment Receipts\"\n"], [20, "    Contains = \"Payment Data\"  # \u274c Contains PII/PCI data!\n"], [21, "    Public   = \"true\"\n"], [22, "  }\n"], [23, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [11, 23], "resource": "aws_s3_bucket.payment_receipts", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Contains": "Payment Data", "Name": "Payment Receipts", "Public": true}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.payment_receipts", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"audit_logs": {"__end_line__": 81, "__start_line__": 72, "bucket": ["securebank-audit-logs"], "force_destroy": [true], "tags": [{"Contains": "PCI Audit Logs", "Name": "Audit Logs"}], "__address__": "aws_s3_bucket.audit_logs"}}}, "evaluated_keys": ["rule/*/status", "replication_configuration/rules/*/status", "resource_type"]}, "code_block": [[72, "resource \"aws_s3_bucket\" \"audit_logs\" {\n"], [73, "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-audit-logs\" : \"${var.project_name}-audit-logs-${var.environment}-${data.aws_caller_identity.current.account_id}\"\n"], [74, "\n"], [75, "  force_destroy = true\n"], [76, "\n"], [77, "  tags = {\n"], [78, "    Name     = \"Audit Logs\"\n"], [79, "    Contains = \"PCI Audit Logs\"\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [72, 81], "resource": "aws_s3_bucket.audit_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Contains": "PCI Audit Logs", "Name": "Audit Logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.audit_logs", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_11", "bc_check_id": "BC_AWS_LOGGING_9", "check_name": "Ensure VPC flow logging is enabled in all VPCs", "check_result": {"result": "FAILED", "entity": {"aws_vpc": {"main": {"__end_line__": 16, "__start_line__": 8, "cidr_block": ["10.0.0.0/16"], "enable_dns_hostnames": [true], "enable_dns_support": [true], "tags": [{"Name": "securebank-vpc"}], "__address__": "aws_vpc.main"}}}, "evaluated_keys": ["resource_type", "networking"]}, "code_block": [[8, "resource \"aws_vpc\" \"main\" {\n"], [9, "  cidr_block           = \"10.0.0.0/16\"\n"], [10, "  enable_dns_hostnames = true\n"], [11, "  enable_dns_support   = true\n"], [12, "\n"], [13, "  tags = {\n"], [14, "    Name = \"${var.project_name}-vpc\"\n"], [15, "  }\n"], [16, "}\n"]], "file_path": "/vpc.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf", "repo_file_path": "/infrastructure/terraform/vpc.tf", "file_line_range": [8, 16], "resource": "aws_vpc.main", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "securebank-vpc"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/vpc.tf", "breadcrumbs": {"tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_40", "bc_check_id": "BC_AWS_IAM_73", "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "FAILED", "entity": {"aws_iam_role_policy": {"app_admin": {"__end_line__": 107, "__start_line__": 95, "name": ["admin-access"], "policy": [{"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": "*", "Resource": "*"}]}], "role": ["aws_iam_role.app_role.id"], "__address__": "aws_iam_role_policy.app_admin"}}}, "evaluated_keys": ["inline_policy/Statement[?(@/Effect == Allow)]/Action[*]", "policy/Statement[?(@/Effect == Allow)]/Action[*]", "statement[?(@/effect == Allow)]/actions[*]"]}, "code_block": [[95, "resource \"aws_iam_role_policy\" \"app_admin\" {\n"], [96, "  name = \"admin-access\"\n"], [97, "  role = aws_iam_role.app_role.id\n"], [98, "\n"], [99, "  policy = jsonencode({\n"], [100, "    Version = \"2012-10-17\"\n"], [101, "    Statement = [{\n"], [102, "      Effect   = \"Allow\"\n"], [103, "      Action   = \"*\"  # \u274c CRITICAL: Full admin access!\n"], [104, "      Resource = \"*\"\n"], [105, "    }]\n"], [106, "  })\n"], [107, "}"]], "file_path": "/iam.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf", "repo_file_path": "/infrastructure/terraform/iam.tf", "file_line_range": [95, 107], "resource": "aws_iam_role_policy.app_admin", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-40", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/iam.tf"}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"payment_receipts": {"__end_line__": 23, "__start_line__": 11, "bucket": ["securebank-payment-receipts"], "force_destroy": [true], "tags": [{"Contains": "Payment Data", "Name": "Payment Receipts", "Public": true}], "__address__": "aws_s3_bucket.payment_receipts"}}}, "evaluated_keys": ["block_public_policy", "block_public_acls", "resource_type"]}, "code_block": [[11, "resource \"aws_s3_bucket\" \"payment_receipts\" {\n"], [12, "  # LocalStack doesn't require globally unique names\n"], [13, "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-payment-receipts\" : \"${var.project_name}-payment-receipts-${var.environment}-${data.aws_caller_identity.current.account_id}\"\n"], [14, "\n"], [15, "  # \u274c PCI 3.4: Force destroy allows data loss\n"], [16, "  force_destroy = true\n"], [17, "\n"], [18, "  tags = {\n"], [19, "    Name     = \"Payment Receipts\"\n"], [20, "    Contains = \"Payment Data\"  # \u274c Contains PII/PCI data!\n"], [21, "    Public   = \"true\"\n"], [22, "  }\n"], [23, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [11, 23], "resource": "aws_s3_bucket.payment_receipts", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Contains": "Payment Data", "Name": "Payment Receipts", "Public": true}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.payment_receipts", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"audit_logs": {"__end_line__": 81, "__start_line__": 72, "bucket": ["securebank-audit-logs"], "force_destroy": [true], "tags": [{"Contains": "PCI Audit Logs", "Name": "Audit Logs"}], "__address__": "aws_s3_bucket.audit_logs"}}}, "evaluated_keys": ["block_public_policy", "block_public_acls", "resource_type"]}, "code_block": [[72, "resource \"aws_s3_bucket\" \"audit_logs\" {\n"], [73, "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-audit-logs\" : \"${var.project_name}-audit-logs-${var.environment}-${data.aws_caller_identity.current.account_id}\"\n"], [74, "\n"], [75, "  force_destroy = true\n"], [76, "\n"], [77, "  tags = {\n"], [78, "    Name     = \"Audit Logs\"\n"], [79, "    Contains = \"PCI Audit Logs\"\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [72, 81], "resource": "aws_s3_bucket.audit_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Contains": "PCI Audit Logs", "Name": "Audit Logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.audit_logs", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"payment_receipts": {"__end_line__": 23, "__start_line__": 11, "bucket": ["securebank-payment-receipts"], "force_destroy": [true], "tags": [{"Contains": "Payment Data", "Name": "Payment Receipts", "Public": true}], "__address__": "aws_s3_bucket.payment_receipts"}}}, "evaluated_keys": ["versioning/enabled", "versioning_configuration/status", "resource_type"]}, "code_block": [[11, "resource \"aws_s3_bucket\" \"payment_receipts\" {\n"], [12, "  # LocalStack doesn't require globally unique names\n"], [13, "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-payment-receipts\" : \"${var.project_name}-payment-receipts-${var.environment}-${data.aws_caller_identity.current.account_id}\"\n"], [14, "\n"], [15, "  # \u274c PCI 3.4: Force destroy allows data loss\n"], [16, "  force_destroy = true\n"], [17, "\n"], [18, "  tags = {\n"], [19, "    Name     = \"Payment Receipts\"\n"], [20, "    Contains = \"Payment Data\"  # \u274c Contains PII/PCI data!\n"], [21, "    Public   = \"true\"\n"], [22, "  }\n"], [23, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [11, 23], "resource": "aws_s3_bucket.payment_receipts", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Contains": "Payment Data", "Name": "Payment Receipts", "Public": true}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.payment_receipts", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"audit_logs": {"__end_line__": 81, "__start_line__": 72, "bucket": ["securebank-audit-logs"], "force_destroy": [true], "tags": [{"Contains": "PCI Audit Logs", "Name": "Audit Logs"}], "__address__": "aws_s3_bucket.audit_logs"}}}, "evaluated_keys": ["versioning/enabled", "versioning_configuration/status", "resource_type"]}, "code_block": [[72, "resource \"aws_s3_bucket\" \"audit_logs\" {\n"], [73, "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-audit-logs\" : \"${var.project_name}-audit-logs-${var.environment}-${data.aws_caller_identity.current.account_id}\"\n"], [74, "\n"], [75, "  force_destroy = true\n"], [76, "\n"], [77, "  tags = {\n"], [78, "    Name     = \"Audit Logs\"\n"], [79, "    Contains = \"PCI Audit Logs\"\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [72, 81], "resource": "aws_s3_bucket.audit_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Contains": "PCI Audit Logs", "Name": "Audit Logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.audit_logs", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_61", "bc_check_id": "BC_AWS_LOGGING_35", "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"payment_receipts": {"__end_line__": 23, "__start_line__": 11, "bucket": ["securebank-payment-receipts"], "force_destroy": [true], "tags": [{"Contains": "Payment Data", "Name": "Payment Receipts", "Public": true}], "__address__": "aws_s3_bucket.payment_receipts"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[11, "resource \"aws_s3_bucket\" \"payment_receipts\" {\n"], [12, "  # LocalStack doesn't require globally unique names\n"], [13, "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-payment-receipts\" : \"${var.project_name}-payment-receipts-${var.environment}-${data.aws_caller_identity.current.account_id}\"\n"], [14, "\n"], [15, "  # \u274c PCI 3.4: Force destroy allows data loss\n"], [16, "  force_destroy = true\n"], [17, "\n"], [18, "  tags = {\n"], [19, "    Name     = \"Payment Receipts\"\n"], [20, "    Contains = \"Payment Data\"  # \u274c Contains PII/PCI data!\n"], [21, "    Public   = \"true\"\n"], [22, "  }\n"], [23, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [11, 23], "resource": "aws_s3_bucket.payment_receipts", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Contains": "Payment Data", "Name": "Payment Receipts", "Public": true}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.payment_receipts", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_61", "bc_check_id": "BC_AWS_LOGGING_35", "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"audit_logs": {"__end_line__": 81, "__start_line__": 72, "bucket": ["securebank-audit-logs"], "force_destroy": [true], "tags": [{"Contains": "PCI Audit Logs", "Name": "Audit Logs"}], "__address__": "aws_s3_bucket.audit_logs"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[72, "resource \"aws_s3_bucket\" \"audit_logs\" {\n"], [73, "  bucket = var.deployment_target == \"localstack\" ? \"${var.project_name}-audit-logs\" : \"${var.project_name}-audit-logs-${var.environment}-${data.aws_caller_identity.current.account_id}\"\n"], [74, "\n"], [75, "  force_destroy = true\n"], [76, "\n"], [77, "  tags = {\n"], [78, "    Name     = \"Audit Logs\"\n"], [79, "    Contains = \"PCI Audit Logs\"\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "repo_file_path": "/infrastructure/terraform/s3.tf", "file_line_range": [72, 81], "resource": "aws_s3_bucket.audit_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Contains": "PCI Audit Logs", "Name": "Audit Logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61", "details": [], "check_len": null, "definition_context_file_path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.audit_logs", "path": "/home/jimmie/linkops-industries/GP-copilot/GP-PROJECTS/FINANCE-project/infrastructure/terraform/s3.tf", "module_connection": false}]}}], "skipped_checks": [], "parsing_errors": []}, "summary": {"passed": 27, "failed": 48, "skipped": 0, "parsing_errors": 0, "resource_count": 34, "checkov_version": "3.2.471"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}